<!DOCTYPE html><title>Django views: Miscellaneous thinking - manhhomienbienthuy's space</title> <meta charset=utf-8> <meta name=viewport content="width=device-width, initial-scale=1"> <link rel=apple-touch-icon href=/theme/images/icon-touch.png> <link rel=icon sizes=192x192 href=/theme/images/icon-touch.png> <link rel="shortcut icon" href=/theme/images/favicon.ico> <link rel=author href=/humans.txt> <meta name=msapplication-TileImage content=/theme/images/icon-tile.png> <meta name=twitter:dnt content=on> <meta name=Author content=manhhomienbienthuy> <meta name=rating content=general> <meta name=twitter:card content=product> <meta name=twitter:site content=@_naa_4f> <meta name=twitter:creator content=@_naa_4f> <link href=/feeds/all.atom.xml type=application/atom+xml rel=alternate title="manhhomienbienthuy's space Full Atom Feed"> <meta name=description content="Django là một framework rất nổi tiếng, mạnh mẽ với rất nhiều tính năng được viết trên ngôn ngữ Python. Có nhiều lý do khiến nó trở thanh framework phổ biến như vậy. Trong bài viết này, tôi sẽ trình bày một vài ý kiến cá nhân với phần Views …"> <meta name=keywords content="Python, Django, MVC, MVT, Views, blog, naa, manhhomienbienthuy, pelican, static site generator"> <meta name=twitter:title content="Django views: Miscellaneous thinking - manhhomienbienthuy's space"> <meta name=twitter:description content="Django là một framework rất nổi tiếng, mạnh mẽ với rất nhiều tính năng được viết trên ngôn ngữ Python. Có nhiều lý do khiến nó trở thanh framework phổ biến như vậy. Trong bài viết này, tôi sẽ trình bày một vài ý kiến cá nhân với phần Views …"> <meta name=twitter:image content=/https://i.imgur.com/D5Z4pfn.png> <link rel=stylesheet href=//cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css> <link rel=stylesheet href=//maxcdn.bootstrapcdn.com/font-awesome/4.0.0/css/font-awesome.min.css> <link rel=stylesheet href=/theme/css/vpyeu.min.css?5d2c7d5e> <header> <div class=navbar> <div class=wrapper> <div class=nav-menu> <div class=menu-toggle> <i class="fa fa-reorder"></i> </div> <ul class=menus> <li><a href=/ >Home</a> <li><a href=/category/general.html> General <li><a href=/category/life.html> Life <li><a href=/category/programming.html class=current> Programming <li><a href=/category/travel.html> Travel </ul> </div><div class="right links"> <ul> <li> <a href=https://twitter.com/_naa_4f target=_blank> <i class="fa fa-twitter"></i> </a> <li> <a href=https://instagram.com/manhhomienbienthuy/ target=_blank> <i class="fa fa-instagram"></i> </a> <li> <a href=https://www.facebook.com/manhhomienbienthuy target=_blank> <i class="fa fa-facebook"></i> </a> <li> <a href=https://github.com/manhhomienbienthuy target=_blank> <i class="fa fa-github"></i> </a> <li> <a href=/feeds/all.atom.xml target=_blank> <i class="fa fa-rss"></i> </a> </ul> </div> </div> </div><noscript> <div class="warning head-warn"> <div class=wrapper> <p><strong>Notice:</strong> While JavaScript is not essential for this website, your interaction with the content will be limited. Please turn JavaScript on for the full experience. </div> </div> </noscript><div class=banner> <div class=wrapper> <a href=/ > <img alt="manhhomienbienthuy's space" src=/theme/images/logo.png> </a> </div> </div></header> <main> <div class=wrapper> <div class=main-wrapper> <div class=entry> <div class=entry-detail> <div class=post> <h1 class=title> Django views: Miscellaneous thinking </h1> <div class=meta> Posted in <a href=/category/programming.html>Programming</a> on March 23, 2017 by <a href=/pages/about-me.html>manhhomienbienthuy</a> <span class=right> <i class="fa fa-comments"></i> <a href=#disqus_thread data-disqus-identifier=/2017/Mar/23/django-views-miscellaneous-thinking.html> Comments </a> </span> </div> <div class=post-body> <img src=https://i.imgur.com/D5Z4pfn.png alt="Django views: Miscellaneous thinking"> <p><a href=https://www.djangoproject.com/ >Django</a> là một framework rất nổi tiếng, mạnh mẽ với rất nhiều tính năng được viết trên ngôn ngữ Python. Có nhiều lý do khiến nó trở thanh framework phổ biến như vậy. Trong bài viết này, tôi sẽ trình bày một vài ý kiến cá nhân với phần Views của nó.</p> <blockquote> <p>Trước khi chúng ta bắt đầu, bạn nên tìm hiểu qua một chút về framework này <a href=https://docs.djangoproject.com/en/1.10/ >ở đây</a>. Một chút hiểu biết nhất định về <a href=https://www.python.org/ >Python</a> cũng giúp bạn hiểu rõ hơn vấn đề.</p> </blockquote> <h1 id=django-su-dung-mo-hinh-mvt-model-view-template>Django sử dụng mô hình MVT (model-view-template)<a class=headerlink href=#django-su-dung-mo-hinh-mvt-model-view-template title="Permanent link">&para;</a></h1> <p>Django được nhiều tài liệu, đặc biệt là <a href=http://djangobook.com/ >Django Book</a> giới thiệu rằng nó sử dụng mô hình MVC (<a href=http://www.artima.com/articles/dci_vision.html>model-view-controller</a>). Mô hình này vô cùng quen thuộc rồi, có lẽ tôi không cần nói gì thêm về nó. Một hình ảnh minh họa cho mô hình MVC như sau:</p> <p><img alt=mvc src=https://developer.chrome.com/static/images/mvc.png></p> <p>Thế nhưng khi làm việc với Django, nhất là khi tôi đã làm việc với <a href=https://rubyonrails.org/ >Ruby on Rails</a> rồi thì MVC của Django quả thực rất khác những gì tôi nghĩ. Và mô hình chính xác mà Django triển khai được gọi là MVT (model-view-template). Mô hình này như sau:</p> <p><img alt=mvt src=https://i.imgur.com/7kDYASi.png></p> <p>Phải chăng Django đã gọi sai tên, họ gọi controller là view và gọi view là template. Theo <a href=https://docs.djangoproject.com/en/1.10/faq/general/#django-appears-to-be-a-mvc-framework-but-you-call-the-controller-the-view-and-the-view-the-template-how-come-you-don-t-use-the-standard-names>lý giải của Django</a> thì mọi thứ thú vị hơn rất nhiều.</p> <p>Django gọi mô hình mà họ sử dụng là MVT bởi vì bản thân framework chính là controller (mà phần này thì trong suốt với người dùng). Lý do rất đơn giản, bởi vì framework chính là thứ dùng để điều khiển toàn bộ framework, bao gồm cả model, template, view để xử lý truy vấn và trả kết quả cho người dùng.</p> <p>Chúng ta biết rằng, MVC là một mô hình chung cho toàn bộ tất cả các phần mềm chứ không phải là mô hình riêng cho các ứng dụng Web. Việc mỗi người có một kiến giải khác nhau cũng như cách triển khai khác nhau cho mô hình này cũng là điều dễ hiểu. Qua đây, chúng ta có thêm cơ hội hiển thêm về mô hình MVC tưởng như rất quen thuộc này.</p> <p>Theo cách triển khai của Django, view sẽ thể hiện dữ liệu trả về cho người dùng, nó không chỉ là cách hiển thị dữ liệu như thế nào, mà còn là những dữ liệu nào được hiển thị nữa.</p> <p>Ngược lại, Ruby on Rails và nhiều framework khác giao nhiệm vụ cho controller sẽ lấy dữ liệu trả về cho người dùng, trong khi view chỉ còn đơn giản là hiển thị chúng.</p> <p>Mô hình MVC đã được phát triển trong <a href=https://martinfowler.com/eaaDev/uiArchs.html>thời gian rất dài</a>, và nó càng phát triển mạnh hơn nữa trong thời đại Internet, khi mà các ứng dụng Web ngày càng phổ biến. Internet chính là một nơi lý tưởng để triển khai mô hình client-server. Phần lớn các framework web đều được xây dựng từ mô hình MVC. Và tôi mạnh dạn dự đoán rằng, nếu bạn đang có ý định không sử dụng MVC cho ứng dụng Web của mình, khả năng cao nhất là bạn đã sai ngay từ ý tưởng.</p> <p>Về mặt khái niệm, mô hình MVC rất đơn giản:</p> <ul> <li>Model (M) là mô phỏng của dữ liệu. Nó không thực sự là dữ liệu, nhưng nó là một thể hiện của dữ liệu và là nơi để chúng ta thao tác với dữ liệu thật sự. Model cho phép chúng ta lưu dữ liệu vào DB và không cần hiểu những hoạt động sâu xa bên dưới. Hơn nữa, model cung cấp cho chúng ta cách thức thao tác với DB rất đơn giản, khiến cho một model có thể sử dụng với rất nhiều DB khác nhau.</li> <li>View (V) là những gì người dùng nhìn thấy. Nó là sự thể hiện của dữ liệu đối với người dùng. Nói một cách văn hoa, nó là sự thể hiện của Model. Trong ứng dụng Web, nó chính là những gì người dùng nhìn thấy trên trình duyệt. Với ứng dụng khác, nó là những gì họ nhìn thấy trên giao diện của ứng dụng. Ngoài ra, View còn cung cấp cho chúng ta phương thức để thu thập dữ liệu từ người dùng.</li> <li>Controller (C) dùng để điều khiển luồng thông tin dữ Model và View. Nó được sử dụng để cài đặt các login về việc lấy dữ liệu từ DB thông qua Model và chuyển sang View. Nó cũng là nơi xử lý những truy vấn từ người dùng thông qua View và thực hiện các logic khác: thay đổi View, cập nhật dữ liệu thông qua Model.</li> </ul> <p>Bởi vì mô hình là một khái niệm, nó có thể được triển khai rất khác nhau giữa các framework khác nhau. Những <a href=https://en.wikipedia.org/wiki/Guru>"Guru"</a> của framework đó mới là người biết chính xác họ đang triển khai như thế nào, và tính năng nào thuộc về Controller, tính năng nào thuộc về View.</p> <p>Thực ra với những người lập trình ứng dụng như chúng ta, chúng ta chỉ sử dụng framework thì việc hiểu biết kỹ càng về cách triển khai của framework nhiều khi không quan trọng lắm. Miễn là chúng ta vẫn hiểu được framework đó, chúng ta sẽ có thể hoàn thành được công việc của mình. Tất nhiên là nếu có hiểu biết thì vẫn hơn, nhất là khi phỏng vấn ứng tuyển.</p> <p>Quay trở lại với Django, nó hoàn toàn tuân theo mô hình MVC mặc dù cách triển khai của nó hơi "dị". Bởi vì "C" chính là bản thân framework, và phần lớn các lập trình viên chỉ làm việc với Model, Template và View, nên Django thường được hiểu là sử dụng mô hình MVT. Trong mô hình này:</p> <ul> <li>Model (M) là lớp để truy cập dữ liệu. Đây là nơi chứa mọi thứ liên quan đến dữ liệu: cách thức truy cập DB, validate dữ liệu, các phương thức và hành vi của dữ liệu, mối quan hệ của dữ liệu.</li> <li>Template (T) là lớp hiển thị. Đây là nơi chứa đựng những gì liên quan đến việc hiển thị dữ liệu cho người dùng: dữ liệu được hiển thị trên Web hay dạng thức nào khác.</li> <li>View (V) là nơi chứa các logic. Lớp này chứa các logic để truy cập dữ liệu qua Model và truyền nó ra ngoài cho Template tương ứng. Nó có thể coi là một cầu nối giữ Model và Template.</li> </ul> <p>Mọi sự khó hiểu cũng diễn ra ở đây khi View của Django đang đảm nhận vai trò tương tự Controller trong MVC khi mà nó có khá nhiều logic. Sự khó hiểu nhẹ này chỉ là thoáng qua khi chúng ta đã quen với những framework khác. Rồi mọi chuyện sẽ trở nên bình thường khi chúng ta lại quen với Django</p> <h1 id=view-class-based-vs-function-based-loi-va-hai>View: class-based vs function-based, lợi và hại<a class=headerlink href=#view-class-based-vs-function-based-loi-va-hai title="Permanent link">&para;</a></h1> <p>Tôi biết đến Django khá muộn. Không rõ lịch sử thế nào, nhưng khi tôi biết đến nó thì nó đã có cả class-based View và function-based View rồi. Function-based View là thứ tôi biết đến trước, còn class-based View thì phải mãi sau này mới biết.</p> <p>Khi mới biết đến function-based View, nó là một thứ rất đơn giản. Mọi thứ đều được thể hiện ở code. Tôi cần gì, tôi code thứ đó. Nhưng dần dần, khi bài toán trở nên phức tạp hơn, những tính năng tương tự nhau xuất hiện nhiều hơn, function-based View lại lộ ra khuyết điểm của nó. Nó không thể mở rộng cũng như dùng lại được. Mỗi View tôi phải code một hàm, mặc dù nhiều phần cũng khá tương đồng.</p> <p>Có thể tôi không phải là một lập trình viên đủ giỏi để có thể tái sử dụng các hàm. Nhưng rồi, class-based View đã giúp tôi.</p> <h2 id=class-based-view>Class-based view<a class=headerlink href=#class-based-view title="Permanent link">&para;</a></h2> <p>Như đã nói ở trên, class-based View được sinh ra để giúp lập trình viên dễ dàng mở rộng và tái sử dụng code. Lợi ích lớn nhất của class-based View là nó có thể <a href=https://www.cse.msu.edu/~cse870/Input/SS2002/MiniProject/Sources/DRC.pdf>kế thừa</a>. Từ một View này, dễ dàng chúng ta xây dựng View khác chỉ với một vài dòng code.</p> <p>Hãy xem xét một ví dụ như sau:</p> <div class=codehilite><pre><span></span><span class=c1># urls.py</span>
<span class=n>urlpatterns</span> <span class=o>=</span> <span class=p>[</span>
    <span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^user/(?P&lt;pk&gt;\d+)/$&#39;</span><span class=p>,</span> <span class=n>UserDetailView</span><span class=o>.</span><span class=n>as_view</span><span class=p>(),</span> <span class=n>name</span><span class=o>=</span><span class=s2>&quot;user_view&quot;</span><span class=p>),</span>
<span class=p>]</span>

<span class=c1># views.py</span>
<span class=k>class</span> <span class=nc>UserDetailView</span><span class=p>(</span><span class=n>DetailView</span><span class=p>):</span>
    <span class=n>model</span> <span class=o>=</span> <span class=n>User</span>

    <span class=k>def</span> <span class=nf>get_context_data</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=n>context</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>get_context_data</span><span class=p>()</span>
        <span class=n>context</span><span class=p>[</span><span class=s1>&#39;posts&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>object</span><span class=o>.</span><span class=n>posts</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
        <span class=k>return</span> <span class=n>context</span>
</pre></div> <p>Vậy là chúng ta đã có thể lấy ra được dữ liệu và chuyển cho Template để hiển thị cho người dùng.</p> <p>Như code ở trên, View của chúng ta đã sử dụng kế thừa. Thay vì code lại toàn bộ View, tôi chỉ cần kế thừa nó từ một View khác và thêm một vài chỉnh sửa là đủ.</p> <p>Ngoài ra, Django đã xây dựng sẵn rất nhiều View class cho những tác vụ thông thường của một ứng dụng Web, ví dụ như <a href=https://docs.djangoproject.com/en/1.10/ref/class-based-views/generic-editing/#django.views.generic.edit.CreateView>thêm</a>, <a href=https://docs.djangoproject.com/en/1.10/ref/class-based-views/generic-editing/#updateview>sửa</a>, <a href=https://docs.djangoproject.com/en/1.10/ref/class-based-views/generic-editing/#deleteview>xóa</a> một đối tượng, <a href=https://docs.djangoproject.com/en/1.10/ref/class-based-views/generic-display/#listview>list</a> các đối tượng, phân trang, v.v...</p> <p>Sử dụng những class View này sẽ giúp chúng ta tiết kiệm rất nhiều thời gian và công sức để xây dựng View cho ứng dụng.</p> <p>Bạn có thể tham khảo thêm trang <a href=http://ccbv.co.uk/ >ccbv.co.uk</a>, nó cung cấp thông tin rất đầy đủ về các class View của Django. Một điều nữa là trang này cũng sử dụng class-based View để xây dựng.</p> <p>Tiếp tục với class-based View, nếu bạn để ý, bạn có thể thấy rằng, thực ra nó cũng là function khi được gọi. Khi chúng ta thêm vào URL, chúng ta sử dụng phương thức <code>as_view()</code>, nó sẽ trả về một function. Nội dung của hàm <code>as_view</code> như sau:</p> <div class=codehilite><pre><span></span><span class=k>class</span> <span class=nc>View</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
    <span class=o>...</span>

    <span class=nd>@classonlymethod</span>
    <span class=k>def</span> <span class=nf>as_view</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>**</span><span class=n>initkwargs</span><span class=p>):</span>
        <span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Main entry point for a request-response process.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>initkwargs</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>key</span> <span class=ow>in</span> <span class=bp>cls</span><span class=o>.</span><span class=n>http_method_names</span><span class=p>:</span>
                <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s2>&quot;You tried to pass in the </span><span class=si>%s</span><span class=s2> method name as a &quot;</span>
                                <span class=s2>&quot;keyword argument to </span><span class=si>%s</span><span class=s2>(). Don&#39;t do that.&quot;</span>
                                <span class=o>%</span> <span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=bp>cls</span><span class=o>.</span><span class=vm>__name__</span><span class=p>))</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=nb>hasattr</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
                <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s2>&quot;</span><span class=si>%s</span><span class=s2>() received an invalid keyword </span><span class=si>%r</span><span class=s2>. as_view &quot;</span>
                                <span class=s2>&quot;only accepts arguments that are already &quot;</span>
                                <span class=s2>&quot;attributes of the class.&quot;</span> <span class=o>%</span> <span class=p>(</span><span class=bp>cls</span><span class=o>.</span><span class=vm>__name__</span><span class=p>,</span> <span class=n>key</span><span class=p>))</span>

        <span class=k>def</span> <span class=nf>view</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
            <span class=bp>self</span> <span class=o>=</span> <span class=bp>cls</span><span class=p>(</span><span class=o>**</span><span class=n>initkwargs</span><span class=p>)</span>
            <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=s1>&#39;get&#39;</span><span class=p>)</span> <span class=ow>and</span> <span class=ow>not</span> <span class=nb>hasattr</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=s1>&#39;head&#39;</span><span class=p>):</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>head</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>request</span> <span class=o>=</span> <span class=n>request</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>args</span> <span class=o>=</span> <span class=n>args</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>kwargs</span> <span class=o>=</span> <span class=n>kwargs</span>
            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>dispatch</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
        <span class=n>view</span><span class=o>.</span><span class=n>view_class</span> <span class=o>=</span> <span class=bp>cls</span>
        <span class=n>view</span><span class=o>.</span><span class=n>view_initkwargs</span> <span class=o>=</span> <span class=n>initkwargs</span>

        <span class=c1># take name and docstring from class</span>
        <span class=n>update_wrapper</span><span class=p>(</span><span class=n>view</span><span class=p>,</span> <span class=bp>cls</span><span class=p>,</span> <span class=n>updated</span><span class=o>=</span><span class=p>())</span>

        <span class=c1># and possible attributes set by decorators</span>
        <span class=c1># like csrf_exempt from dispatch</span>
        <span class=n>update_wrapper</span><span class=p>(</span><span class=n>view</span><span class=p>,</span> <span class=bp>cls</span><span class=o>.</span><span class=n>dispatch</span><span class=p>,</span> <span class=n>assigned</span><span class=o>=</span><span class=p>())</span>
        <span class=k>return</span> <span class=n>view</span>
    <span class=o>...</span>
</pre></div> <p>Nội dung của file này khá dài, bạn có thể xem bản đầy đủ ở <a href=https://github.com/django/django/blob/1.10.6/django/views/generic/base.py#L28>Github</a>.</p> <p>Hàm <code>view</code> được trả về bởi <code>as_view</code> sẽ là phần được sử dụng của mọi class-based View. Khi được gọi, công việc của nó là sử dụng <code>dispatch</code> để xử lý truy vấn từ người dùng và gọi đến các hàm xử lý tương ứng. Ví dụ khi truy vấn bằng GET thì sẽ gọi phương thức <code>get</code>, truy vấn POST sẽ gọi phương thức <code>post</code>, v.v...</p> <p><strong>Ưu điểm:</strong></p> <ul> <li>Dễ dàng mở rộng, tái sử dụng code (nhờ khả năng kế thừa tuyệt vời)</li> <li>Có thể lập trình hướng đối tượng dễ dàng (View kế thừa nhiều class)</li> <li>Xử lý truy vấn HTTP riêng ứng với từng phương thức GET, POST, v.v...</li> <li>Django xây dựng sẵn nhiều class cho các tác vụ thông thường, thời gian code sẽ giảm đi đáng kể</li> </ul> <p><strong>Nhược điểm:</strong></p> <ul> <li>Rất khó để đọc code, vì việc kế thừa khiến các class View chỉ còn rất ít code.</li> <li>Luồng dữ liệu không tường minh, bởi sử dụng các class kiểu kế thừa khiến nhiều xử lý không được thể hiện trên code.</li> <li>Những class được xây dựng sẵn là trong suốt với người dùng, rất khó debug.</li> <li>Các xử lý phức tạp cần ghi đè phương thức, hoặc sử dụng các decorators (yêu cầu import từ bên ngoài)</li> </ul> <h2 id=function-based-view>Function-based View<a class=headerlink href=#function-based-view title="Permanent link">&para;</a></h2> <p>Ngược lại với class-based View, function-based View dễ hiểu hơn rất nhiều. Tất cả những gì chúng ta muốn, chúng ta cần code ra. Việc xử lý các truy vấn với phương thức khác nhau có thể thực hiện như sau:</p> <div class=codehilite><pre><span></span><span class=c1># urls.py</span>
<span class=n>urlpatterns</span> <span class=o>=</span> <span class=p>[</span>
    <span class=n>url</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^user/(?P&lt;pk&gt;\d+)/$&#39;</span><span class=p>,</span> <span class=n>view</span><span class=o>.</span><span class=n>user_view</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s2>&quot;user_view&quot;</span><span class=p>),</span>
<span class=p>]</span>

<span class=c1># views.py</span>
<span class=k>def</span> <span class=nf>user_view</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>:</span>
        <span class=c1># Code cho POST request</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=c1># Code cho GET request</span>
    <span class=c1># Có thể sẽ cần thêm code cho các phương thức khác như PATCH, DELETE</span>
</pre></div> <p>Function-based View không cho bạn lựa chọn nào khác ngoài việc phải viết một hàm (có thể gọi hàm khác) để xử lý các truy vấn. Lúc đầu tôi rất thích việc này, nó hoàn toàn không bị gò bó. Mọi xử lý tôi cần đều theo đúng ý mình. Thế nhưng việc phải viết một hàm để hiển thị form, sau đó validate dữ liệu người dùng nhập vào rồi lưu dữ liệu đó vào DB quả thực là rất khổ. Việc sử dụng class-based View kèm với một class Form sẽ giúp chúng ta rất nhiều thao tác.</p> <p>Thế nhưng, một số trường hợp như sau, function-based View lại là một lựa chọn dễ dàng hơn class-based View</p> <ul> <li>Cần thao tác với nhiều model một lúc. Nhiều khi chúng ta cần thao tác với hai hoặc nhiều model hơn trong cùng 1 trang. Rõ ràng những class Django thiết kế không phải cho trường hợp này. Cố sử dụng class-based View với các loại <a href=https://docs.djangoproject.com/en/1.10/topics/class-based-views/mixins/ >mixin</a> khiến chúng ta mất nhiều thời gian để tìm cách xử lý.</li> <li>Cùng 1 View nhưng phải xử lý nhiều thao một lúc. Đây là một điều rất dễ gặp với các ứng dụng Web do cùng một trang cần thể hiện nhiều thông tin cùng với các nút bấm nhanh cho người dùng dễ thao tác.</li> <li>Edit tại chỗ. Ở đây thường là sẽ phải sử dụng một số kỹ thuật như AJAX để gửi thông tin người dùng nhập vào. Nó không phải là một View với form và các input rõ ràng để submit theo cách thông thường. Đây là một trường hợp khó và các class View được Django xây dựng sẵn chưa tính đến.</li> </ul> <p>Như vậy, function-based View cũng có những lợi ích nhất định và do đó, cả class-based View và function-based View đều đang tồn tại song song.</p> <p><strong>Ưu điểm:</strong></p> <ul> <li>Dễ dàng cài đặt, cần gì code nấy</li> <li>Code dễ dọc, do mọi thứ đều thể hiện trong 1 function</li> <li>Luồng dữ liệu tường minh</li> <li>Sử dụng decorators rất đơn giản</li> </ul> <p><strong>Nhược điểm:</strong></p> <ul> <li>Khó mở rộng và tái sử dụng code</li> <li>Tự phải biết tay xử lý riêng cho các phương thức HTTP khác nhau</li> </ul> <p>Rõ ràng là, cả class-based View và function-based View đều có những điểm lợi và hại riêng. Chẳng có cái nào tốt hơn cái nào, chỉ có cái nào phù hợp với bài toán hơn mà thôi. Ví dụ, nếu bạn cần những thao tác "tiêu chuẩn" với một ứng dụng Web như index, view, edit thì class-based View chính là thứ bạn nên lựa chọn. Nhưng nếu bạn cần những thao tác xử lý phức tạp với rất nhiều loại dữ liệu khác nhau, function-based view mới là lựa chọn hợp lý.</p> <h1 id=ket-luan>Kết luận<a class=headerlink href=#ket-luan title="Permanent link">&para;</a></h1> <p>Django là một framework tuyệt vời. Nó cho phép chúng ta sử dụng những công cụ có sẵn cũng như tự viết những gì mình muốn. Điều cuối cùng tôi muốn nói là, bạn hãy tìm hiểu về các class View mà Django đã xây dựng sẵn mà sử dụng chúng trong ứng dụng của bạn nếu có thể. Khi bạn đang làm một thao tác xử lý bình thường, hãy sử dụng class-based View, nếu bạn cảm thấy khó khăn khi không biết phải chọn class nào để kế thừa, đó là lúc bạn nên nghĩ nên function-based View.</p> </div> <div class=post-footer> <div class=tags> <i class="fa fa-tags"></i> <span>#Python</span> <span>#Django</span> <span>#MVC</span> <span>#MVT</span> <span>#Views</span> </div> </div> </div><div class=blog-pager> <span class=newer-link> <a href=/2017/Apr/04/hue-travel.html> Newer Post </a> </span> <span class=older-link> <a href=/2017/Feb/20/rsa-cryptosystem-and-digital-signature.html> Older Post </a> </span> </div><div class=comments> <div class=finally> <p><em>I apologise for any typos. If you notice a problem, please let me know.</em> <p>Thank you all for your attention. </div> <div id=disqus_thread></div> <script src=/theme/js/disqus.min.js?81e8a5f5></script> <noscript> Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript> comments powered by Disqus. </a> </noscript> </div></div> </div> </div> <div class=sidebar-wrapper> <div class=widget> <h2>Welcome</h2> <div> <img src=/theme/images/banner.gif alt=Welcome> </div> </div><div class="widget recent-posts"> <h2>Recent Posts</h2> <ul> <li> <a href=/2019/May/20/elasticsearch-data-organization.html> <img alt="Elasticsearch: Data organization" src=https://i.imgur.com/JT4y7Qf.jpg> </a> <a href=/2019/May/20/elasticsearch-data-organization.html>Elasticsearch: Data organization</a> <li> <a href=/2019/May/20/elasticsearch-intro.html> <img alt="Elasticsearch: Intro" src=https://i.imgur.com/JT4y7Qf.jpg> </a> <a href=/2019/May/20/elasticsearch-intro.html>Elasticsearch: Intro</a> <li> <a href=/2019/Apr/20/javascript-popups.html> <img alt="JavaScript: Popups" src=https://i.imgur.com/FxmcwPy.png> </a> <a href=/2019/Apr/20/javascript-popups.html>JavaScript: Popups</a> <li> <a href=/2019/Mar/20/javascript-iterator-and-generator.html> <img alt="JavaScript: Iterator and generator" src=https://i.imgur.com/lev8iT9.jpg> </a> <a href=/2019/Mar/20/javascript-iterator-and-generator.html>JavaScript: Iterator and generator</a> <li> <a href=/2019/Feb/20/javascript-decorator.html> <img alt="JavaScript decorator" src=https://i.imgur.com/Sh3yLI0.png> </a> <a href=/2019/Feb/20/javascript-decorator.html>JavaScript decorator</a> </ul> </div><div class="widget labels"> <h2>Blog Archive</h2> <ul> <li> <a href=/2019/ > 2019 </a> <li> <a href=/2018/ > 2018 </a> <li> <a href=/2017/ > 2017 </a> <li> <a href=/2016/ > 2016 </a> <li> <a href=/2015/ > 2015 </a> <li> <a href=/2014/ > 2014 </a> <li> <a href=/2013/ > 2013 </a> <li> <a href=/2012/ > 2012 </a> <li> <a href=/2011/ > 2011 </a> <li> <a href=/2010/ > 2010 </a> </ul> </div><div class=widget> <h2>Twitter timeline</h2> <a class=twitter-timeline data-height=500 data-dnt=true data-theme=light href=https://twitter.com/_naa_4f data-chrome="noheader nofooter transparent noborders"> Tweets by manhhomienbienthuy </a> </div> </div> </div> <a href=# class="smooth-scroll back-to-top"> <i class="fa fa-arrow-circle-up fa-3x"></i> </a> </main> <footer> <div class=infos> <div class=wrapper> <div class=widget> <a href=/ title="manhhomienbienthuy's space" class=logo> <img alt="manhhomienbienthuy's space" src=/theme/images/logo_white.png> </a> <span class=right>I'm a hacker, enter my world...</span> </div><div class=widget> <p> Created with all my ♥ and soul, dedicated to my love, yunachan <p> Powered by <a href=http://blog.getpelican.com/ target=_blank>Pelican</a>, which takes great advantage of <a href=https://www.python.org/ target=_blank>Python</a> <p> This site content is licensed under a <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank> CC BY-NC-ND 4.0 </a> License. <p> Updated at <a target=_blank href="http://www.timeanddate.com/worldclock/fixedtime.html?iso=2019-06-20T02:42:55"> 2019-06-20 02:42:55 </a> </div><div class=widget> <p> Hosting by <a href=https://manhhomienbienthuy.bitbucket.io/ >Bitbucket</a> and <a href=https://manhhomienbienthuy.github.io/ >Github</a>, image hosting by <a href=https://manhhomienbienthuy.imgur.com/ target=_blank>imgur</a>, <a href=https://instagram.com/manhhomienbienthuy/ target=_blank>Instagram</a> and <a href=https://photos.google.com/ target=_blank>Google Photo</a> <p> Theme based on <a href=https://vanice-veethemes.blogspot.com/ target=_blank>Vanice theme</a>, icons from <a href=https://fontawesome.com/ target=_blank>Font Awesome</a>, comments powered by <a href=https://disqus.com/home/forums/manhhomienbienthuy/ target=_blank>Disqus</a> </div> </div> </div> <div class=credits> <div class=wrapper> <div class=left> <!--
          Regarding copyright, in general, standalone pages (as
          opposed to files generated as part of manuals) on the GNU
          web server should be under CC BY-ND 4.0.  Please do NOT
          change or remove this without talking with the webmasters or
          licensing team first.  Please make sure the copyright date
          is consistent with the document.  For web pages, it is ok to
          list just the latest year the document was modified, or
          published.

          If you wish to list earlier years, that is ok too.  Either
          "2001, 2002, 2003" or "2001-2003" are ok for specifying
          years, as long as each year in the range is in fact a
          copyrightable year, i.e., a year in which the document was
          published (including being publicly visible on the web or in
          a revision control system).
        --> Copyright © 2010-2019 <a href=/pages/about-me.html><strong>manhhomienbienthuy</strong></a>. All rights reserved. </div> <div class=right> <ul> <li><a href=/ >Home</a> <li><a href=/pages/about-me.html>About</a> <li><a href=# class=smooth-scroll>Top ↑</a> </ul> </div> </div> </div></footer> <script src=https://code.jquery.com/jquery-3.2.1.js></script> <script src=//cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js></script> <script src=//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.2/imagesloaded.pkgd.min.js></script> <script src=/theme/js/vpyeu.min.js?d72c87bd></script> <script id=dsq-count-scr src=https://manhhomienbienthuy.disqus.com/count.js async></script>