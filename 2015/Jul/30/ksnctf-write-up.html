<!DOCTYPE html><title>KSNCTF write up - manhhomienbienthuy's space</title> <meta charset=utf-8> <meta name=viewport content="width=device-width, initial-scale=1"> <link rel=apple-touch-icon href=/theme/images/icon-touch.png> <link rel=icon sizes=192x192 href=/theme/images/icon-touch.png> <link rel="shortcut icon" href=/theme/images/favicon.ico> <link rel=author href=/humans.txt> <meta name=msapplication-TileImage content=/theme/images/icon-tile.png> <meta name=twitter:dnt content=on> <meta name=Author content=manhhomienbienthuy> <meta name=rating content=general> <meta name=twitter:card content=product> <meta name=twitter:site content=@_naa_4f> <meta name=twitter:creator content=@_naa_4f> <link href=/feeds/all.atom.xml type=application/atom+xml rel=alternate title="manhhomienbienthuy's space Full Atom Feed"> <meta name=description content="Cuộc thi CTF lần đầu tiên được tổ chức tại hội thảo bảo mật nổi tiếng DefCon (Mỹ) lần thứ 5 năm 1997. Ngày nay hàng năm có rất nhiều các cuộc thi CTF được tổ chức trên toàn thế giới theo các quy mô khác nhau. Đơn vị tổ …"> <meta name=keywords content="KSNCTF, CTF, Security, blog, naa, manhhomienbienthuy, pelican, static site generator"> <meta name=twitter:title content="KSNCTF write up - manhhomienbienthuy's space"> <meta name=twitter:description content="Cuộc thi CTF lần đầu tiên được tổ chức tại hội thảo bảo mật nổi tiếng DefCon (Mỹ) lần thứ 5 năm 1997. Ngày nay hàng năm có rất nhiều các cuộc thi CTF được tổ chức trên toàn thế giới theo các quy mô khác nhau. Đơn vị tổ …"> <meta name=twitter:image content=/https://i.imgur.com/uqR99YF.png> <link rel=stylesheet href=//cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css> <link rel=stylesheet href=//maxcdn.bootstrapcdn.com/font-awesome/4.0.0/css/font-awesome.min.css> <link rel=stylesheet href=/theme/css/vpyeu.min.css?5d2c7d5e> <header> <div class=navbar> <div class=wrapper> <div class=nav-menu> <div class=menu-toggle> <i class="fa fa-reorder"></i> </div> <ul class=menus> <li><a href=/ >Home</a> <li><a href=/category/general.html class=current> General <li><a href=/category/life.html> Life <li><a href=/category/programming.html> Programming <li><a href=/category/travel.html> Travel </ul> </div><div class="right links"> <ul> <li> <a href=https://twitter.com/_naa_4f target=_blank> <i class="fa fa-twitter"></i> </a> <li> <a href=https://instagram.com/manhhomienbienthuy/ target=_blank> <i class="fa fa-instagram"></i> </a> <li> <a href=https://www.facebook.com/manhhomienbienthuy target=_blank> <i class="fa fa-facebook"></i> </a> <li> <a href=https://github.com/manhhomienbienthuy target=_blank> <i class="fa fa-github"></i> </a> <li> <a href=/feeds/all.atom.xml target=_blank> <i class="fa fa-rss"></i> </a> </ul> </div> </div> </div><noscript> <div class="warning head-warn"> <div class=wrapper> <p><strong>Notice:</strong> While JavaScript is not essential for this website, your interaction with the content will be limited. Please turn JavaScript on for the full experience. </div> </div> </noscript><div class=banner> <div class=wrapper> <a href=/ > <img alt="manhhomienbienthuy's space" src=/theme/images/logo.png> </a> </div> </div></header> <main> <div class=wrapper> <div class=main-wrapper> <div class=entry> <div class=entry-detail> <div class=post> <h1 class=title> KSNCTF write up </h1> <div class=meta> Posted in <a href=/category/general.html>General</a> on July 30, 2015 by <a href=/pages/about-me.html>manhhomienbienthuy</a> <span class=right> <i class="fa fa-comments"></i> <a href=#disqus_thread data-disqus-identifier=/2015/Jul/30/ksnctf-write-up.html> Comments </a> </span> </div> <div class=post-body> <img src=https://i.imgur.com/uqR99YF.png alt="KSNCTF write up"> <p>Cuộc thi CTF lần đầu tiên được tổ chức tại hội thảo bảo mật nổi tiếng DefCon (Mỹ) lần thứ 5 năm 1997. Ngày nay hàng năm có rất nhiều các cuộc thi CTF được tổ chức trên toàn thế giới theo các quy mô khác nhau. Đơn vị tổ chức thường là các tổ chức, các trường đại học - học viện, viện nghiên cứu... và rất nhiều các cuộc thi CTF được tổ chức bên lề các hội thảo về Security và Hacking.</p> <h1 id=cac-hinh-thuc-ctf>Các hình thức CTF<a class=headerlink href=#cac-hinh-thuc-ctf title="Permanent link">&para;</a></h1> <h2 id=jeopardy>Jeopardy<a class=headerlink href=#jeopardy title="Permanent link">&para;</a></h2> <p>Ở hình thức chơi này, đề bài sẽ là một tập hợp các bài thi ở nhiều chủ đề khác nhau: Web, network, forensic, crypto, binary,... Các bài thi sẽ có độ khó khác nhau mà cũng có điểm số khác nhau. Mục tiêu của mỗi người chơi (hoặc đội chơi) là sử dụng tất cả các kỹ năng, kinh nghiệm của mình để tìm kiếm flag được giấu. Khi tìm được flag thì sẽ ghi điểm, và chiến thằng sẽ dành cho đội nào có điểm cao nhất. Ngoài ra, một số cuộc thi CTF cho điểm thưởng rất cao cho người chơi có thể tìm được flag trong khoảng thời gian ngắn.</p> <h2 id=attach-defence>Attach &amp; Defence<a class=headerlink href=#attach-defence title="Permanent link">&para;</a></h2> <p>Đây là hình thức chơi CTF nguyên thủy. Các đội tham gia CTF sẽ được cấp một máy chủ (hoặc một mạng máy chủ) đã cài đặt sẵn nhiều chương trình chứa các lỗ hổng bảo mật. Nhiệm vụ của đội chơi là tìm ra các lỗ hổng đó, tấn công các máy chủ của các đội khác để ghi điểm, đồng thời phải nhanh chóng vá các lỗ hổng trên máy chủ của đội nhà, để tránh bị tấn công bởi các đội khác. Hình thức này khó hơn so với hình thức khác do yêu cầu cơ hơn ở người chơi ngoài các kỹ năng tìm kiếm lỗ hổng bảo mật, khai thác các lỗ hổng đó thì người chơi cần có có khả năng khắc phục các điểm yếu lỗ hổng, bảo vệ hệ thống của mình trước các tấn công từ các đội khác. Đây là hình thức thi này là hình thức gần với thực tế nhất. Các hacker thực hiện tấn công vào hệ thống, các nhà quản trị mạng – chuyên viên bảo mật có nhiệm vụ chống lại các tấn công từ bên ngoài và vẫn phải bảo đảm duy trì hoạt động của hệ thống... Cuộc thi nổi tiếng nhất về dạng này là DEF CON CTF .</p> <p>Ngoài ra, trong các cuộc thi CTF có thể kết hợp cả 2 hình thức chơi trên.</p> <h1 id=ksnctf>ksnctf<a class=headerlink href=#ksnctf title="Permanent link">&para;</a></h1> <p>Trang chủ của cuộc thi này ở đây: <a href=http://ksnctf.sweetduet.info/ >http://ksnctf.sweetduet.info/</a></p> <p>Đây là một trang thi CTF theo hình Jeopardy. Theo tôi đánh giá, nó rất thích hợp cho những người mới làm quen với CTF hay cả những cao thủ. Các câu hỏi của nó ở đủ thể loại khác nhau liên quan đến các lĩnh vực của bảo mật máy tính. Flag trong các câu hỏi này có định dạng <code>FLAG_123456xyz</code>. Mục tiêu là bạn hãy tìm các flag cho từng câu hỏi. Để ghi điểm và chạy đua với những người khác, bạn hãy đăng nhập bằng Twitter. Trang Web đã được bảo mật để đảm bảo rằng bạn chắc chắn chơi CTF chứ không dùng các cách khác để "hack flag".</p> <p>Dưới đây là cách làm một số bài của cuộc thi này, các bài sẽ được sắp xếp theo thứ tự mà tôi cảm thấy khó dần.</p> <h1 id=cach-giai-mot-so-bai-ksnctf>Cách giải một số bài ksnctf<a class=headerlink href=#cach-giai-mot-so-bai-ksnctf title="Permanent link">&para;</a></h1> <h2 id=1-test-problem>1: Test problem<a class=headerlink href=#1-test-problem title="Permanent link">&para;</a></h2> <p>URL: <a href=http://ksnctf.sweetduet.info/problem/1>http://ksnctf.sweetduet.info/problem/1</a></p> <p>Đây chưa phải là một bài CTF, nó là một bài để test thử hệ thống. Hãy chắc chắn rằng bạn có thể submit flag và ghi điểm.</p> <p>Flag của bài này là</p> <div class=codehilite><pre><span></span>FLAG_SRORGLnTh2Q5fTwu
</pre></div> <h2 id=10>10: #!<a class=headerlink href=#10 title="Permanent link">&para;</a></h2> <p>URL: <a href=http://ksnctf.sweetduet.info/problem/10>http://ksnctf.sweetduet.info/problem/10</a></p> <p>Flag của câu hỏi này là <code>FLAG_S??????</code> với <code>S??????</code> là tên gọi cho chuỗi ký tự <code>#!</code>.</p> <p>Để giải bài này, đương nhiên bạn cần biết tên của <code>#!</code> là gì. Những ký tự này rất phố biến với các script của Linux/Unix. Và là những lập trình viên, bạn chắc chắn đã nhìn thấy nó nhiều lần. Có thể bạn đã biết tên của nó, hoặc bạn có thể Google (Google là một kỹ năng rất quan trọng khi thi CTF :D), bạn sẽ tìm ra nhiều thông tin lý thú, ví dụ ở <a href=http://en.wikipedia.org/wiki/Shebang_%28Unix%29>đây</a>.</p> <p>Tên của chuối ký tự này là shebang, và flag của câu hỏi này sẽ là:</p> <div class=codehilite><pre><span></span>FLAG_SHEBANG
</pre></div> <h2 id=20-g00913>20: G00913<a class=headerlink href=#20-g00913 title="Permanent link">&para;</a></h2> <p>URL: <a href=http://ksnctf.sweetduet.info/problem/20>http://ksnctf.sweetduet.info/problem/20</a></p> <p>Flag của câu hỏi này là: <code>FLAG_Q20_{first 10-digit prime found in consecutive digits of π}</code></p> <p>Bạn cần tìm ra số nguyên tố đầu tiên có 10 chữ số trong phần thập phân của π (3.14...). Bạn có thể tính bằng tay :D. Tuy nhiên tiêu đề của câu hỏi này gợi ý rằng "Hãy google". Bạn có thể sử dụng Google và tìm kiếm từ khóa "first 10-digit prime found in consecutive digits of π" hoặc keyword khác mà bạn thích.</p> <p>Sau khi Google thì bạn đã biết số nguyên tố đó là 5926535897 và flag của câu hỏi này là: <code>FLAG_Q20_5926535897</code></p> <p>Việc đọc các câu trả lời quá dễ dàng có thể khiến cho việc chơi CTF mất hay. Từ những câu hỏi sau, tôi sẽ đưa ra các gợi ý cho các câu hỏi. Và câu trả lời cụ thể hơn sẽ có ở link khác. Bạn hãy cố gắng tìm ra câu trả lời từ những gợi ý của tôi.</p> <h2 id=25-reserved>25: Reserved<a class=headerlink href=#25-reserved title="Permanent link">&para;</a></h2> <p>URL: <a href=http://ksnctf.sweetduet.info/problem/25>http://ksnctf.sweetduet.info/problem/25</a></p> <p>Câu hỏi yêu cầu bạn tìm flag trong một chuỗi những ký tự mà trông như nó bị mã hóa. Thực ra nó đúng là chuỗi đã được mã hóa, nhưng là chuỗi mã hóa của một ngôn ngữ lập trình. Hãy cố gắng tìm ra ngôn ngữ lập trình vầ cách mã hóa đã được sử dụng, bạn sẽ tìm ra flag của câu hỏi này.</p> <h2 id=35-simple-auth-ii>35: Simple Auth II<a class=headerlink href=#35-simple-auth-ii title="Permanent link">&para;</a></h2> <p>URL: <a href=http://ksnctf.sweetduet.info/problem/35>http://ksnctf.sweetduet.info/problem/35</a></p> <p>Đây là một câu hỏi thuộc thể loại Web. Để tìm được flag, bạn phải đăng nhập được vào trang Web <a href=http://ctfq.sweetduet.info:10080/~q35/auth.php>http://ctfq.sweetduet.info:10080/~q35/auth.php</a>. Mã nguồn (đã censor) của trang này được đưa ra cho bạn như một gợi ý <a href=http://ksnctf.sweetduet.info/q/35/auth.php>ở đây</a>, và bạn có thể dễ dàng tìm ra lỗ hổng bảo mật ở đây.</p> <p>Bạn không cần phải nghĩ đến SQLInjection, câu hỏi này rất dễ và hoàn toàn chưa cần đến nó. Nhìn mã nguồn bạn sẽ thấy rằng, trang Web sử dụng một cơ sở dữ liệu SQLite, và nếu truy cập được đến nó, bạn sẽ biết username và password để đăng. Hãy thử xem.</p> <h2 id=2-easy-cipher>2: Easy Cipher<a class=headerlink href=#2-easy-cipher title="Permanent link">&para;</a></h2> <p>URL: <a href=http://ksnctf.sweetduet.info/problem/2>http://ksnctf.sweetduet.info/problem/2</a></p> <p>Đây là một câu hỏi thuộc thể loại crypto. Bạn cần giải mã một đoạn cipher để biết câu trả lời. Nhìn chuỗi cipher và để ý rằng các dấu cách vẫn còn nguyên, điều đó cho thấy rằng chuỗi này sử dụng cách mã hóa rất đơn giản. Chính xác nó sử dụng cách mã hóa khá cổ điển là mã hóa Caesar. Bạn có thể tìm hiểu về mã hóa Caesar và cách giải mã, brute-force (thử tất cả các trường hợp) là một cách như vậy (chỉ có 26 trường hợp với mã Caesar nên brute-force cũng không mất thời gian lắm)</p> <h2 id=32-simple-auth>32: Simple Auth<a class=headerlink href=#32-simple-auth title="Permanent link">&para;</a></h2> <p>URL: <a href=http://ksnctf.sweetduet.info/problem/32>http://ksnctf.sweetduet.info/problem/32</a></p> <p>Ở câu hỏi này, ban cần phải login vào trang Web <a href=http://ctfq.sweetduet.info:10080/~q32/auth.php>http://ctfq.sweetduet.info:10080/~q32/auth.php</a>. Gợi ý là mã nguồn của trang Web này <a href=http://ksnctf.sweetduet.info/q/32/auth.php>http://ksnctf.sweetduet.info/q/32/auth.php</a></p> <p>Bạn cần phải login vào trang Web để tìm flag, trang này không sử dụng database nào cả. Và password rất dài, nếu brute-force, bạn cần phải thử 16^62 = 4.5231285e+74 trường hợp khác nhau. Đây không phải là cách khả thi.</p> <p>Cách làm ở đây là lợi dụng lỗ hổng bảo mật. Nhìn mã nguồn và bạn thấy rằng, bạn cần vượt qua những dòng này để login thành công.</p> <div class=codehilite><pre><span></span>if (isset($_POST[&#39;password&#39;])) if
    (strcasecmp($_POST[&#39;password&#39;], $password) == 0) echo
    &quot;Congratulations! The flag is $password&quot;; else echo
    &quot;incorrect...&quot;;
</pre></div> <p>Hãy tìm lỗ hổng có thể ở đây và khai thác nó. Bạn sẽ tìm flag.</p> <h2 id=14-john>14: John<a class=headerlink href=#14-john title="Permanent link">&para;</a></h2> <p>URL: <a href=http://ksnctf.sweetduet.info/problem/14>http://ksnctf.sweetduet.info/problem/14</a></p> <p>Nội dung của câu hỏi này là nội dung file passwd của Linux (file lưu trữ password của các user). Để "crack" nó, có một chương trình khá nổi tiếng, mà ngay cả tiêu đề câu hỏi cũng gợi ý đến nó, đó là "John the ripper". Đây là chương trình để crack các loại pasword. Bạn hãy Google và tìm hiểu cách sử dụng của nó. Nó sẽ giúp bạn tìm flag cho câu hỏi này, và hãy để ý một chút, câu hỏi có một vài gợi ý khác nữa.</p> <h2 id=29-double-blind>29: Double Blind<a class=headerlink href=#29-double-blind title="Permanent link">&para;</a></h2> <p>URL: <a href=http://ksnctf.sweetduet.info/problem/29>http://ksnctf.sweetduet.info/problem/29</a></p> <p>Câu hỏi này yêu cầu bạn tìm tác giả của paper. Tất nhiên, ý nó là bạn tìm ra người nào đã tạo ra file đó. Đó là một file docx. Thực ra docx là một dạng file mở rộng của file zip. Đổi đuôi nó thành zip và mở nó bằng các trình giải nén, hãy cố gắng đọc cấu trúc của nó, bạn sẽ tìm ra câu trả lời.</p> <h2 id=28-lo-tech-cipher>28: Lo-Tech Cipher<a class=headerlink href=#28-lo-tech-cipher title="Permanent link">&para;</a></h2> <p>URL: <a href=http://ksnctf.sweetduet.info/problem/28>http://ksnctf.sweetduet.info/problem/28</a></p> <p>Ở câu hỏi này, bạn phải tìm flag từ một file <a href=http://ksnctf.sweetduet.info/q/28/secret.zip>zip</a></p> <p>Giải nén file zip này, bạn sẽ thấy 2 file ảnh. Gợi ý của tôi là hãy chồng 2 bức ảnh này lên nhau, bạn sẽ nhìn thông tin được giấu. Tất nhiên không chỉ có thế bạn đã thấy ngay flag, nhưng chỉ thêm một chút thao tác nữa, bạn sẽ tìm ra.</p> <h2 id=8-basic-is-secure>8: Basic is secure?<a class=headerlink href=#8-basic-is-secure title="Permanent link">&para;</a></h2> <p>URL: <a href=http://ksnctf.sweetduet.info/problem/8>http://ksnctf.sweetduet.info/problem/8</a></p> <p>Đây là một câu hỏi network, với câu hỏi này, bạn cần phân tích một file pcap. Đây là một lưu trữ các gói tin bắt được trong mạng LAN. Để phân tích nó, bạn cần sử dụng một số công cụ, ví dụ Wireshark.</p> <p>Bạn có thể sử dụng công cụ nào bạn thích, nếu muốn dùng Wireshark, bạn có thể tìm hiểu thêm ở <a href=https://www.wireshark.org/download.html>đây</a></p> <p>Tiêu đề của câu hỏi này gợi ý rằng, các gói tin gửi đi có sử dụng cách phương thức authentication là Basic. Bạn nên tìm hiểu thêm về phương thức. Nếu đã hiểu rồi, thì việc tìm flag cho câu hỏi này sẽ trở nên rất đơn giản.</p> <h2 id=22-square-cipher>22: Square Cipher<a class=headerlink href=#22-square-cipher title="Permanent link">&para;</a></h2> <p>URL: <a href=http://ksnctf.sweetduet.info/problem/22>http://ksnctf.sweetduet.info/problem/22</a></p> <p>Đây là một câu hỏi crypto, bạn cần giải mã một chuỗi cipher 31 dòng và mỗi dòng có 31 ký tự. Gợi ý của câu hỏi này chính là bạn hãy xây dựng nên một hình vuông từ cipher này.</p> <p>Gợi ý của tôi là, các ký không có nghĩa, chính kiểu của chúng (hoa-thường) mới có thể, hãy thử thay thế chúng xem sao, và hãy nhớ rằng, hãy xây dựng một hình vuông từ chúng. Bạn sẽ tìm ra flag.</p> <h2 id=5-onion>5: Onion<a class=headerlink href=#5-onion title="Permanent link">&para;</a></h2> <p>URL: <a href=http://ksnctf.sweetduet.info/problem/5>http://ksnctf.sweetduet.info/problem/5</a></p> <p>Với câu hỏi này, bạn cần giải mã một chuỗi ký tự khá dài. Đây là một chuỗi đã được mã hóa, bằng cách mã hóa ra base64. Bạn có thể dùng các công cụ giải mã để giải nó.</p> <p>Tuy nhiên, bạn sẽ nhận ra rằng, sau khi giải mã, bạn thu được một chuỗi vẫn bị mã hóa. Gợi ý của tôi là hãy tiếp tục giải mã (tới khi nào không giải mã được nữa), bạn sẽ nhìn thấy điều kỳ diệu. Tuy nhiên, sau khi giải mã base64, bạn sẽ cần một phương thức giải mã khác nữa.</p> <h2 id=13-proverb>13: Proverb<a class=headerlink href=#13-proverb title="Permanent link">&para;</a></h2> <p>URL: <a href=http://ksnctf.sweetduet.info/problem/13>http://ksnctf.sweetduet.info/problem/13</a></p> <p>Với câu hỏi này, bạn cần ssh vào server và chạy chương trình <code>proverb</code> để nhận flag. Chương trình proverb khá đơn giản, bạn sẽ nhận ra hoạt động của nó sau khi chạy thử vài lần. Nó nhận đầu vào là file <code>proverb.txt</code> và chọn ngẫu nhiên một dòng để in ra. Nếu bạn có thể thay <code>proverb.txt</code> thành <code>flag.txt</code>, bạn sẽ tìm được flag.</p> <p>Tuy nhiên, người ta đã thiết lập quyền user với thư mục, bạn không thể làm gì ở thư mục <code>/home/q13</code>. Gợi ý của tôi là hãy sử dụng thư mục <code>/tmp</code> và symbolic link sẽ giúp bạn.</p> <h2 id=6-login>6: Login<a class=headerlink href=#6-login title="Permanent link">&para;</a></h2> <p>URL: <a href=http://ctfq.sweetduet.info:10080/~q6/ >http://ctfq.sweetduet.info:10080/~q6/</a></p> <p>Với câu hỏi này, bạn cần phải login vào trang Web <a href=http://ctfq.sweetduet.info:10080/~q6/ >http://ctfq.sweetduet.info:10080/~q6/</a>. Bạn có thể sử dụng SQLInjection ở câu hỏi này. Thử điền vào ô ID <code>' or 1=1--</code> và bạn đã đăng nhập thành công. Tuy nhiên, như vậy vẫn chưa đủ.</p> <p>Trang Web cho bạn mã nguồn như một gợi ý và yêu cầu rằng flag chính là mật khẩu của admin. Bạn sẽ cần các kỹ năng SQLInjection nâng cao hơn nữa để giải quyết câu hỏi này.</p> <h2 id=7-programming>7: Programming<a class=headerlink href=#7-programming title="Permanent link">&para;</a></h2> <p>URL: <a href=http://ksnctf.sweetduet.info/problem/7>http://ksnctf.sweetduet.info/problem/7</a></p> <p>Với câu hỏi này, bạn cần tìm flag trong một chương trình. Mã nguồn câu hỏi đưa ra là file <code>program.cpp</code>. Thực sự đây là một trick, khiến bạn nghĩ rằng đây là mã nguồn một chương trình C++ (C). Tuy nhiên, biên dịch và chạy như một chương trình C/C++ bạn sẽ chỉ nhận được <code>FROG_This_is_wrong_:(</code>. Đây đương nhiên không phải là flag của câu hỏi.</p> <p>Hãy để ý rằng, chương trình có quá nhiều dấu cách và dòng trắng. Tất cả chúng đề là không cần thiết với một chương trình C/C++. Tuy nhiên đừng xóa chúng đi hay thay đổi mã nguồn, vì bạn không thể tìm được flag nếu vẫn nghĩ đây là một chương trình C hay C++. Thực ra, đây là một chương trình viết bằng ngôn ngữ Whitespace. Với Whitespace, chỉ có ký tự trắng (cách, tab, xuống dòng) mới có ý nghĩa, các ký tự khác sẽ bị bỏ qua.</p> <h2 id=16-math-i>16: Math I<a class=headerlink href=#16-math-i title="Permanent link">&para;</a></h2> <p>URL: <a href=http://ksnctf.sweetduet.info/problem/16>http://ksnctf.sweetduet.info/problem/16</a></p> <p>Các biến số trong câu hỏi này (n, c, p, q, ...) rất giống với các biến sử dụng trong hệ thống mã hóa RSA <a href=http://en.wikipedia.org/wiki/RSA_(cryptosystem)>http://en.wikipedia.org/wiki/RSA_(cryptosystem)</a></p> <p>Hãy tìm hiểu về cách mã hóa và giải mã RSA, nếu đã hiểu rồi, tôi tin rằng bạn sẽ tìm ra flag của câu hỏi này rất nhanh.</p> <h2 id=12-hypertext-preprocessor>12: Hypertext Preprocessor<a class=headerlink href=#12-hypertext-preprocessor title="Permanent link">&para;</a></h2> <p>URL: <a href=http://ksnctf.sweetduet.info/problem/12>http://ksnctf.sweetduet.info/problem/12</a></p> <p>Với câu hỏi này, bạn cần phải tìm flag từ một trang Web <a href=http://ctfq.sweetduet.info:10080/~q12/ >http://ctfq.sweetduet.info:10080/~q12/</a></p> <p>Trang Web đơn giản là show một chuỗi chữ số, một phần của chúng là thời gian truy cập. Không có input, nên cũng khó tìm ra lỗ hổng ở đây.</p> <p>Bạn sẽ nhận thấy rằng, mỗi lần bạn truy cập trang Web, chuỗi ký tự đều thay đổi, nhưng phần mở đầu của nó <code>2012-1823:20</code> không bao giờ thay đổi. Đây chính là một gợi ý. Sử dụng Google vào bạn có thể tìm ra một vài không tin như ở <a href=http://www.php-security.net/archives/9-New-PHP-CGI-exploit-CVE-2012-1823.html>đây</a></p> <p>CVE-2012-1823 là một bug của PHP-CGI. Bạn có thể khai thác nó, ví dụ, truy cập vào URL <a href=http://ctfq.sweetduet.info:10080/~q12/?-s>http://ctfq.sweetduet.info:10080/~q12/?-s</a> bạn nhìn được toàn bộ mã nguồn của trang Web này.</p> <p>Bạn sẽ cần khai thác với một vài kỹ năng nâng cao hơn để tìm ra flag cho câu hỏi này. Cố lên.</p> <h2 id=9-digest-is-secure>9: Digest is secure!<a class=headerlink href=#9-digest-is-secure title="Permanent link">&para;</a></h2> <p>URL: <a href=http://ksnctf.sweetduet.info/problem/9>http://ksnctf.sweetduet.info/problem/9</a></p> <p>Với câu hỏi này, bạn cần phân tích một file pcap khác. Tiêu đề câu hỏi gợi ý rằng phương thức Authentication được sử dụng ở đây là Digest. Bạn có thể Google để hiểu hơn về phương thức này.</p> <p>Phân tích file pcap, bạn có thể tìm ra được gói tin nào gửi các thông tin authorization đi. Tuy nhiên, không giống Basic Authentication, Digest sử dụng MD5 hash để mã hóa theo một phương thức khá phức tạp nên việc crack để tìm ra password là rất khó.</p> <p>Bạn có thể sử dụng những cách làm khác mà không biết password. Bạn phải tìm cách "replay" lại quá trình gửi thông tin xác thực giống như quá trình gửi trong file pcap. Để đăng nhập được, bạn chỉ cần điều chỉnh gói tin gửi đi sao cho các thông tin khớp nhau, và bạn sẽ xác thực được với trang Web. Cố lên.</p> <h2 id=17-math-ii>17: Math II<a class=headerlink href=#17-math-ii title="Permanent link">&para;</a></h2> <p>URL: <a href=http://ksnctf.sweetduet.info/problem/17>http://ksnctf.sweetduet.info/problem/17</a></p> <p>Với câu hỏi này, bạn cần phải tính toán với những số rất lớn. Câu hỏi này ít điểm hơn Math I, tuy nhiên bản thân tôi cảm thấy nó lại có phần khó hơn.</p> <p>Bạn cần tính căn bậc 101 của một số dài hơn 100 chữ số. Số quá lớn nên vượt qua khả năng tính toán của các phần mềm thông thường. Tôi chưa sử dụng các công cụ toán học như Mathematica nên không rõ liệu nó có thể tính được không.</p> <p>Một vài cách làm khác như tính toán qua logarithm lại cho sai số quá lớn.</p> <p>Có một cách có thể giải bài này, đó là thử brute-force với y (vì tính toán mũ 101) thì dễ hơn là tính căn bậc 101. Và với một số thủ thuật, bạn có thể giảm số trường hợp cần tính đi.</p> <h2 id=18-usb-flash-drive>18: USB flash drive<a class=headerlink href=#18-usb-flash-drive title="Permanent link">&para;</a></h2> <p>URL: <a href=http://ksnctf.sweetduet.info/problem/18>http://ksnctf.sweetduet.info/problem/18</a></p> <p>Với câu hỏi này, bạn cần tìm flag trong một file zip. Download và giải nén nó, bạn sẽ thấy một file img. Đừng lo lắng về cách mở nó. Nó là một file ảnh của đĩa cứng, chỉ cần đổi đuôi img thành iso, bạn có thể mở nó dễ dàng.</p> <h2 id=19-zip-de-kure>19: ZIP de kure<a class=headerlink href=#19-zip-de-kure title="Permanent link">&para;</a></h2> <p>URL: <a href=http://ksnctf.sweetduet.info/problem/19>http://ksnctf.sweetduet.info/problem/19</a></p> <p>Với câu hỏi này, bạn cần tìm flag từ một file zip. Tuy nhiên, file zip đã được bảo mật bằng password, và bạn cần "crack" nó.</p> <p>Có nhiều công cụ để crack password các file zip. Tuy nhiên tôi gợi ý pkcrack. Bạn có thể google, download và dùng thử. File zip được bảo mật bằng password thực sự cũng không khó để crack. Bạn cần biết một phần nội dung của một trong những file bên trong zip (càng nhiều càng tốt) và sử dụng pkcrack, bạn sẽ mở được nó.</p> </div> <div class=post-footer> <div class=tags> <i class="fa fa-tags"></i> <span>#KSNCTF</span> <span>#CTF</span> <span>#Security</span> </div> </div> </div><div class=blog-pager> <span class=newer-link> <a href=/2015/Aug/30/web-development-with-cherrypy-and-jinja2.html> Newer Post </a> </span> <span class=older-link> <a href=/2014/Sep/30/da-nang-travel.html> Older Post </a> </span> </div><div class=comments> <div class=finally> <p><em>I apologise for any typos. If you notice a problem, please let me know.</em> <p>Thank you all for your attention. </div> <div id=disqus_thread></div> <script src=/theme/js/disqus.min.js?81e8a5f5></script> <noscript> Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript> comments powered by Disqus. </a> </noscript> </div></div> </div> </div> <div class=sidebar-wrapper> <div class=widget> <h2>Welcome</h2> <div> <img src=/theme/images/banner.gif alt=Welcome> </div> </div><div class="widget recent-posts"> <h2>Recent Posts</h2> <ul> <li> <a href=/2019/May/20/elasticsearch-data-organization.html> <img alt="Elasticsearch: Data organization" src=https://i.imgur.com/JT4y7Qf.jpg> </a> <a href=/2019/May/20/elasticsearch-data-organization.html>Elasticsearch: Data organization</a> <li> <a href=/2019/May/20/elasticsearch-intro.html> <img alt="Elasticsearch: Intro" src=https://i.imgur.com/JT4y7Qf.jpg> </a> <a href=/2019/May/20/elasticsearch-intro.html>Elasticsearch: Intro</a> <li> <a href=/2019/Apr/20/javascript-popups.html> <img alt="JavaScript: Popups" src=https://i.imgur.com/FxmcwPy.png> </a> <a href=/2019/Apr/20/javascript-popups.html>JavaScript: Popups</a> <li> <a href=/2019/Mar/20/javascript-iterator-and-generator.html> <img alt="JavaScript: Iterator and generator" src=https://i.imgur.com/lev8iT9.jpg> </a> <a href=/2019/Mar/20/javascript-iterator-and-generator.html>JavaScript: Iterator and generator</a> <li> <a href=/2019/Feb/20/javascript-decorator.html> <img alt="JavaScript decorator" src=https://i.imgur.com/Sh3yLI0.png> </a> <a href=/2019/Feb/20/javascript-decorator.html>JavaScript decorator</a> </ul> </div><div class="widget labels"> <h2>Blog Archive</h2> <ul> <li> <a href=/2019/ > 2019 </a> <li> <a href=/2018/ > 2018 </a> <li> <a href=/2017/ > 2017 </a> <li> <a href=/2016/ > 2016 </a> <li> <a href=/2015/ > 2015 </a> <li> <a href=/2014/ > 2014 </a> <li> <a href=/2013/ > 2013 </a> <li> <a href=/2012/ > 2012 </a> <li> <a href=/2011/ > 2011 </a> <li> <a href=/2010/ > 2010 </a> </ul> </div><div class=widget> <h2>Twitter timeline</h2> <a class=twitter-timeline data-height=500 data-dnt=true data-theme=light href=https://twitter.com/_naa_4f data-chrome="noheader nofooter transparent noborders"> Tweets by manhhomienbienthuy </a> </div> </div> </div> <a href=# class="smooth-scroll back-to-top"> <i class="fa fa-arrow-circle-up fa-3x"></i> </a> </main> <footer> <div class=infos> <div class=wrapper> <div class=widget> <a href=/ title="manhhomienbienthuy's space" class=logo> <img alt="manhhomienbienthuy's space" src=/theme/images/logo_white.png> </a> <span class=right>I'm a hacker, enter my world...</span> </div><div class=widget> <p> Created with all my ♥ and soul, dedicated to my love, yunachan <p> Powered by <a href=http://blog.getpelican.com/ target=_blank>Pelican</a>, which takes great advantage of <a href=https://www.python.org/ target=_blank>Python</a> <p> This site content is licensed under a <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank> CC BY-NC-ND 4.0 </a> License. <p> Updated at <a target=_blank href="http://www.timeanddate.com/worldclock/fixedtime.html?iso=2019-06-20T02:42:55"> 2019-06-20 02:42:55 </a> </div><div class=widget> <p> Hosting by <a href=https://manhhomienbienthuy.bitbucket.io/ >Bitbucket</a> and <a href=https://manhhomienbienthuy.github.io/ >Github</a>, image hosting by <a href=https://manhhomienbienthuy.imgur.com/ target=_blank>imgur</a>, <a href=https://instagram.com/manhhomienbienthuy/ target=_blank>Instagram</a> and <a href=https://photos.google.com/ target=_blank>Google Photo</a> <p> Theme based on <a href=https://vanice-veethemes.blogspot.com/ target=_blank>Vanice theme</a>, icons from <a href=https://fontawesome.com/ target=_blank>Font Awesome</a>, comments powered by <a href=https://disqus.com/home/forums/manhhomienbienthuy/ target=_blank>Disqus</a> </div> </div> </div> <div class=credits> <div class=wrapper> <div class=left> <!--
          Regarding copyright, in general, standalone pages (as
          opposed to files generated as part of manuals) on the GNU
          web server should be under CC BY-ND 4.0.  Please do NOT
          change or remove this without talking with the webmasters or
          licensing team first.  Please make sure the copyright date
          is consistent with the document.  For web pages, it is ok to
          list just the latest year the document was modified, or
          published.

          If you wish to list earlier years, that is ok too.  Either
          "2001, 2002, 2003" or "2001-2003" are ok for specifying
          years, as long as each year in the range is in fact a
          copyrightable year, i.e., a year in which the document was
          published (including being publicly visible on the web or in
          a revision control system).
        --> Copyright © 2010-2019 <a href=/pages/about-me.html><strong>manhhomienbienthuy</strong></a>. All rights reserved. </div> <div class=right> <ul> <li><a href=/ >Home</a> <li><a href=/pages/about-me.html>About</a> <li><a href=# class=smooth-scroll>Top ↑</a> </ul> </div> </div> </div></footer> <script src=https://code.jquery.com/jquery-3.2.1.js></script> <script src=//cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js></script> <script src=//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.2/imagesloaded.pkgd.min.js></script> <script src=/theme/js/vpyeu.min.js?d72c87bd></script> <script id=dsq-count-scr src=https://manhhomienbienthuy.disqus.com/count.js async></script>