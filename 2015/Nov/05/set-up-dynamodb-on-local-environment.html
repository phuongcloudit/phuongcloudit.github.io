<!DOCTYPE html><title>Set up DynamoDB on local environment - manhhomienbienthuy's space</title> <meta charset=utf-8> <meta name=viewport content="width=device-width, initial-scale=1"> <link rel=apple-touch-icon href=/theme/images/icon-touch.png> <link rel=icon sizes=192x192 href=/theme/images/icon-touch.png> <link rel="shortcut icon" href=/theme/images/favicon.ico> <link rel=author href=/humans.txt> <meta name=msapplication-TileImage content=/theme/images/icon-tile.png> <meta name=twitter:dnt content=on> <meta name=Author content=manhhomienbienthuy> <meta name=rating content=general> <meta name=twitter:card content=product> <meta name=twitter:site content=@_naa_4f> <meta name=twitter:creator content=@_naa_4f> <link href=/feeds/all.atom.xml type=application/atom+xml rel=alternate title="manhhomienbienthuy's space Full Atom Feed"> <meta name=description content="Would you like to be able to write and test code that uses the Amazon DynamoDB API even if you have no network connection and without incurring any usage charges. If so, you are in need of DynamoDB local test tool. DynamoDB Local is a client-side database that supports the …"> <meta name=keywords content="Ruby, Rails, DynamoDB, Local, AWS, Web, blog, naa, manhhomienbienthuy, pelican, static site generator"> <meta name=twitter:title content="Set up DynamoDB on local environment - manhhomienbienthuy's space"> <meta name=twitter:description content="Would you like to be able to write and test code that uses the Amazon DynamoDB API even if you have no network connection and without incurring any usage charges. If so, you are in need of DynamoDB local test tool. DynamoDB Local is a client-side database that supports the …"> <meta name=twitter:image content=/https://i.imgur.com/rXraHyF.png> <link rel=stylesheet href=//cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css> <link rel=stylesheet href=//maxcdn.bootstrapcdn.com/font-awesome/4.0.0/css/font-awesome.min.css> <link rel=stylesheet href=/theme/css/vpyeu.min.css?5d2c7d5e> <header> <div class=navbar> <div class=wrapper> <div class=nav-menu> <div class=menu-toggle> <i class="fa fa-reorder"></i> </div> <ul class=menus> <li><a href=/ >Home</a> <li><a href=/category/general.html> General <li><a href=/category/life.html> Life <li><a href=/category/programming.html class=current> Programming <li><a href=/category/travel.html> Travel </ul> </div><div class="right links"> <ul> <li> <a href=https://twitter.com/_naa_4f target=_blank> <i class="fa fa-twitter"></i> </a> <li> <a href=https://instagram.com/manhhomienbienthuy/ target=_blank> <i class="fa fa-instagram"></i> </a> <li> <a href=https://www.facebook.com/manhhomienbienthuy target=_blank> <i class="fa fa-facebook"></i> </a> <li> <a href=https://github.com/manhhomienbienthuy target=_blank> <i class="fa fa-github"></i> </a> <li> <a href=/feeds/all.atom.xml target=_blank> <i class="fa fa-rss"></i> </a> </ul> </div> </div> </div><noscript> <div class="warning head-warn"> <div class=wrapper> <p><strong>Notice:</strong> While JavaScript is not essential for this website, your interaction with the content will be limited. Please turn JavaScript on for the full experience. </div> </div> </noscript><div class=banner> <div class=wrapper> <a href=/ > <img alt="manhhomienbienthuy's space" src=/theme/images/logo.png> </a> </div> </div></header> <main> <div class=wrapper> <div class=main-wrapper> <div class=entry> <div class=entry-detail> <div class=post> <h1 class=title> Set up DynamoDB on local environment </h1> <div class=meta> Posted in <a href=/category/programming.html>Programming</a> on November 05, 2015 by <a href=/pages/about-me.html>manhhomienbienthuy</a> <span class=right> <i class="fa fa-comments"></i> <a href=#disqus_thread data-disqus-identifier=/2015/Nov/05/set-up-dynamodb-on-local-environment.html> Comments </a> </span> </div> <div class=post-body> <img src=https://i.imgur.com/rXraHyF.png alt="Set up DynamoDB on local environment"> <p>Would you like to be able to write and test code that uses the Amazon DynamoDB API even if you have no network connection and without incurring any usage charges.</p> <p>If so, you are in need of DynamoDB local test tool. DynamoDB Local is a client-side database that supports the complete DynamoDB API.</p> <h1 id=install-jre>Install JRE<a class=headerlink href=#install-jre title="Permanent link">&para;</a></h1> <p>You can download and install Java Runtime Environment from <a href=http://www.java.com/en/download/ >its official website</a>. Follow the instruction to install it on your computer.</p> <p>If you are using Ubuntu, you can install JRE with the following command. It will install OpenJDK 6 on Ubuntu 12.04 and OpenJDK 7 for Ubuntu 12.10+.</p> <div class=codehilite><pre><span></span><span class=gp>$</span> sudo apt-get install default-jre
</pre></div> <p>If you want to install OpenJDK 7, execute the following command:</p> <div class=codehilite><pre><span></span><span class=gp>$</span> sudo apt-get install openjdk-7-jre
</pre></div> <h1 id=download-and-instal-dynamodb-local>Download and instal DynamoDB Local<a class=headerlink href=#download-and-instal-dynamodb-local title="Permanent link">&para;</a></h1> <p>DynamoDB Local is available as an executable Java archive (JAR) file. That's the reason why you need JRE on you computer. Make sure you install the latest version of JRE.</p> <p>Download DynamoDB for free using one of these links:</p> <ul> <li><a href=http://dynamodb-local.s3-website-us-west-2.amazonaws.com/dynamodb_local_latest.tar.gz><code>.tar.gz</code> format</a></li> <li><a href=http://dynamodb-local.s3-website-us-west-2.amazonaws.com/dynamodb_local_latest.zip><code>.zip</code> format</a></li> </ul> <p>Download the format that your computer is familiar with. I recommend you to download <code>.tar.gz</code> file because of smaller file size (28.11MB instead of 28.15MB of <code>.zip</code> file).</p> <p>After you have downloaded the archive to your computer, extract the contents and copy the extracted directory to a location of your choice.</p> <h1 id=set-up-on-local-environment>Set up on local environment<a class=headerlink href=#set-up-on-local-environment title="Permanent link">&para;</a></h1> <p>To start DynamoDB on your local environment, open Terminal on folder you put extracted files, and execute the command like this:</p> <div class=codehilite><pre><span></span><span class=gp>$</span> java -jar DynamoDBLocal.jar
<span class=go>Initializing DynamoDB Local with the following configuration:</span>
<span class=go>Port:   8000</span>
<span class=go>InMemory:   false</span>
<span class=go>DbPath: null</span>
<span class=go>SharedDb:   false</span>
<span class=go>shouldDelayTransientStatuses:   false</span>
<span class=go>CorsParams: *</span>
</pre></div> <p>DynamoDB Local will create a local database in the same directory as the JAR. The file name will have the form <code>MyAccessKeyId_Region.db</code>, where <code>MyAccessKeyId</code> is the AWS access key used to access DynamoDB Local and Region is the target region.</p> <p>DynamoDB Local listens on port 8000 by default; you can change this by specifying the –port option when you start it. If you are using the default port, the local endpoint will be <code>localhost:8000</code>.</p> <p>DynamoDB will process incoming requests until you stop it. To stop DynamoDB, type <code>Ctrl+C</code> in the command prompt window.</p> <h1 id=set-up-rails-to-connect-to-dynamodb-local>Set up Rails to connect to DynamoDB Local<a class=headerlink href=#set-up-rails-to-connect-to-dynamodb-local title="Permanent link">&para;</a></h1> <p>DynamoDB Local will listen on port 8000 so you have to set endpoint of DynamoDB client of Rails application connect the that endpoint (<code>localhost:8000</code>).</p> <p>Modify <code>app/models/concerns/dynamodb/model.rb</code> as the following:</p> <div class=codehilite><pre><span></span><span class=k>def</span> <span class=nf>client</span>
  <span class=vi>@client</span> <span class=o>||=</span> <span class=no>Aws</span><span class=o>::</span><span class=no>DynamoDB</span><span class=o>::</span><span class=no>Client</span><span class=o>.</span><span class=n>new</span><span class=p>(</span>
    <span class=ss>region</span><span class=p>:</span> <span class=s2>&quot;localhost&quot;</span><span class=p>,</span>
    <span class=ss>access_key_id</span><span class=p>:</span> <span class=s2>&quot;access-key-id-of-your-choice&quot;</span><span class=p>,</span>
    <span class=ss>secret_access_key</span><span class=p>:</span> <span class=s2>&quot;secret-key-of-your-choice&quot;</span><span class=p>,</span>
    <span class=ss>endpoint</span><span class=p>:</span> <span class=s2>&quot;http://localhost:8000&quot;</span>
  <span class=p>)</span>
<span class=k>end</span>
</pre></div> <p>Now, you can interact with DynamoDB local.</p> <p><strong>Note</strong>: Don't commit that file and push it to github or other places. Keep it on your local only.</p> <p>If you want to configure DynamoDB Local to use for RSpec only, there is not need of modify <code>app/models/concerns/dynamodb/model.rb</code>. This file is very important for the system. There is another way.</p> <p>Create a file named <code>spec/support/dynamodb_helper.rb</code> with the following content:</p> <div class=codehilite><pre><span></span><span class=k>def</span> <span class=nf>dynamodb_local</span>
  <span class=vi>@client</span> <span class=o>||=</span> <span class=no>Aws</span><span class=o>::</span><span class=no>DynamoDB</span><span class=o>::</span><span class=no>Client</span><span class=o>.</span><span class=n>new</span> <span class=ss>region</span><span class=p>:</span> <span class=s2>&quot;localhost&quot;</span><span class=p>,</span>
    <span class=ss>endpoint</span><span class=p>:</span> <span class=s2>&quot;http://localhost:8000&quot;</span><span class=p>,</span> <span class=ss>access_key_id</span><span class=p>:</span> <span class=s2>&quot;x&quot;</span><span class=p>,</span>
    <span class=ss>secret_access_key</span><span class=p>:</span> <span class=s2>&quot;x&quot;</span>
<span class=k>end</span>

<span class=k>def</span> <span class=nf>delete_table</span> <span class=n>table_name</span>
  <span class=n>dynamodb_local</span><span class=o>.</span><span class=n>delete_table</span> <span class=ss>table_name</span><span class=p>:</span> <span class=n>table_name</span>
<span class=k>rescue</span>
<span class=k>end</span>

<span class=k>def</span> <span class=nf>create_table</span> <span class=n>table_name</span>
  <span class=no>Rake</span><span class=o>::</span><span class=no>Task</span><span class=o>[</span><span class=s2>&quot;dynamodb:create_table&quot;</span><span class=o>].</span><span class=n>reenable</span>
  <span class=no>Rake</span><span class=o>::</span><span class=no>Task</span><span class=o>[</span><span class=s2>&quot;dynamodb:create_table&quot;</span><span class=o>].</span><span class=n>invoke</span> <span class=n>table_name</span>
<span class=k>end</span>
</pre></div> <p>Configure <code>spec_helper</code> to load that file automatically by adding this line to <code>spec/rails_helper.rb</code></p> <div class=codehilite><pre><span></span><span class=nb>require</span> <span class=s2>&quot;rake&quot;</span>
<span class=no>Rails</span><span class=o>.</span><span class=n>application</span><span class=o>.</span><span class=n>load_tasks</span>

<span class=no>Dir</span><span class=o>[</span><span class=no>Rails</span><span class=o>.</span><span class=n>root</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s1>&#39;spec/support/**/*.rb&#39;</span><span class=p>)</span><span class=o>].</span><span class=n>each</span><span class=p>{</span><span class=o>|</span><span class=n>f</span><span class=o>|</span> <span class=nb>require</span> <span class=n>f</span><span class=p>}</span>
</pre></div> <p>If you want to test a DynamoDB model, add the following lines before any lines of test code:</p> <div class=codehilite><pre><span></span><span class=n>before</span> <span class=k>do</span>
  <span class=n>allow</span><span class=p>(</span><span class=no>Dynamodb</span><span class=o>::</span><span class=no>Base</span><span class=p>)</span><span class=o>.</span><span class=n>to</span> <span class=n>receive</span><span class=p>(</span><span class=ss>:client</span><span class=p>)</span><span class=o>.</span><span class=n>and_return</span> <span class=n>dynamodb_local</span>
  <span class=n>create_table</span> <span class=s2>&quot;table-name&quot;</span>
<span class=k>end</span>

<span class=n>after</span><span class=p>{</span><span class=n>delete_table</span> <span class=s2>&quot;table-name&quot;</span><span class=p>}</span>
</pre></div> <p>To create and delete DynamoDB on local, you have to add rake tasks for those operations. Add <code>create_table</code> tasks to file <code>lib/tasks/dynamodb.rake</code></p> <div class=codehilite><pre><span></span>  <span class=n>task</span> <span class=ss>:create_table</span><span class=p>,</span> <span class=o>[</span><span class=ss>:table_name</span><span class=o>]</span> <span class=o>=&gt;</span> <span class=ss>:environment</span> <span class=k>do</span> <span class=o>|</span><span class=n>_</span><span class=p>,</span> <span class=n>args</span><span class=o>|</span>
    <span class=n>table_json</span> <span class=o>=</span> <span class=c1># JSON params for creating table</span>
    <span class=no>Dynamodb</span><span class=o>::</span><span class=no>Base</span><span class=o>.</span><span class=n>__create_table</span> <span class=n>table_json</span> <span class=k>if</span> <span class=n>table_json</span><span class=o>.</span><span class=n>present?</span>
  <span class=k>end</span>
</pre></div> <h1 id=notes>Notes<a class=headerlink href=#notes title="Permanent link">&para;</a></h1> <p>The downloadable version of DynamoDB attempts to emulate the Amazon DynamoDB web service as closely as possible. However, it does differ from the Amazon DynamoDB service in the following ways:</p> <ul> <li>Regions and distinct AWS accounts are not supported at the client level.</li> <li>Provisioned throughput settings are ignored, even though the API requires them. For <code>CreateTable</code>, you can specify any numbers you want for provisioned read and write throughput, even though these numbers will not be used. You can call <code>UpdateTable</code> as many times as you like per day; however, any changes to provisioned throughput values are ignored.</li> <li>The speed of read and write operations on table data are limited only by the speed of your computer. <code>CreateTableUpdateTable</code> and <code>DeleteTable</code> operations occur immediately, and table state is always ACTIVE. <code>UpdateTable</code> operations that only change the provisioned throughput settings on tables and/or global secondary indexes will occur immediately. If an <code>UpdateTable</code> operation creates or deletes any global secondary indexes, then those indexes transition through normal states (such as <code>CREATING</code> and <code>DELETING</code>, respectively) before they become <code>ACTIVE</code> state. The table remains <code>ACTIVE</code> during this time.</li> <li>Read operations are eventually consistent. However, due to the speed of DynamoDB running on your computer, most reads will actually appear to be strongly consistent.</li> <li>Consumed capacity units are not tracked. In API responses, nulls are returned instead of capacity units.</li> <li>Item collection metrics are not tracked; nor are item collection sizes. In API responses, nulls are returned instead of item collection metrics.</li> <li>In the DynamoDB API, there is a 1 MB limit on data returned per result set. The DynamoDB web service enforces this limit, and so does the downloadable version of DynamoDB. However, when querying an index, the DynamoDB service only calculates the size of the projected key and attributes. By contrast, the downloadable version of DynamoDB calculates the size of the entire item.</li> <li>If you are leveraging DynamoDB Streams, the rate at which shards are created might differ: In the DynamoDB web service, shard creation behavior is partially influenced by table partition activity; however, when you run DynamoDB locally, there is no table partitioning. In either case, shards are ephemeral, so your application should not be dependent on shard behavior.</li> </ul> <h1 id=references>References<a class=headerlink href=#references title="Permanent link">&para;</a></h1> <ul> <li><a href=https://aws.amazon.com/blogs/aws/dynamodb-local-for-desktop-development/ >DynamoDB Local for desktop development</a></li> <li><a href=http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Tools.DynamoDBLocal.html>DynamoDB developer guide</a></li> </ul> </div> <div class=post-footer> <div class=tags> <i class="fa fa-tags"></i> <span>#Ruby</span> <span>#Rails</span> <span>#DynamoDB</span> <span>#Local</span> <span>#AWS</span> <span>#Web</span> </div> </div> </div><div class=blog-pager> <span class=newer-link> <a href=/2015/Nov/15/grunt-and-5-tasks-to-improve-web-performance.html> Newer Post </a> </span> <span class=older-link> <a href=/2015/Nov/03/fix-macbook-pro-keyboard-backlight.html> Older Post </a> </span> </div><div class=comments> <div class=finally> <p><em>I apologise for any typos. If you notice a problem, please let me know.</em> <p>Thank you all for your attention. </div> <div id=disqus_thread></div> <script src=/theme/js/disqus.min.js?81e8a5f5></script> <noscript> Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript> comments powered by Disqus. </a> </noscript> </div></div> </div> </div> <div class=sidebar-wrapper> <div class=widget> <h2>Welcome</h2> <div> <img src=/theme/images/banner.gif alt=Welcome> </div> </div><div class="widget recent-posts"> <h2>Recent Posts</h2> <ul> <li> <a href=/2019/May/20/elasticsearch-data-organization.html> <img alt="Elasticsearch: Data organization" src=https://i.imgur.com/JT4y7Qf.jpg> </a> <a href=/2019/May/20/elasticsearch-data-organization.html>Elasticsearch: Data organization</a> <li> <a href=/2019/May/20/elasticsearch-intro.html> <img alt="Elasticsearch: Intro" src=https://i.imgur.com/JT4y7Qf.jpg> </a> <a href=/2019/May/20/elasticsearch-intro.html>Elasticsearch: Intro</a> <li> <a href=/2019/Apr/20/javascript-popups.html> <img alt="JavaScript: Popups" src=https://i.imgur.com/FxmcwPy.png> </a> <a href=/2019/Apr/20/javascript-popups.html>JavaScript: Popups</a> <li> <a href=/2019/Mar/20/javascript-iterator-and-generator.html> <img alt="JavaScript: Iterator and generator" src=https://i.imgur.com/lev8iT9.jpg> </a> <a href=/2019/Mar/20/javascript-iterator-and-generator.html>JavaScript: Iterator and generator</a> <li> <a href=/2019/Feb/20/javascript-decorator.html> <img alt="JavaScript decorator" src=https://i.imgur.com/Sh3yLI0.png> </a> <a href=/2019/Feb/20/javascript-decorator.html>JavaScript decorator</a> </ul> </div><div class="widget labels"> <h2>Blog Archive</h2> <ul> <li> <a href=/2019/ > 2019 </a> <li> <a href=/2018/ > 2018 </a> <li> <a href=/2017/ > 2017 </a> <li> <a href=/2016/ > 2016 </a> <li> <a href=/2015/ > 2015 </a> <li> <a href=/2014/ > 2014 </a> <li> <a href=/2013/ > 2013 </a> <li> <a href=/2012/ > 2012 </a> <li> <a href=/2011/ > 2011 </a> <li> <a href=/2010/ > 2010 </a> </ul> </div><div class=widget> <h2>Twitter timeline</h2> <a class=twitter-timeline data-height=500 data-dnt=true data-theme=light href=https://twitter.com/_naa_4f data-chrome="noheader nofooter transparent noborders"> Tweets by manhhomienbienthuy </a> </div> </div> </div> <a href=# class="smooth-scroll back-to-top"> <i class="fa fa-arrow-circle-up fa-3x"></i> </a> </main> <footer> <div class=infos> <div class=wrapper> <div class=widget> <a href=/ title="manhhomienbienthuy's space" class=logo> <img alt="manhhomienbienthuy's space" src=/theme/images/logo_white.png> </a> <span class=right>I'm a hacker, enter my world...</span> </div><div class=widget> <p> Created with all my ♥ and soul, dedicated to my love, yunachan <p> Powered by <a href=http://blog.getpelican.com/ target=_blank>Pelican</a>, which takes great advantage of <a href=https://www.python.org/ target=_blank>Python</a> <p> This site content is licensed under a <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank> CC BY-NC-ND 4.0 </a> License. <p> Updated at <a target=_blank href="http://www.timeanddate.com/worldclock/fixedtime.html?iso=2019-06-20T02:42:55"> 2019-06-20 02:42:55 </a> </div><div class=widget> <p> Hosting by <a href=https://manhhomienbienthuy.bitbucket.io/ >Bitbucket</a> and <a href=https://manhhomienbienthuy.github.io/ >Github</a>, image hosting by <a href=https://manhhomienbienthuy.imgur.com/ target=_blank>imgur</a>, <a href=https://instagram.com/manhhomienbienthuy/ target=_blank>Instagram</a> and <a href=https://photos.google.com/ target=_blank>Google Photo</a> <p> Theme based on <a href=https://vanice-veethemes.blogspot.com/ target=_blank>Vanice theme</a>, icons from <a href=https://fontawesome.com/ target=_blank>Font Awesome</a>, comments powered by <a href=https://disqus.com/home/forums/manhhomienbienthuy/ target=_blank>Disqus</a> </div> </div> </div> <div class=credits> <div class=wrapper> <div class=left> <!--
          Regarding copyright, in general, standalone pages (as
          opposed to files generated as part of manuals) on the GNU
          web server should be under CC BY-ND 4.0.  Please do NOT
          change or remove this without talking with the webmasters or
          licensing team first.  Please make sure the copyright date
          is consistent with the document.  For web pages, it is ok to
          list just the latest year the document was modified, or
          published.

          If you wish to list earlier years, that is ok too.  Either
          "2001, 2002, 2003" or "2001-2003" are ok for specifying
          years, as long as each year in the range is in fact a
          copyrightable year, i.e., a year in which the document was
          published (including being publicly visible on the web or in
          a revision control system).
        --> Copyright © 2010-2019 <a href=/pages/about-me.html><strong>manhhomienbienthuy</strong></a>. All rights reserved. </div> <div class=right> <ul> <li><a href=/ >Home</a> <li><a href=/pages/about-me.html>About</a> <li><a href=# class=smooth-scroll>Top ↑</a> </ul> </div> </div> </div></footer> <script src=https://code.jquery.com/jquery-3.2.1.js></script> <script src=//cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js></script> <script src=//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.2/imagesloaded.pkgd.min.js></script> <script src=/theme/js/vpyeu.min.js?d72c87bd></script> <script id=dsq-count-scr src=https://manhhomienbienthuy.disqus.com/count.js async></script>