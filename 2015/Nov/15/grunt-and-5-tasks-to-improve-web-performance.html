<!DOCTYPE html><title>Grunt and 5 tasks to improve web performance - manhhomienbienthuy's space</title> <meta charset=utf-8> <meta name=viewport content="width=device-width, initial-scale=1"> <link rel=apple-touch-icon href=/theme/images/icon-touch.png> <link rel=icon sizes=192x192 href=/theme/images/icon-touch.png> <link rel="shortcut icon" href=/theme/images/favicon.ico> <link rel=author href=/humans.txt> <meta name=msapplication-TileImage content=/theme/images/icon-tile.png> <meta name=twitter:dnt content=on> <meta name=Author content=manhhomienbienthuy> <meta name=rating content=general> <meta name=twitter:card content=product> <meta name=twitter:site content=@_naa_4f> <meta name=twitter:creator content=@_naa_4f> <link href=/feeds/all.atom.xml type=application/atom+xml rel=alternate title="manhhomienbienthuy's space Full Atom Feed"> <meta name=description content="Hiệu suất và hoạt động mượt mà là một yếu tố rất quan trọng với 1 trang Web. Trong bài viết này, tôi sẽ hướng dẫn 1 số task của Grunt giúp cải thiệu hiệu suất của trang Web mà cụ thể ở đây là tốc độ tải trang. Tốc …"> <meta name=keywords content="Grunt, Web, improve, performance, imagemin, uglify, cssmin, uncss, htmlmin, blog, naa, manhhomienbienthuy, pelican, static site generator"> <meta name=twitter:title content="Grunt and 5 tasks to improve web performance - manhhomienbienthuy's space"> <meta name=twitter:description content="Hiệu suất và hoạt động mượt mà là một yếu tố rất quan trọng với 1 trang Web. Trong bài viết này, tôi sẽ hướng dẫn 1 số task của Grunt giúp cải thiệu hiệu suất của trang Web mà cụ thể ở đây là tốc độ tải trang. Tốc …"> <meta name=twitter:image content=/https://i.imgur.com/CQjH59b.jpg> <link rel=stylesheet href=//cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css> <link rel=stylesheet href=//maxcdn.bootstrapcdn.com/font-awesome/4.0.0/css/font-awesome.min.css> <link rel=stylesheet href=/theme/css/vpyeu.min.css?5d2c7d5e> <header> <div class=navbar> <div class=wrapper> <div class=nav-menu> <div class=menu-toggle> <i class="fa fa-reorder"></i> </div> <ul class=menus> <li><a href=/ >Home</a> <li><a href=/category/general.html> General <li><a href=/category/life.html> Life <li><a href=/category/programming.html class=current> Programming <li><a href=/category/travel.html> Travel </ul> </div><div class="right links"> <ul> <li> <a href=https://twitter.com/_naa_4f target=_blank> <i class="fa fa-twitter"></i> </a> <li> <a href=https://instagram.com/manhhomienbienthuy/ target=_blank> <i class="fa fa-instagram"></i> </a> <li> <a href=https://www.facebook.com/manhhomienbienthuy target=_blank> <i class="fa fa-facebook"></i> </a> <li> <a href=https://github.com/manhhomienbienthuy target=_blank> <i class="fa fa-github"></i> </a> <li> <a href=/feeds/all.atom.xml target=_blank> <i class="fa fa-rss"></i> </a> </ul> </div> </div> </div><noscript> <div class="warning head-warn"> <div class=wrapper> <p><strong>Notice:</strong> While JavaScript is not essential for this website, your interaction with the content will be limited. Please turn JavaScript on for the full experience. </div> </div> </noscript><div class=banner> <div class=wrapper> <a href=/ > <img alt="manhhomienbienthuy's space" src=/theme/images/logo.png> </a> </div> </div></header> <main> <div class=wrapper> <div class=main-wrapper> <div class=entry> <div class=entry-detail> <div class=post> <h1 class=title> Grunt and 5 tasks to improve web performance </h1> <div class=meta> Posted in <a href=/category/programming.html>Programming</a> on November 15, 2015 by <a href=/pages/about-me.html>manhhomienbienthuy</a> <span class=right> <i class="fa fa-comments"></i> <a href=#disqus_thread data-disqus-identifier=/2015/Nov/15/grunt-and-5-tasks-to-improve-web-performance.html> Comments </a> </span> </div> <div class=post-body> <img src=https://i.imgur.com/CQjH59b.jpg alt="Grunt and 5 tasks to improve web performance"> <p>Hiệu suất và hoạt động mượt mà là một yếu tố rất quan trọng với 1 trang Web. Trong bài viết này, tôi sẽ hướng dẫn 1 số task của Grunt giúp cải thiệu hiệu suất của trang Web mà cụ thể ở đây là tốc độ tải trang.</p> <p>Tốc độ tải trang nhanh hay chậm phụ thuộc rất lớn vào lượng dữ liệu cần tải về của trang Web đó. Vì vậy trong bài viết này, tôi sẽ tập trung vào cách giảm dung lượng tải về của trang.</p> <h1 id=grunt-la-gi>Grunt là gì?<a class=headerlink href=#grunt-la-gi title="Permanent link">&para;</a></h1> <p>Nếu bạn đang viết những ứng dụng JavaScript hoặc đang phát triển một trang Web, bạn sẽ cần đến các công cụ giúp bạn một số việc như minify CSS, JS, hoặc biên dịch SCSS, CoffeeScript, v.v... Những công việc này hoàn toàn có thể sử dụng những công cụ riêng biệt. Tuy nhiên, nếu chỉ cần đến 1 hoặc 2 công cụ thì có thể dùng riêng được, chứ nếu có nhiều công việc cần làm thì thực hiện chúng một cách riêng rẽ đúng là cực hình. Khi đó bạn cần đến các công cụ có thể chạy các tools đó hoàn toàn tự động.</p> <p>Một số framework như Rails có cơ chế assets pipeline và có thể đặt rake task. Tuy nhiên không phải lúc nào framework cũng có những công cụ như vậy. Khi đó bạn cần các tools chạy task bên ngoài.</p> <p>Hiện nay có nhiều công cụ khác nhau, nhưng phổ biến hơn cả là Grunt và Gulp. Grunt có khoảng 30000 download mỗi ngày. Grunt là một tasks runner cho phép bạn cấu hình và gọi các task hoàn toàn tự động.</p> <p>Grunt là một task runner chạy bằng JavaScript đúng như tên gọi ở trên, nó là một chương trình dùng để gọi các chương trình khác. Những chương trình đó gọi là task của grunt. Thông thường các task này được sử dụng như các công cụ trong quá trình phát triển nên nó còn được gọi là build system.</p> <p>Grunt là task runner nên nó phụ thuộc vào các plugin để chạy các task của mình. Công việc của nó chỉ đơn giản là gọi và thực thi các task này.</p> <p>Việc config Grunt có thể hơi khó khi mới bắt đầu. Nhưng nếu đã quen rồi thì mọi chuyện rất đơn giản. Một khi đã config xong, mỗi khi cần chạy, bạn chỉ cần gõ lệnh</p> <div class=codehilite><pre><span></span><span class=gp>$</span> grunt
</pre></div> <p>là các task sẽ được gọi là thực hiện lần lượt theo config của bạn.</p> <h1 id=cai-at-va-su-dung>Cài đặt và sử dụng<a class=headerlink href=#cai-at-va-su-dung title="Permanent link">&para;</a></h1> <p>Grunt là task runner chạy bằng JavaScript nên để chạy được, máy bạn cần được cài Nodejs.</p> <h2 id=cai-at-nodejs>Cài đặt Nodejs<a class=headerlink href=#cai-at-nodejs title="Permanent link">&para;</a></h2> <p>Cài Nodejs bằng lệnh sau:</p> <div class=codehilite><pre><span></span><span class=gp>$</span> sudo apt-get install nodejs
</pre></div> <p>Sau khi cài Nodejs, Grunt và các plugin của nó có thể dễ dàng cài đặt thông qua <code>npm</code> - trình quản lý package của Nodejs. Grunt version 0.4 yêu cầu Nodejs version từ 0.8 trở nên. Trước khi cài đặt Grunt, có thể bạn cần update <code>npm</code> với lệnh sau:</p> <div class=codehilite><pre><span></span>$ npm update -g npm
</pre></div> <h2 id=cai-grunt-cli>Cài Grunt CLI<a class=headerlink href=#cai-grunt-cli title="Permanent link">&para;</a></h2> <p>Để sử dụng lệnh grunt trên Terminal hoặc các trình shell khác, bạn cần cài Grunt CLI bằng lệnh sau. Có thể bạn cần đến <code>sudo</code> tùy vào OS của bạn:</p> <div class=codehilite><pre><span></span><span class=gp>$</span> npm install -g grunt-cli
</pre></div> <p>Tùy chọn <code>-g</code> ở trên nghĩa là grunt-cli sẽ được cài cho toàn hệ thống. Bạn có thể bỏ nó đi nếu chỉ muốn cài riêng cho project của mình. Nhưng tôi nghĩ bạn nên cài nó để có thể dùng ở tất cả project.</p> <p>Sau khi cài đặt, bạn có thể gọi lệnh <code>grunt</code> từ shell. Tuy nhiên, việc cài đặt cli hoàn toàn không liên quan đến cài đặt bản thân Grunt task runner. Grunt CLI chỉ có nhiệm vụ là gọi grunt và các task được config ở Grunfile. Với cách làm này, nó cho phép bạn sử dụng nhiều phiên bản grunt khác nhau với các project khác nhau.</p> <p>Các package được cài bởi <code>npm</code> thường lưu trong thư mục <code>node_packages</code> và bạn có thể ignore nó nếu sử dụng git hoặc các trình quản lý version tương tự.</p> <p>Việc config Gruntfile tôi sẽ nói ở phần tiếp theo đây.</p> <h2 id=config-grunt>Config grunt<a class=headerlink href=#config-grunt title="Permanent link">&para;</a></h2> <p>Config thông thường của Grunt sẽ gồm 2 file: <code>package.json</code> và Gruntfile được đặt ở thư mục gốc project của bạn. Tuy nhiên bạn có thể đặt chúng ở bất cứ đâu tùy theo cấu trúc project. Khi đó, bạn cần sử dụng config <code>grunt.file.setBase</code> để đặt đường dẫn về thư mục gốc của project. Ví dụ tôi đặt Gruntfile và <code>package.json</code> Trong thư mục <code>grunt</code> thì config của tôi sẽ là:</p> <div class=codehilite><pre><span></span><span class=nx>grunt</span><span class=p>.</span><span class=nx>file</span><span class=p>.</span><span class=nx>setBase</span><span class=p>(</span><span class=s2>&quot;../&quot;</span><span class=p>)</span>
</pre></div> <p>File <code>package.json</code> là file mà <code>npm</code> dùng để lưu các thông tin liên quan đến project. Nó sẽ có danh sách Grunt và các plugin cần thiết của project trong phần <code>devDependencies</code>.</p> <p>Gruntfile là file có tên đầy đủ là <code>Gruntfile.js</code> hoặc <code>Gruntfile.coffee</code> và nó dùng để lưu các config chính liên quan đến các task của Grunt. Gruntfile có thể là một trong 2 file trên, <code>.js</code> hoặc <code>.coffee</code> tùy theo nhu cầu của bạn và project của bạn sử dụng JavaScript hay CoffeeScript.</p> <p>Khi config 2 file trên, chạy <code>npm install</code> nó sẽ tự động cài đặt các package cần thiết để có thể chạy các task của Grunt. Có 1 số cách để tạo file <code>package.json</code> như sau:</p> <ul> <li>Sử dụng <code>grunt-init</code> nó sẽ tự động tạo file <code>package.json</code> cho project của bạn, sau khi bạn confirm một số thông tin cần thiết.</li> <li>Sử dụng <code>npm init</code> sẽ tạo ra một file <code>package.json</code> đơn giản.</li> <li>Tùy vào nhu cầu của bạn, bạn có thể tự viết file <code>package.json</code> cho mình hoặc edit file được tạo ra từ 2 cách trên.</li> </ul> <p>Dưới đây là một ví dụ của file <code>package.json</code></p> <div class=codehilite><pre><span></span><span class=p>{</span>
  <span class=nt>&quot;name&quot;</span><span class=p>:</span> <span class=s2>&quot;my-project-name&quot;</span><span class=p>,</span>
  <span class=nt>&quot;version&quot;</span><span class=p>:</span> <span class=s2>&quot;0.1.0&quot;</span><span class=p>,</span>
  <span class=nt>&quot;devDependencies&quot;</span><span class=p>:</span> <span class=p>{</span>
    <span class=nt>&quot;grunt&quot;</span><span class=p>:</span> <span class=s2>&quot;~0.4.5&quot;</span><span class=p>,</span>
    <span class=nt>&quot;grunt-contrib-jshint&quot;</span><span class=p>:</span> <span class=s2>&quot;~0.10.0&quot;</span><span class=p>,</span>
    <span class=nt>&quot;grunt-contrib-nodeunit&quot;</span><span class=p>:</span> <span class=s2>&quot;~0.4.1&quot;</span><span class=p>,</span>
    <span class=nt>&quot;grunt-contrib-uglify&quot;</span><span class=p>:</span> <span class=s2>&quot;~0.5.0&quot;</span>
  <span class=p>}</span>
<span class=p>}</span>
</pre></div> <h2 id=config-packagejson-va-cai-grunt-cung-cac-plugin>Config <code>package.json</code> và cài Grunt cùng các plugin<a class=headerlink href=#config-packagejson-va-cai-grunt-cung-cac-plugin title="Permanent link">&para;</a></h2> <p>Có một cách khá dễ dàng để cài đặt Grunt và các plugin của nó. Đó là sử dụng lệnh:</p> <div class=codehilite><pre><span></span><span class=gp>$</span> npm install &lt;module&gt; --save-dev
</pre></div> <p>Sử dụng lệnh trên, không chỉ các gói cần thiết được cài đặt, mà nó còn tự động thêm module vào phần <code>devDependencies</code> của file <code>package.json</code>.</p> <p>Ví dụ, lệnh dưới đây sẽ cài đặt Grunt và thêm vào <code>devDependencies</code>:</p> <div class=codehilite><pre><span></span><span class=gp>$</span> npm install grunt --save-dev
</pre></div> <p>Sử dụng lệnh tương tự với các plugin của Grunt. Nếu như bạn làm việc với một project đã có sẵn config của Grunt. Đơn giản, bạn chỉ cần chạy lệnh</p> <div class=codehilite><pre><span></span><span class=gp>$</span> npm install
</pre></div> <p>trong cùng thư mục với config đó. Nó sẽ tự động đọc file <code>package.json</code> và cài đặt các gói cần thiết đã được định nghĩa trong đó.</p> <h2 id=config-gruntfile>Config Gruntfile<a class=headerlink href=#config-gruntfile title="Permanent link">&para;</a></h2> <p>Gruntfile (<code>Gruntfile.js</code> hoặc <code>Gruntfile.coffee</code>) là một file JavaScript (hoặc CoffeeScript) dùng để config cho việc hoạt động của Grunt.</p> <p>Một Gruntfile cần có các thành phần sau:</p> <ul> <li>Hàm wrapper</li> <li>Config cho project và các task</li> <li>Load các plugin và tasks</li> <li>Tùy biến task.</li> </ul> <p>Dưới đây là một ví dụ của Gruntfile. Các thông tin của project được đọc từ file <code>package.json</code>. Gruntfile định nghĩa task uglify để nén các file JavaScript. Khi chạy lênh <code>grunt</code> thì default task <code>uglify</code> sẽ được gọi.</p> <div class=codehilite><pre><span></span><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=kd>function</span><span class=p>(</span><span class=nx>grunt</span><span class=p>)</span> <span class=p>{</span>
  <span class=c1>// Project configuration.</span>
  <span class=nx>grunt</span><span class=p>.</span><span class=nx>initConfig</span><span class=p>({</span>
    <span class=nx>pkg</span><span class=o>:</span> <span class=nx>grunt</span><span class=p>.</span><span class=nx>file</span><span class=p>.</span><span class=nx>readJSON</span><span class=p>(</span><span class=s1>&#39;package.json&#39;</span><span class=p>),</span>
    <span class=nx>uglify</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>options</span><span class=o>:</span> <span class=p>{</span>
        <span class=nx>banner</span><span class=o>:</span> <span class=s1>&#39;/*! &lt;%= pkg.name %&gt; &lt;%= grunt.template.today(&quot;yyyy-mm-dd&quot;) %&gt; */\n&#39;</span>
      <span class=p>},</span>
      <span class=nx>build</span><span class=o>:</span> <span class=p>{</span>
        <span class=nx>src</span><span class=o>:</span> <span class=s1>&#39;src/&lt;%= pkg.name %&gt;.js&#39;</span><span class=p>,</span>
        <span class=nx>dest</span><span class=o>:</span> <span class=s1>&#39;build/&lt;%= pkg.name %&gt;.min.js&#39;</span>
      <span class=p>}</span>
    <span class=p>}</span>
  <span class=p>});</span>

  <span class=c1>// Load the plugin that provides the &quot;uglify&quot; task.</span>
  <span class=nx>grunt</span><span class=p>.</span><span class=nx>loadNpmTasks</span><span class=p>(</span><span class=s1>&#39;grunt-contrib-uglify&#39;</span><span class=p>);</span>

  <span class=c1>// Default task(s).</span>
  <span class=nx>grunt</span><span class=p>.</span><span class=nx>registerTask</span><span class=p>(</span><span class=s1>&#39;default&#39;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;uglify&#39;</span><span class=p>]);</span>
<span class=p>};</span>
</pre></div> <p>Bây giờ, tôi sẽ giải thích từng thành phần của Gruntfile thông qua ví dụ trên.</p> <h3 id=ham-wrapper>Hàm wrapper<a class=headerlink href=#ham-wrapper title="Permanent link">&para;</a></h3> <p>Tất cả các Gruntfile đều được config với mẫu như trên, cho dù nó thay đổi tùy theo project. Bạn có thể tự viết config cho riêng mình, vì suy cho cùng thì đây cũng là code JavaScript mà nó hoạt động như những file JavaScript khác. Tuy nhiên, không nên làm như vậy vì đó không phải là con đường dễ dàng và việc config Grunt cũng không phải là ưu tiên của project.</p> <p>Hàm wrapper là hàm sẽ bao trọn toàn bộ hoạt động của Grunt. Tất cả các config của Grunt và các task của nó đề đặt ở trong hàm này. Hàm này sẽ như sau:</p> <div class=codehilite><pre><span></span><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=kd>function</span><span class=p>(</span><span class=nx>grunt</span><span class=p>)</span> <span class=p>{</span>
  <span class=c1>// Các config khác của Grunt đặt ở đây</span>
<span class=p>};</span>
</pre></div> <h3 id=config-cua-project-va-cac-task>Config của project và các task<a class=headerlink href=#config-cua-project-va-cac-task title="Permanent link">&para;</a></h3> <p>Các task Grunt đều phụ thuộc vào config được định nghĩa bên trong <code>grunt.initConfig</code>.</p> <p>Trong ví dụ của chúng ta, <code>grunt.file.readJSON('package.json')</code> sẽ đọc thông tin JSON từ file <code>package.json</code>. Trong file, các block <code>&lt;% %&gt;</code> là template engine của riêng Grunt và bạn có thể đặt trong đó các biến, tương tự như template engine của các framework lập trình Web thông thường.</p> <p>Các task của Grunt, trong trường hợp của chúng ta là uglify, cần được config mới có thể hoạt động được. Trong trường hợp của chúng ta, task này nhận tùy chọn là thêm banner lên trên cùng của file kết quả.</p> <div class=codehilite><pre><span></span><span class=c1>// Project configuration.</span>
<span class=nx>grunt</span><span class=p>.</span><span class=nx>initConfig</span><span class=p>({</span>
  <span class=nx>pkg</span><span class=o>:</span> <span class=nx>grunt</span><span class=p>.</span><span class=nx>file</span><span class=p>.</span><span class=nx>readJSON</span><span class=p>(</span><span class=s1>&#39;package.json&#39;</span><span class=p>),</span>
  <span class=nx>uglify</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>options</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>banner</span><span class=o>:</span> <span class=s1>&#39;/*! &lt;%= pkg.name %&gt; &lt;%= grunt.template.today(&quot;yyyy-mm-dd&quot;) %&gt; */\n&#39;</span>
    <span class=p>},</span>
    <span class=nx>build</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>src</span><span class=o>:</span> <span class=s1>&#39;src/&lt;%= pkg.name %&gt;.js&#39;</span><span class=p>,</span>
      <span class=nx>dest</span><span class=o>:</span> <span class=s1>&#39;build/&lt;%= pkg.name %&gt;.min.js&#39;</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>});</span>
</pre></div> <h3 id=load-grunt-va-cac-plugin>Load Grunt và các plugin<a class=headerlink href=#load-grunt-va-cac-plugin title="Permanent link">&para;</a></h3> <p>Rất nhiều công cụ liên quan đến quá trình phát triển như cssmin, jsmin, linter, v.v... đều có sẵn các plugin của Grunt tương ứng. Và nếu chúng được định nghĩa trong <code>package.json</code> thì chúng sẽ được <code>npm</code> cài đặt.</p> <p>Để gọi chúng, ở Gruntfile chúng ta cần load Grunt và các plugin này.</p> <div class=codehilite><pre><span></span><span class=c1>// Load the plugin that provides the &quot;uglify&quot; task.</span>
<span class=nx>grunt</span><span class=p>.</span><span class=nx>loadNpmTasks</span><span class=p>(</span><span class=s1>&#39;grunt-contrib-uglify&#39;</span><span class=p>);</span>
</pre></div> <p>Trên đây tôi đã giới thiệu Grunt và cách config chúng cho project của bạn. Tùy vào nhu cầu của bạn, bạn có thể sử dụng nó tùy ý để phục vụ cho công việc của mình. Phần tiếp theo, tôi sẽ giới thiệu một số task của Grunt giúp cải thiệu hiệu suất của trang Web, cụ thể là cải thiện tốc độ tải trang.</p> <h1 id=cac-task-grunt-giup-cai-thien-hieu-suat-trang-web>Các task grunt giúp cải thiện hiệu suất trang Web<a class=headerlink href=#cac-task-grunt-giup-cai-thien-hieu-suat-trang-web title="Permanent link">&para;</a></h1> <p>Dưới đây tôi sẽ giới thiệu 5 task thông dụng và rất hữu ích để cải thiện hiệu suất trang Web của bạn.</p> <h2 id=grunt-contrib-imagemin><a href=https://github.com/gruntjs/grunt-contrib-imagemin>grunt-contrib-imagemin</a><a class=headerlink href=#grunt-contrib-imagemin title="Permanent link">&para;</a></h2> <p>Đây là task đầu tiên tôi muốn nói tới. Lý do rất đơn giản, hình ảnh chính là những dữ liệu nặng nhất trên trang Web của chúng ta.</p> <p>Hãy nhìn vào <a href=http://httparchive.org/interesting.php#bytesperpage>thống kê của HTTParchive.org</a> và bạn dễ dàng nhận ra rằng, trên 63% lưu lượng truy cập vào trang Web là để tải hình ảnh. Vì lý do đó, nên việc giảm dung lượng hình ảnh có ý nghĩa rất lớn trong việc cải thiện tốc độ tải trang Web của bạn. Và grunt-contrib-imagemin là một task giúp làm việc đó.</p> <p>Task này sẽ dụng các tools sau để giúp nén ảnh và qua đó, giảm dung lượng file ảnh cần tải.</p> <ul> <li><a href=https://github.com/kohler/gifsicle>gifsicle</a> để nén các ảnh GIF</li> <li><a href=https://github.com/imagemin/imagemin-jpegtran>jpegtran</a> để nén các ảnh JPEG</li> <li><a href=https://github.com/imagemin/imagemin-optipng>optipng</a> để nén các ảnh PNG</li> <li><a href=https://github.com/svg/svgo>svgo</a> để nén các ảnh SVG</li> </ul> <p>Một config đơn giản cho task này như sau:</p> <div class=codehilite><pre><span></span><span class=nx>imagemin</span><span class=o>:</span> <span class=p>{</span>
  <span class=nx>dist</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>options</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>optimizationLevel</span><span class=o>:</span> <span class=mi>5</span>
    <span class=p>},</span>
    <span class=nx>files</span><span class=o>:</span> <span class=p>[{</span>
      <span class=nx>expand</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
      <span class=nx>cwd</span><span class=o>:</span> <span class=s2>&quot;src/images&quot;</span><span class=p>,</span>
      <span class=nx>src</span><span class=o>:</span> <span class=p>[</span><span class=s2>&quot;**/*.{png,jpg,gif}&quot;</span><span class=p>],</span>
      <span class=nx>dest</span><span class=o>:</span> <span class=s2>&quot;dist/&quot;</span>
    <span class=p>}]</span>
  <span class=p>}</span>
<span class=p>}</span>
</pre></div> <p>Config này cho phép thiết lập mức độ tối ưu hóa thông qua setting của key <code>optimizationLevel</code>. Giá trị có thể thay đổi trong khoảng từ 0 đến 7, nếu bạn không thiết lập cho nó, giá trị default là 3 sẽ được sử dụng. Trong config trên, tất cả các file có phần mở rộng là <code>png</code>, <code>jpg</code>, <code>gif</code> và nằm trong thư mục <code>src/images</code> sẽ được nén và lưu các file kết quả vào thư mục <code>dist</code>.</p> <p>Ngoài ra còn một số task khác cũng có tác dụng giảm dung lượng ảnh cho trang Web như:</p> <ul> <li><a href=https://github.com/JamieMason/grunt-imageoptim>grunt-imageoptim</a> tương tự như grunt-imagemin nhưng chỉ hoạt động trên OS X.</li> <li><a href=https://github.com/andismith/grunt-responsive-images>grunt-responsive-images</a> tạo file ảnh responsive ở các kích thước khác nhau phù hợp với các loại màn hình khác nhau.</li> <li><a href=https://www.npmjs.com/package/grunt-clowncar>grunt-clowncar</a> tác dụng tương tự grunt-responsive-images.</li> <li><a href=https://github.com/sindresorhus/grunt-svgmin>grunt-svgmin</a> nén các file svg cũng sử dụng svgo.</li> <li><a href=https://github.com/marrone/grunt-tinypng>grunt-tinypng</a> nén ảnh sử dụng dịch vụ tinypng.</li> <li><a href=https://www.npmjs.com/package/grunt-spritesmith>grunt-spritesmith</a> tạo một sprite sheet cho các ảnh.</li> <li><a href=https://github.com/somerandomdude/grunt-webp>grunt-webp</a> convert ảnh sang định dang WebP. WebP là định dạng ảnh mới cho phép nén các bức ảnh cả dạng lossless và lossy. Định dạng lossless của WebP có thể nén tới 26% so với file PNG và định dạng lossy thậm chí còn nén được nhiều hơn thế.</li> </ul> <h2 id=grunt-contrib-uglify><a href=https://github.com/gruntjs/grunt-contrib-uglify>grunt-contrib-uglify</a><a class=headerlink href=#grunt-contrib-uglify title="Permanent link">&para;</a></h2> <p>Đây là task dùng để minify các file javascript. Task này không chỉ bỏ tất cả các khoảng trắng không cần thiết (bao gồm dấu cách, dấu xuống dòng, v.v...) mà nó còn đổi tên các biến và các hàm để sử dụng những tên ngắn nhất có thể. Điều này có thêm 1 lợi ích đó là các file javascript sau khi uglify sẽ rất khó đọc, cho dù có dùng các tools beautify cũng không thể khôi phục lại trạng thái ban đầu vì khi đó, các hàm và biến chỉ còn là những cái tên vô nghĩa như <code>a</code>, <code>b</code>, <code>c</code>, v.v...</p> <p>Một vài tùy chọn cho task này đó là sourceMap và banner. Tùy chọn sourceMap sẽ tạo một file map trong cùng thư mục với file đích được tạo ra. Default của option này là <code>false</code>, để kích hoạt nó, bạn set nó là <code>true</code> là được. Tùy chọn banner sẽ chèn thêm một đoạn comment vào đầu file đích. Bạn có thể viết vào đó giải thích ngắn gọn, tên tác giả, version, license, v.v...</p> <p>Dưới đây là một config đơn giản cho task này.</p> <div class=codehilite><pre><span></span><span class=nx>uglify</span><span class=o>:</span> <span class=p>{</span>
  <span class=nx>dist</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>options</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>sourceMap</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
      <span class=nx>banner</span><span class=o>:</span> <span class=s2>&quot;/*! Copyright: manhhomienbienthuy */&quot;</span>
    <span class=p>},</span>
    <span class=nx>files</span><span class=o>:</span> <span class=p>{</span>
      <span class=s1>&#39;dest/output.min.js&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;src/input.js&#39;</span><span class=p>],</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>
</pre></div> <p>Để mình hoạ cho cách làm của task này, tôi có 1 ví dụ với đoạn javaScript sau:</p> <div class=codehilite><pre><span></span><span class=kd>var</span> <span class=nx>MyApplication</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
  <span class=kd>var</span> <span class=nx>data</span> <span class=o>=</span> <span class=s1>&#39;hello&#39;</span><span class=p>;</span>

  <span class=k>this</span><span class=p>.</span><span class=nx>sum</span> <span class=o>=</span> <span class=kd>function</span><span class=p>(</span><span class=nx>first</span><span class=p>,</span> <span class=nx>second</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>return</span> <span class=nx>first</span> <span class=o>+</span> <span class=nx>second</span><span class=p>;</span>
  <span class=p>}</span>

  <span class=k>this</span><span class=p>.</span><span class=nx>showData</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>return</span> <span class=nx>data</span><span class=p>;</span>
  <span class=p>}</span>
<span class=p>};</span>
</pre></div> <p>Sau khi dùng uglify, kết quả thu được sẽ là</p> <div class=codehilite><pre><span></span><span class=kd>var</span> <span class=nx>MyApplication</span><span class=o>=</span><span class=kd>function</span><span class=p>(){</span><span class=kd>var</span> <span class=nx>a</span><span class=o>=</span><span class=s2>&quot;hello&quot;</span><span class=p>;</span><span class=k>this</span><span class=p>.</span><span class=nx>sum</span><span class=o>=</span><span class=kd>function</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span><span class=nx>b</span><span class=p>){</span><span class=k>return</span> <span class=nx>a</span><span class=o>+</span><span class=nx>b</span><span class=p>},</span><span class=k>this</span><span class=p>.</span><span class=nx>showData</span><span class=o>=</span><span class=kd>function</span><span class=p>(){</span><span class=k>return</span> <span class=nx>a</span><span class=p>}};</span>
</pre></div> <p>Ngoài ra có một số task khác giúp tối ưu hóa Javascript:</p> <ul> <li><a href=https://github.com/gmarty/grunt-closure-compiler>grunt-closure-compiler</a> cũng tương tự uglify dùng để compile Javascript.</li> <li><a href=https://github.com/asciidisco/grunt-requirejs>grunt-requirejs</a> tối ưu hóa code Javascript sử dụng <code>r.js</code>.</li> <li><a href=https://github.com/jmreidy/grunt-browserify>grunt-browerify</a> tối ưu hóa code Javascript sử dụng Browserify.</li> </ul> <h2 id=grunt-contrib-cssmin><a href=https://github.com/gruntjs/grunt-contrib-cssmin>grunt-contrib-cssmin</a><a class=headerlink href=#grunt-contrib-cssmin title="Permanent link">&para;</a></h2> <p>Tên của task này đã nói lên tất cả, task này sẽ nén các file css. Công việc của nó là xóa bỏ tất cả các dấu cách thừa trong file css. Cũng tương tự như uglify nó cũng có tùy chọn banner.</p> <p>Một config đơn giản cho task này như sau:</p> <div class=codehilite><pre><span></span><span class=nx>cssmin</span><span class=o>:</span> <span class=p>{</span>
  <span class=nx>dist</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>options</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>banner</span><span class=o>:</span> <span class=s2>&quot;/*! Copyright: manhhomienbienthuy */&quot;</span>
    <span class=p>},</span>
    <span class=nx>files</span><span class=o>:</span> <span class=p>{</span>
      <span class=s1>&#39;dist/css/style.min.css&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;src/css/**/*.css&#39;</span><span class=p>]</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>
</pre></div> <p>Với config trên, cssmin sẽ minify tất cả các file css trong thư mục <code>src/css</code> và lưu kết quả vào 1 file duy nhất <code>style.min.css</code> nằm trong thư mục 'dist/css'. Config trên cũng thêm banner vào đầu file min này.</p> <p>Ngoài ra cũng có một số task khác cũng tăng hiệu suất trang Web của bạn như:</p> <ul> <li><a href=https://github.com/jgallen23/grunt-inline-css>grunt-inline-css</a> chuyển các file css rời thành inline css. Việc sử dụng inline css sẽ giúp trình duyệt render nội dung nhanh hơn do không phải load css thêm nữa.</li> <li><a href=https://www.npmjs.com/package/grunt-combine-media-queries>grunt-combine-media-queries</a> giúp bạn tổng hợp các media query giống nhau vào trong cùng một câu media query.</li> <li><a href=https://github.com/atrolov/grunt-revizor>grunt-revizor</a> nén code css bằng cách thu gọn tên của css selector. Ví dụ <code>.b-tabmenu--item__active--</code> -&gt; <code>.zS</code>, <code>#success_info--</code> -&gt; <code>.e6</code></li> </ul> <blockquote> <p>Ngoài ra có <a href=https://github.com/vol7/shorthand>một tools không phải của grunt</a> có thể thu gọn code css. Ví dụ:</p> <div class=codehilite><pre><span></span><span class=nt>a</span> <span class=p>{</span>
  <span class=k>font-family</span><span class=p>:</span> <span class=n>Arial</span><span class=p>;</span>
  <span class=k>font-style</span><span class=p>:</span> <span class=kc>italic</span><span class=p>;</span>
  <span class=k>font-size</span><span class=p>:</span> <span class=mi>14</span><span class=kt>px</span><span class=p>;</span>
  <span class=k>line-height</span><span class=p>:</span> <span class=mi>18</span><span class=kt>px</span><span class=p>;</span>
  <span class=k>font-weight</span><span class=p>:</span> <span class=kc>bold</span><span class=p>;</span>
  <span class=k>background-image</span><span class=p>:</span> <span class=nb>url</span><span class=p>(</span><span class=s1>&#39;example.png&#39;</span><span class=p>);</span>
  <span class=k>background-color</span><span class=p>:</span> <span class=kc>red</span><span class=p>;</span>
  <span class=k>background-size</span><span class=p>:</span> <span class=kc>cover</span><span class=p>;</span>
  <span class=k>background-repeat</span><span class=p>:</span> <span class=kc>no-repeat</span><span class=p>;</span>
<span class=p>}</span>
</pre></div> <p>=&gt;</p> <div class=codehilite><pre><span></span><span class=nt>a</span> <span class=p>{</span>
  <span class=k>font</span><span class=p>:</span> <span class=kc>italic</span> <span class=kc>bold</span> <span class=mi>14</span><span class=kt>px</span><span class=o>/</span><span class=mi>18</span><span class=kt>px</span> <span class=n>Arial</span><span class=p>;</span>
  <span class=k>background</span><span class=p>:</span> <span class=kc>red</span> <span class=nb>url</span><span class=p>(</span><span class=s1>&#39;example.png&#39;</span><span class=p>)</span> <span class=kc>no-repeat</span> <span class=o>/</span> <span class=kc>cover</span><span class=p>;</span>
<span class=p>}</span>
</pre></div> </blockquote> <h2 id=grunt-uncss><a href=https://github.com/addyosmani/grunt-uncss>grunt-uncss</a><a class=headerlink href=#grunt-uncss title="Permanent link">&para;</a></h2> <p>Một task khác cũng thao tác với các file css đó là grunt-uncss. Task này sẽ loại bỏ tất cả các code css không được dùng từ trong các file của project của bạn. Do đó, nó sẽ giảm kích thước các file css và giảm thời gian tải trang. Điều này thực sự hữu ích khi bạn sẽ dụng các template dựng sẵn của người khác hoặc dùng những framework như Bootstrap hay Foundation. Không phải tất cả code css của họ bạn đều dùng, và giữ chúng lại chỉ làm chậm quá trình tải trang.</p> <p>Có một số giới hạn mà bạn cần tìm hiểu trước ở <a href=https://github.com/addyosmani/grunt-uncss>tài liệu của uncss</a></p> <p>Một demo ở trên trang github của uncss cho thấy rằng, nó có thể giảm dung lượng css của Bootstrap từ 120Kb xuống còn 11Kb bằng cách loại bỏ hết các thành phần không được sử dụng.</p> <p><img alt=uncss src=https://camo.githubusercontent.com/986f80f311f534223b46dfd3addcf1e7257698eb/687474703a2f2f692e696d6775722e636f6d2f7568574d414c482e676966></p> <p>Có một số tùy chọn khi config task này, ví dụ như <code>ignore</code> cho phép chúng ta giữ lại những thành phần cho dù hiện tại nó chưa được sử dụng. Hoặc tùy chọn <code>ignoreSheets</code> cho phép chúng ta giữ lại toàn bộ các file chưa được dùng.</p> <p>Uncss có thể kiểm tra cả những thành phần được render bằng javascript, bằng cách chạy javascript của các trang thông qua <a href=http://phantomjs.org/ >PhantomJS</a>. Tuy nhiên, nếu những render này lấy dữ liệu từ AJAX thì nó chưa làm được. Ngoài ra, có một hạn chế là nó không tương thích với các template engine của các framework, nó chỉ làm việc với các file html mà thôi.</p> <p>Một config ví dụ như sau:</p> <div class=codehilite><pre><span></span><span class=nx>uncss</span><span class=o>:</span> <span class=p>{</span>
  <span class=nx>dist</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>options</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>ignore</span><span class=o>:</span> <span class=p>[</span><span class=sr>/js-.+/</span><span class=p>,</span> <span class=s1>&#39;.special-class&#39;</span><span class=p>],</span>
      <span class=nx>ignoreSheets</span><span class=o>:</span> <span class=p>[</span><span class=sr>/fonts.googleapis/</span><span class=p>],</span>
    <span class=p>},</span>
    <span class=nx>files</span><span class=o>:</span> <span class=p>{</span>
      <span class=s1>&#39;dist/css/unused-removed.css&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;src/index.html&#39;</span><span class=p>,</span> <span class=s1>&#39;src/contact.html&#39;</span><span class=p>,</span> <span class=s1>&#39;src/service.html&#39;</span><span class=p>]</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>
</pre></div> <p>Ngoài grunt-uncss được giới thiệu trên đây, có một task khác là <a href=https://github.com/ullmark/grunt-ucss>grunt-ucss</a> cũng có tác dụng tìm những thành phần css không được sử dụng ở trang. Tuy nhiên, grunt-ucss có hạn chế là nó không loại bỏ những thành phần này cho chúng ta.</p> <h2 id=grunt-contrib-htmlmin><a href=https://github.com/gruntjs/grunt-contrib-htmlmin>grunt-contrib-htmlmin</a><a class=headerlink href=#grunt-contrib-htmlmin title="Permanent link">&para;</a></h2> <p>Đây là task cuối cùng mà tôi muốn đề cập đến, đó là htmlmin, nó sẽ minify html code. Nó không thực sự giúp ích được nhiều, bởi vì trong quá trình phát triển, chúng ta không thể minify các file HTML được. Và cho dù minify thì nó cũng chỉ có thể giảm một vài Kb mà thôi. Tuy nhiên, một vài Kb với mỗi người nhưng nhiều người dùng thì nó cũng có ý nghĩa hết sức quan trọng.</p> <p>Dưới đây là một ví dụ về config của task này:</p> <div class=codehilite><pre><span></span><span class=nx>htmlmin</span><span class=o>:</span> <span class=p>{</span>
  <span class=nx>dist</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>options</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>removeComments</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
      <span class=nx>collapseWhitespace</span><span class=o>:</span> <span class=kc>true</span>
    <span class=p>},</span>
    <span class=nx>files</span><span class=o>:</span> <span class=p>[{</span>
      <span class=nx>expand</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
      <span class=nx>cwd</span><span class=o>:</span> <span class=s1>&#39;src&#39;</span><span class=p>,</span>
      <span class=nx>src</span><span class=o>:</span> <span class=s1>&#39;**/*.html&#39;</span><span class=p>,</span>
      <span class=nx>dest</span><span class=o>:</span> <span class=s1>&#39;dist/&#39;</span>
    <span class=p>}]</span>
  <span class=p>}</span>
<span class=p>}</span>
</pre></div> <p>Với config trên, tất cả các file html trong thư mục <code>src</code> sẽ được minify. Với mỗi file này, htmlmin sẽ xóa tất cả các comment và thu lượng khoảng trắng về mức tối đa, và kết quả được lưu ở <code>dist</code>.</p> <p>Ngoài những task đã kể trên, có một số task cũng giúp tăng hiệu suất trang Web của bạn như:</p> <ul> <li><a href=https://github.com/gruntjs/grunt-contrib-concat>grunt-contrib-concat</a> dùng để nối nhiều file thành 1 file.</li> <li><a href=https://www.npmjs.com/package/grunt-contrib-compress>grunt-contrib-compress</a> dùng để nén file và thư mục.</li> <li><a href=https://github.com/mathiasbynens/grunt-zopfli>grunt-zopfli</a> cũng dùng để nén file, thư mục nhưng sử dụng thuật toán Zopfli. Thuật toán Zopfli có thể nén tốt hơn 3-8% so với zlib.</li> <li><a href=https://github.com/Munter/grunt-reduce>grunt-reduce</a> tự động hóa việc tối ưu toàn bộ các file tĩnh (css, js, ảnh, v.v...)</li> </ul> <h2 id=ket-luan>Kết luận<a class=headerlink href=#ket-luan title="Permanent link">&para;</a></h2> <p>Trong bài viết này, tôi chỉ tập trung vào các task giúp giảm dung lượng những dữ liệu tĩnh để cải thiện tốc độ tải trang Web của bạn. Chúng rất đơn giản, dễ dùng và kết quả thu được biểu hiện rõ ràng ngay trước mắt chúng ta. Hy vọng bài viết có ích cho các bạn đang muốn phát triển Web cho riêng mình :)</p> <p>Đây là config đầy đủ của Gruntjs cho cả 5 task trên.</p> <p>Gruntfile.js</p> <div class=codehilite><pre><span></span><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=kd>function</span><span class=p>(</span><span class=nx>grunt</span><span class=p>)</span> <span class=p>{</span>

  <span class=nx>grunt</span><span class=p>.</span><span class=nx>initConfig</span><span class=p>({</span>
    <span class=nx>pkg</span><span class=o>:</span> <span class=nx>grunt</span><span class=p>.</span><span class=nx>file</span><span class=p>.</span><span class=nx>readJSON</span><span class=p>(</span><span class=s2>&quot;package.json&quot;</span><span class=p>),</span>
    <span class=nx>imagemin</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>dist</span><span class=o>:</span> <span class=p>{</span>
        <span class=nx>options</span><span class=o>:</span> <span class=p>{</span>
          <span class=nx>optimizationLevel</span><span class=o>:</span> <span class=mi>5</span>
        <span class=p>},</span>
        <span class=nx>files</span><span class=o>:</span> <span class=p>[{</span>
           <span class=nx>expand</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
           <span class=nx>cwd</span><span class=o>:</span> <span class=s2>&quot;static_root&quot;</span><span class=p>,</span>
           <span class=nx>src</span><span class=o>:</span> <span class=p>[</span><span class=s2>&quot;**/*.{png,jpg,gif,ico}&quot;</span><span class=p>],</span>
           <span class=nx>dest</span><span class=o>:</span> <span class=s2>&quot;static_root&quot;</span>
        <span class=p>}]</span>
      <span class=p>}</span>
    <span class=p>},</span>
    <span class=nx>uglify</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>dist</span><span class=o>:</span> <span class=p>{</span>
        <span class=nx>options</span><span class=o>:</span> <span class=p>{</span>
           <span class=nx>sourceMap</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
           <span class=nx>banner</span><span class=o>:</span> <span class=s2>&quot;/*! Copyright: manhhomienbienthuy */&quot;</span>
        <span class=p>},</span>
        <span class=nx>files</span><span class=o>:</span> <span class=p>[{</span>
           <span class=nx>expand</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
           <span class=nx>cwd</span><span class=o>:</span> <span class=s2>&quot;static_root&quot;</span><span class=p>,</span>
           <span class=nx>src</span><span class=o>:</span> <span class=p>[</span><span class=s2>&quot;**/*.js&quot;</span><span class=p>],</span>
           <span class=nx>dest</span><span class=o>:</span> <span class=s2>&quot;static_root&quot;</span>
        <span class=p>}]</span>
      <span class=p>}</span>
    <span class=p>},</span>
    <span class=nx>cssmin</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>dist</span><span class=o>:</span> <span class=p>{</span>
        <span class=nx>options</span><span class=o>:</span> <span class=p>{</span>
           <span class=nx>banner</span><span class=o>:</span> <span class=s2>&quot;/*! Copyright: manhhomienbienthuy */&quot;</span>
        <span class=p>},</span>
        <span class=nx>files</span><span class=o>:</span> <span class=p>[{</span>
           <span class=nx>expand</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
           <span class=nx>cwd</span><span class=o>:</span> <span class=s2>&quot;static_root&quot;</span><span class=p>,</span>
           <span class=nx>src</span><span class=o>:</span> <span class=p>[</span><span class=s2>&quot;**/*.css&quot;</span><span class=p>],</span>
           <span class=nx>dest</span><span class=o>:</span> <span class=s2>&quot;static_root&quot;</span>
        <span class=p>}]</span>
      <span class=p>}</span>
    <span class=p>},</span>
    <span class=nx>uncss</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>dist</span><span class=o>:</span> <span class=p>{</span>
        <span class=nx>files</span><span class=o>:</span> <span class=p>{</span>
           <span class=s2>&quot;static_root/css/unused-removed.css&quot;</span><span class=o>:</span> <span class=p>[</span><span class=s2>&quot;templates/*.html&quot;</span><span class=p>]</span>
        <span class=p>}</span>
      <span class=p>}</span>
    <span class=p>},</span>
    <span class=nx>htmlmin</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>dist</span><span class=o>:</span> <span class=p>{</span>
        <span class=nx>options</span><span class=o>:</span> <span class=p>{</span>
           <span class=nx>removeComments</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
           <span class=nx>collapseWhitespace</span><span class=o>:</span> <span class=kc>true</span>
        <span class=p>},</span>
        <span class=nx>files</span><span class=o>:</span> <span class=p>[{</span>
           <span class=nx>expand</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
           <span class=nx>cwd</span><span class=o>:</span> <span class=s2>&quot;templates&quot;</span><span class=p>,</span>
           <span class=nx>src</span><span class=o>:</span> <span class=s2>&quot;**/*.html&quot;</span><span class=p>,</span>
           <span class=nx>dest</span><span class=o>:</span> <span class=s2>&quot;static_root/&quot;</span>
        <span class=p>}]</span>
      <span class=p>}</span>
    <span class=p>}</span>
  <span class=p>});</span>

  <span class=nx>grunt</span><span class=p>.</span><span class=nx>loadNpmTasks</span><span class=p>(</span><span class=s2>&quot;grunt-contrib-imagemin&quot;</span><span class=p>);</span>
  <span class=nx>grunt</span><span class=p>.</span><span class=nx>loadNpmTasks</span><span class=p>(</span><span class=s2>&quot;grunt-contrib-uglify&quot;</span><span class=p>);</span>
  <span class=nx>grunt</span><span class=p>.</span><span class=nx>loadNpmTasks</span><span class=p>(</span><span class=s2>&quot;grunt-contrib-cssmin&quot;</span><span class=p>);</span>
  <span class=nx>grunt</span><span class=p>.</span><span class=nx>loadNpmTasks</span><span class=p>(</span><span class=s2>&quot;grunt-uncss&quot;</span><span class=p>);</span>
  <span class=nx>grunt</span><span class=p>.</span><span class=nx>loadNpmTasks</span><span class=p>(</span><span class=s2>&quot;grunt-contrib-htmlmin&quot;</span><span class=p>);</span>
  <span class=nx>grunt</span><span class=p>.</span><span class=nx>file</span><span class=p>.</span><span class=nx>setBase</span><span class=p>(</span><span class=s1>&#39;../&#39;</span><span class=p>)</span>
  <span class=nx>grunt</span><span class=p>.</span><span class=nx>registerTask</span><span class=p>(</span><span class=s2>&quot;default&quot;</span><span class=p>,</span> <span class=p>[</span><span class=s2>&quot;imagemin&quot;</span><span class=p>,</span> <span class=s2>&quot;uglify&quot;</span><span class=p>,</span> <span class=s2>&quot;cssmin&quot;</span><span class=p>,</span> <span class=s2>&quot;uncss&quot;</span><span class=p>,</span> <span class=s2>&quot;htmlmin&quot;</span><span class=p>]);</span>
<span class=p>};</span>
</pre></div> <p>package.json</p> <div class=codehilite><pre><span></span><span class=p>{</span>
  <span class=nt>&quot;name&quot;</span><span class=p>:</span> <span class=s2>&quot;project&quot;</span><span class=p>,</span>
  <span class=nt>&quot;version&quot;</span><span class=p>:</span> <span class=s2>&quot;1.0.0&quot;</span><span class=p>,</span>
  <span class=nt>&quot;description&quot;</span><span class=p>:</span> <span class=s2>&quot;This is a project&quot;</span><span class=p>,</span>
  <span class=nt>&quot;main&quot;</span><span class=p>:</span> <span class=s2>&quot;Gruntfile.js&quot;</span><span class=p>,</span>
  <span class=nt>&quot;dependencies&quot;</span><span class=p>:</span> <span class=p>{</span>
    <span class=nt>&quot;grunt&quot;</span><span class=p>:</span> <span class=s2>&quot;^0.4.5&quot;</span>
  <span class=p>},</span>
  <span class=nt>&quot;devDependencies&quot;</span><span class=p>:</span> <span class=p>{</span>
    <span class=nt>&quot;grunt-contrib-uglify&quot;</span><span class=p>:</span> <span class=s2>&quot;^0.9.2&quot;</span><span class=p>,</span>
    <span class=nt>&quot;grunt-contrib-cssmin&quot;</span><span class=p>:</span> <span class=s2>&quot;^0.13.0&quot;</span><span class=p>,</span>
    <span class=nt>&quot;grunt-contrib-imagemin&quot;</span><span class=p>:</span> <span class=s2>&quot;^0.9.4&quot;</span><span class=p>,</span>
    <span class=nt>&quot;grunt-uncss&quot;</span><span class=p>:</span> <span class=s2>&quot;^0.4.1&quot;</span><span class=p>,</span>
    <span class=nt>&quot;grunt-contrib-htmlmin&quot;</span><span class=p>:</span> <span class=s2>&quot;^0.4.0&quot;</span>
  <span class=p>},</span>
  <span class=nt>&quot;scripts&quot;</span><span class=p>:</span> <span class=p>{</span>
    <span class=nt>&quot;test&quot;</span><span class=p>:</span> <span class=s2>&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span>
  <span class=p>},</span>
  <span class=nt>&quot;repository&quot;</span><span class=p>:</span> <span class=p>{</span>
    <span class=nt>&quot;type&quot;</span><span class=p>:</span> <span class=s2>&quot;git&quot;</span><span class=p>,</span>
    <span class=nt>&quot;url&quot;</span><span class=p>:</span> <span class=s2>&quot;***.git&quot;</span>
  <span class=p>},</span>
  <span class=nt>&quot;author&quot;</span><span class=p>:</span> <span class=s2>&quot;manhhomienbienthuy&quot;</span><span class=p>,</span>
  <span class=nt>&quot;license&quot;</span><span class=p>:</span> <span class=s2>&quot;MIT&quot;</span>
<span class=p>}</span>
</pre></div> </div> <div class=post-footer> <div class=tags> <i class="fa fa-tags"></i> <span>#Grunt</span> <span>#Web</span> <span>#improve</span> <span>#performance</span> <span>#imagemin</span> <span>#uglify</span> <span>#cssmin</span> <span>#uncss</span> <span>#htmlmin</span> </div> </div> </div><div class=blog-pager> <span class=newer-link> <a href=/2015/Dec/03/test-driven-development.html> Newer Post </a> </span> <span class=older-link> <a href=/2015/Nov/05/set-up-dynamodb-on-local-environment.html> Older Post </a> </span> </div><div class=comments> <div class=finally> <p><em>I apologise for any typos. If you notice a problem, please let me know.</em> <p>Thank you all for your attention. </div> <div id=disqus_thread></div> <script src=/theme/js/disqus.min.js?81e8a5f5></script> <noscript> Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript> comments powered by Disqus. </a> </noscript> </div></div> </div> </div> <div class=sidebar-wrapper> <div class=widget> <h2>Welcome</h2> <div> <img src=/theme/images/banner.gif alt=Welcome> </div> </div><div class="widget recent-posts"> <h2>Recent Posts</h2> <ul> <li> <a href=/2019/May/20/elasticsearch-data-organization.html> <img alt="Elasticsearch: Data organization" src=https://i.imgur.com/JT4y7Qf.jpg> </a> <a href=/2019/May/20/elasticsearch-data-organization.html>Elasticsearch: Data organization</a> <li> <a href=/2019/May/20/elasticsearch-intro.html> <img alt="Elasticsearch: Intro" src=https://i.imgur.com/JT4y7Qf.jpg> </a> <a href=/2019/May/20/elasticsearch-intro.html>Elasticsearch: Intro</a> <li> <a href=/2019/Apr/20/javascript-popups.html> <img alt="JavaScript: Popups" src=https://i.imgur.com/FxmcwPy.png> </a> <a href=/2019/Apr/20/javascript-popups.html>JavaScript: Popups</a> <li> <a href=/2019/Mar/20/javascript-iterator-and-generator.html> <img alt="JavaScript: Iterator and generator" src=https://i.imgur.com/lev8iT9.jpg> </a> <a href=/2019/Mar/20/javascript-iterator-and-generator.html>JavaScript: Iterator and generator</a> <li> <a href=/2019/Feb/20/javascript-decorator.html> <img alt="JavaScript decorator" src=https://i.imgur.com/Sh3yLI0.png> </a> <a href=/2019/Feb/20/javascript-decorator.html>JavaScript decorator</a> </ul> </div><div class="widget labels"> <h2>Blog Archive</h2> <ul> <li> <a href=/2019/ > 2019 </a> <li> <a href=/2018/ > 2018 </a> <li> <a href=/2017/ > 2017 </a> <li> <a href=/2016/ > 2016 </a> <li> <a href=/2015/ > 2015 </a> <li> <a href=/2014/ > 2014 </a> <li> <a href=/2013/ > 2013 </a> <li> <a href=/2012/ > 2012 </a> <li> <a href=/2011/ > 2011 </a> <li> <a href=/2010/ > 2010 </a> </ul> </div><div class=widget> <h2>Twitter timeline</h2> <a class=twitter-timeline data-height=500 data-dnt=true data-theme=light href=https://twitter.com/_naa_4f data-chrome="noheader nofooter transparent noborders"> Tweets by manhhomienbienthuy </a> </div> </div> </div> <a href=# class="smooth-scroll back-to-top"> <i class="fa fa-arrow-circle-up fa-3x"></i> </a> </main> <footer> <div class=infos> <div class=wrapper> <div class=widget> <a href=/ title="manhhomienbienthuy's space" class=logo> <img alt="manhhomienbienthuy's space" src=/theme/images/logo_white.png> </a> <span class=right>I'm a hacker, enter my world...</span> </div><div class=widget> <p> Created with all my ♥ and soul, dedicated to my love, yunachan <p> Powered by <a href=http://blog.getpelican.com/ target=_blank>Pelican</a>, which takes great advantage of <a href=https://www.python.org/ target=_blank>Python</a> <p> This site content is licensed under a <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank> CC BY-NC-ND 4.0 </a> License. <p> Updated at <a target=_blank href="http://www.timeanddate.com/worldclock/fixedtime.html?iso=2019-06-20T02:42:55"> 2019-06-20 02:42:55 </a> </div><div class=widget> <p> Hosting by <a href=https://manhhomienbienthuy.bitbucket.io/ >Bitbucket</a> and <a href=https://manhhomienbienthuy.github.io/ >Github</a>, image hosting by <a href=https://manhhomienbienthuy.imgur.com/ target=_blank>imgur</a>, <a href=https://instagram.com/manhhomienbienthuy/ target=_blank>Instagram</a> and <a href=https://photos.google.com/ target=_blank>Google Photo</a> <p> Theme based on <a href=https://vanice-veethemes.blogspot.com/ target=_blank>Vanice theme</a>, icons from <a href=https://fontawesome.com/ target=_blank>Font Awesome</a>, comments powered by <a href=https://disqus.com/home/forums/manhhomienbienthuy/ target=_blank>Disqus</a> </div> </div> </div> <div class=credits> <div class=wrapper> <div class=left> <!--
          Regarding copyright, in general, standalone pages (as
          opposed to files generated as part of manuals) on the GNU
          web server should be under CC BY-ND 4.0.  Please do NOT
          change or remove this without talking with the webmasters or
          licensing team first.  Please make sure the copyright date
          is consistent with the document.  For web pages, it is ok to
          list just the latest year the document was modified, or
          published.

          If you wish to list earlier years, that is ok too.  Either
          "2001, 2002, 2003" or "2001-2003" are ok for specifying
          years, as long as each year in the range is in fact a
          copyrightable year, i.e., a year in which the document was
          published (including being publicly visible on the web or in
          a revision control system).
        --> Copyright © 2010-2019 <a href=/pages/about-me.html><strong>manhhomienbienthuy</strong></a>. All rights reserved. </div> <div class=right> <ul> <li><a href=/ >Home</a> <li><a href=/pages/about-me.html>About</a> <li><a href=# class=smooth-scroll>Top ↑</a> </ul> </div> </div> </div></footer> <script src=https://code.jquery.com/jquery-3.2.1.js></script> <script src=//cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js></script> <script src=//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.2/imagesloaded.pkgd.min.js></script> <script src=/theme/js/vpyeu.min.js?d72c87bd></script> <script id=dsq-count-scr src=https://manhhomienbienthuy.disqus.com/count.js async></script>