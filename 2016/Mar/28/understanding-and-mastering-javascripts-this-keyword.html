<!DOCTYPE html><title>Understanding and mastering JavaScript's "this" keyword - manhhomienbienthuy's space</title> <meta charset=utf-8> <meta name=viewport content="width=device-width, initial-scale=1"> <link rel=apple-touch-icon href=/theme/images/icon-touch.png> <link rel=icon sizes=192x192 href=/theme/images/icon-touch.png> <link rel="shortcut icon" href=/theme/images/favicon.ico> <link rel=author href=/humans.txt> <meta name=msapplication-TileImage content=/theme/images/icon-tile.png> <meta name=twitter:dnt content=on> <meta name=Author content=manhhomienbienthuy> <meta name=rating content=general> <meta name=twitter:card content=product> <meta name=twitter:site content=@_naa_4f> <meta name=twitter:creator content=@_naa_4f> <link href=/feeds/all.atom.xml type=application/atom+xml rel=alternate title="manhhomienbienthuy's space Full Atom Feed"> <meta name=description content="Từ khóa this của JavaScript là một trong những khái niệm cơ bản nhưng cũng dễ gây nhầm lẫn nhất của ngôn ngữ này. Trong bài viết này, chúng ta sẽ dần dần tìm hiểu và làm sáng tỏ this, sao cho từ bây giờ, bạn không cần phải lo …"> <meta name=keywords content="JavaScript, fundamental, this, keyword, blog, naa, manhhomienbienthuy, pelican, static site generator"> <meta name=twitter:title content="Understanding and mastering JavaScript's " this&quot; keyword - manhhomienbienthuy&#x27;s space&quot;> <meta name=twitter:description content="Từ khóa this của JavaScript là một trong những khái niệm cơ bản nhưng cũng dễ gây nhầm lẫn nhất của ngôn ngữ này. Trong bài viết này, chúng ta sẽ dần dần tìm hiểu và làm sáng tỏ this, sao cho từ bây giờ, bạn không cần phải lo …"> <meta name=twitter:image content=/https://i.imgur.com/kZulBav.png> <link rel=stylesheet href=//cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css> <link rel=stylesheet href=//maxcdn.bootstrapcdn.com/font-awesome/4.0.0/css/font-awesome.min.css> <link rel=stylesheet href=/theme/css/vpyeu.min.css?5d2c7d5e> <header> <div class=navbar> <div class=wrapper> <div class=nav-menu> <div class=menu-toggle> <i class="fa fa-reorder"></i> </div> <ul class=menus> <li><a href=/ >Home</a> <li><a href=/category/general.html> General <li><a href=/category/life.html> Life <li><a href=/category/programming.html class=current> Programming <li><a href=/category/travel.html> Travel </ul> </div><div class="right links"> <ul> <li> <a href=https://twitter.com/_naa_4f target=_blank> <i class="fa fa-twitter"></i> </a> <li> <a href=https://instagram.com/manhhomienbienthuy/ target=_blank> <i class="fa fa-instagram"></i> </a> <li> <a href=https://www.facebook.com/manhhomienbienthuy target=_blank> <i class="fa fa-facebook"></i> </a> <li> <a href=https://github.com/manhhomienbienthuy target=_blank> <i class="fa fa-github"></i> </a> <li> <a href=/feeds/all.atom.xml target=_blank> <i class="fa fa-rss"></i> </a> </ul> </div> </div> </div><noscript> <div class="warning head-warn"> <div class=wrapper> <p><strong>Notice:</strong> While JavaScript is not essential for this website, your interaction with the content will be limited. Please turn JavaScript on for the full experience. </div> </div> </noscript><div class=banner> <div class=wrapper> <a href=/ > <img alt="manhhomienbienthuy's space" src=/theme/images/logo.png> </a> </div> </div></header> <main> <div class=wrapper> <div class=main-wrapper> <div class=entry> <div class=entry-detail> <div class=post> <h1 class=title> Understanding and mastering JavaScript's "this" keyword </h1> <div class=meta> Posted in <a href=/category/programming.html>Programming</a> on March 28, 2016 by <a href=/pages/about-me.html>manhhomienbienthuy</a> <span class=right> <i class="fa fa-comments"></i> <a href=#disqus_thread data-disqus-identifier=/2016/Mar/28/understanding-and-mastering-javascripts-this-keyword.html> Comments </a> </span> </div> <div class=post-body> <img src=https://i.imgur.com/kZulBav.png alt="Understanding and mastering JavaScript's " this&quot; keyword&quot;> <p>Từ khóa <code>this</code> của JavaScript là một trong những khái niệm cơ bản nhưng cũng dễ gây nhầm lẫn nhất của ngôn ngữ này. Trong bài viết này, chúng ta sẽ dần dần tìm hiểu và làm sáng tỏ <code>this</code>, sao cho từ bây giờ, bạn không cần phải lo lắng về nó nữa. Chúng ta sẽ tìm hiểu cách sử dụng <code>this</code> một cách chính xác trong các tình huống khác nhau, kể cả những trường hợp nhạy cảm, nơi mà <code>this</code> rất khó nắm bắt.</p> <p>Về cơ bản, chúng ta sử dụng <code>this</code> tương tự như cách mà chúng ta sử dụng đại từ nhân xưng trong tiếng Anh. Ví dụ câu tiếng Anh như sau:</p> <blockquote> <p>John is running fast because <strong>he</strong> is trying to catch the train.</p> </blockquote> <p>Đại từ nhân xưng "he" trong câu này, là để chỉ John. Chúng ta có thể viết nó lại như sau mà ý nghĩa không thay đổi:</p> <blockquote> <p>John is running fast because <strong>John</strong> is trying to catch the train.</p> </blockquote> <p>Tuy nhiên, chúng ta không cần thiết phải gọi lại John trong tình huống này, như vậy câu bị lặp lại và nghe không được hay lắm. Trong trường hợp này, chúng ta có thể dùng đại từ nhân xưng để thay thế, câu văn nghe sẽ hay hơn.</p> <p>Cũng tương tự như vậy, trong JavaScript, chúng ta dùng từ khóa <code>this</code> để đại diện cho một đối tượng. Đối tượng đó là chủ thế của ngữ cảnh, hoặc là chủ thế của code đang được chạy.</p> <p>Chúng ta hãy xem xét ví dụ sau:</p> <div class=codehilite><pre><span></span><span class=kd>var</span> <span class=nx>person</span> <span class=o>=</span> <span class=p>{</span>
    <span class=nx>firstName</span><span class=o>:</span> <span class=s2>&quot;Alice&quot;</span><span class=p>,</span>
    <span class=nx>lastName</span><span class=o>:</span> <span class=s2>&quot;Bob&quot;</span><span class=p>,</span>
    <span class=nx>fullName</span><span class=o>:</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
        <span class=c1>// Việc sử dụng &quot;this&quot; cũng tương tự như việc sử dụng &quot;he&quot;</span>
        <span class=c1>// trong câu tiếng Anh ở trên.</span>
        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>firstName</span> <span class=o>+</span> <span class=s2>&quot; &quot;</span> <span class=o>+</span> <span class=k>this</span><span class=p>.</span><span class=nx>lastName</span><span class=p>);</span>
        <span class=c1>// Chúng ta cũng có thể viết thế này.</span>
        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>person</span><span class=p>.</span><span class=nx>firstName</span> <span class=o>+</span> <span class=s2>&quot; &quot;</span> <span class=o>+</span> <span class=nx>person</span><span class=p>.</span><span class=nx>lastName</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>
</pre></div> <p>Nếu chúng ta sử dụng <code>person.firstName</code> và <code>person.lastName</code> như ví dụ ở trên, code của chúng ta có thể sẽ trở nên khó hiểu. Tất nhiên, nếu chỉ có code đơn giản như ví dụ trên thì nó sẽ chạy tốt.</p> <p>Tuy nhiên, hãy thử tưởng tượng, sau một thời gian phát triển, code JavaScript của bạn đã khá lớn. Và chẳng biết vô tình hay cố ý, <code>person</code> ở trên là một biến cục bộ trong một hàm nào đó, và tồn tại một biến toàn cục khác cũng có tên là <code>person</code>.</p> <p>Lúc này, nếu như có lỗi xảy ra, việc debug có thể khá khó khăn. Rất có thể, bạn sẽ mất kha khá thời gian thắc mắc xem, việc tham chiếu <code>person.firstName</code> có thể sẽ gọi đến thuộc tính <code>firstName</code> của biến toàn cục hay biến cục bộ khi có 2 biến với tên giống nhau.</p> <p>Để tránh tự làm khó mình (và làm khó cả những người cùng team), chúng ta nên sử dụng từ khóa <code>this</code>, không chỉ vì sự thẩm mỹ mà còn vì sự chính xác. Việc sử dụng <code>this</code> làm code của chúng ta rõ ràng hơn, giống như đại từ nhân xưng trong tiếng Anh vậy.</p> <p>Cũng giống như đại từ nhân xưng "he" dùng để chỉ các tiền đề (danh từ mà đại từ đó chỉ đến), từ khóa <code>this</code> của JavaScript cũng tương tự, được sử dụng để tham chiếu đến các đối tượng mà hàm (nơi mà <code>this</code> được sử dụng) bị ràng buộc.</p> <p>Từ khóa <code>this</code> không chỉ tham chiếu đến đối tượng, mà nó còn chứa giá trị của đối tượng đó. Cũng như một đại từ nhân xưng, <code>this</code> có thể hiểu là một sự thay thế rõ ràng để tham chiếu đến các đối tượng ở trong <strong>ngữ cảnh</strong> (đối tượng tiền đề). Chúng ta sẽ tìm hiểu thêm về ngữ cảnh ở những phần sau.</p> <h1 id=nhung-ieu-co-ban-ve-tu-khoa-this-cua-javascript>Những điều cơ bản về từ khóa <code>this</code> của JavaScript<a class=headerlink href=#nhung-ieu-co-ban-ve-tu-khoa-this-cua-javascript title="Permanent link">&para;</a></h1> <p>Trước hết, bạn phải hiểu rằng, tất cả các hàm của JavaScript đều có thuộc tính, giống như mọi đối tượng khác. Và khi một hàm được thực thi, nó sẽ có thuộc tính <code>this</code> - một biến với giá trị là <strong>đối tượng đã gọi hàm sử dụng <code>this</code></strong>.</p> <p><code>this</code> luôn luôn tham chiếu (và có giá trị của) đối tượng - một đối tượng duy nhất - và nó thường được sử dụng bên trong hàm hay phương thức, mặc dù nó có thể dùng được một cách toàn cục bên ngoài hàm.</p> <p>Lưu ý rằng, nếu chúng ta sử dụng <strong><a href=http://www.w3schools.com/js/js_strict.asp>strict mode</a></strong>, <code>this</code> sẽ là undefined trong các hàm toàn cục và trong các hàm vô danh không ràng buộc đối tượng nào cả.</p> <p>Nếu <code>this</code> được sử dụng bên trong một hàm (tạm gọi là hàm A) thì nó sẽ chứa giá trị của đối tượng gọi hàm A. Chúng ta cần <code>this</code> để truy cập đến các phương thức và thuộc tính của đối tượng gọi hàm A, bởi vì chúng ta thường không biết tên của đối tượng đó. Thậm chí có lúc không có tên nào có thể dùng để tham chiếu đến đối tượng, chúng ta chỉ có thể dùng <code>this</code> mà thôi. Thực tế, <code>this</code> có thể coi là một tham chiếu đến "đối tượng tiền đề" - đối tượng gọi hàm.</p> <p>Dưới đây là một ví dụ rất cơ bản minh họa cho việc sử dụng <code>this</code> trong JavaScript:</p> <div class=codehilite><pre><span></span><span class=kd>var</span> <span class=nx>person</span> <span class=o>=</span> <span class=p>{</span>
    <span class=nx>firstName</span><span class=o>:</span> <span class=s2>&quot;Alice&quot;</span><span class=p>,</span>
    <span class=nx>lastName</span><span class=o>:</span> <span class=s2>&quot;Bob&quot;</span><span class=p>,</span>
    <span class=c1>// Bởi vì từ khóa &quot;this&quot; được sử dụng trong phương thức</span>
    <span class=c1>// showFullName dưới đây, và phương thức này được định nghĩa trong</span>
    <span class=c1>// đối tượng person, &quot;this&quot; sẽ có giá trị của đối tượng person bởi</span>
    <span class=c1>// vì đối tượng này sẽ gọi showFullName()</span>
    <span class=nx>showFullName</span><span class=o>:</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>firstName</span> <span class=o>+</span> <span class=s2>&quot; &quot;</span> <span class=o>+</span> <span class=k>this</span><span class=p>.</span><span class=nx>lastName</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=nx>person</span><span class=p>.</span><span class=nx>showFullName</span><span class=p>();</span> <span class=c1>// Alice Bob</span>
</pre></div> <p>Một ví dụ khác về việc sử dụng <code>this</code> với jQuery:</p> <div class=codehilite><pre><span></span><span class=c1>// Code rất thông dụng khi sử dụng jQuery</span>
<span class=nx>$</span><span class=p>(</span><span class=s2>&quot;button&quot;</span><span class=p>).</span><span class=nx>click</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
    <span class=c1>// $(this) sẽ có giá trị của đối tượng button (`$(&quot;button&quot;)`) bởi</span>
    <span class=c1>// vì đối tượng này gọi phương thức click()</span>
    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>$</span><span class=p>(</span><span class=k>this</span><span class=p>).</span><span class=nx>prop</span><span class=p>(</span><span class=s2>&quot;name&quot;</span><span class=p>));</span>
<span class=p>});</span>
</pre></div> <p>Việc sử dụng jQuery tương đối đặc biệt một chút. Cú pháp <code>$(this)</code> là cú pháp của jQuery cho từ khóa <code>this</code> của JavaScript, được sử dụng bên trong hàm vô danh (hàm này được thực thi trong phương thức <code>click</code> của button). Lý do <code>$(this)</code> được ràng buộc với button là bởi vì thư viện jQuery đã "gán" <code>$(this)</code> với đối tượng gọi phương thức <code>click</code>. Vì vậy, <code>$(this)</code> sẽ có giá trị của đối tượng button trong jQuery (<code>$("button")</code>), ngay cả khi <code>$(this)</code> được sử dụng bên trong một hàm vô danh và đúng ra nó không thể tham chiếu đến đối tượng "<code>this</code>" ở ngoài.</p> <p>Chú ý rằng, button là một phần tử DOM trong trang HTML, nên nó cũng là một đối tượng. Trong trường hợp này, nó là một đối tượng jQuery bởi vì nó được bao với hàm <code>$()</code> của jQuery.</p> <h2 id=luu-y-voi-tu-khoa-this>Lưu ý với từ khóa <code>this</code><a class=headerlink href=#luu-y-voi-tu-khoa-this title="Permanent link">&para;</a></h2> <p>Nếu bạn đã hiểu những điều cơ bản về từ khóa <code>this</code> của JavaScript, bạn sẽ hiểu thêm một sự thật thú vị sau: <code>this</code> không được gán giá trị cho đến khi một đối tượng gọi một hàm có có chứa <code>this</code> bên trong. Để đơn giản, nhưng hàm có chứa <code>this</code> chúng ta sẽ gọi là "hàm this".</p> <p>Ngay cả khi <code>this</code> xuất hiện và tham chiếu đến đối tượng nơi mà nó được định nghĩa, nó không thực sự được gán giá trị cho đến khi một đối tượng gọi "hàm this". Và giá trị được gán đó chỉ dựa vào đối tượng đã gọi "hàm this". <code>this</code> có giá trị của đối tượng này trong hầu hết các hoàn cảnh. Tuy nhiên, vẫn có một vài trường hợp, giá trị của <code>this</code> rất khó xác định. Chúng ta sẽ dần dần tìm hiểu trong phần tiếp theo.</p> <h1 id=su-dung-this-mot-cach-toan-cuc>Sử dụng <code>this</code> một cách toàn cục<a class=headerlink href=#su-dung-this-mot-cach-toan-cuc title="Permanent link">&para;</a></h1> <p>Với phạm vi toàn cục, khi code được thực thi ở trình duyệt, mọi biến và hàm toàn cục đều được định nghĩa trên đối tượng <code>window</code>. Vì vậy, khi chúng ta sử dụng <code>this</code> trong các hàm toàn cục, nó tham chiếu đến (và có giá trị của) đối tượng <code>window</code>. (Tuy nhiên, nếu sử dụng strict mode thì chúng ta không thể dùng <code>this</code> được.) Đối tượng <code>window</code> là container chính của toàn bộ code JavaScript của trang Web.</p> <p>Do đó:</p> <div class=codehilite><pre><span></span><span class=kd>var</span> <span class=nx>firstName</span> <span class=o>=</span> <span class=s2>&quot;Alice&quot;</span><span class=p>,</span> <span class=nx>lastName</span> <span class=o>=</span> <span class=s2>&quot;Bob&quot;</span><span class=p>;</span>

<span class=kd>function</span> <span class=nx>showFullName</span><span class=p>()</span> <span class=p>{</span>
    <span class=c1>// &quot;this&quot; trong hàm này sẽ có giá trị của đối tượng window bởi vì</span>
    <span class=c1>// showFullName() là hàm được định nghĩa một cách toàn cục, cũng</span>
    <span class=c1>// như các biến firstName và lastName</span>
    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>firstName</span> <span class=o>+</span> <span class=s2>&quot; &quot;</span> <span class=o>+</span> <span class=k>this</span><span class=p>.</span><span class=nx>lastName</span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>var</span> <span class=nx>person</span> <span class=o>=</span> <span class=p>{</span>
    <span class=nx>firstName</span><span class=o>:</span> <span class=s2>&quot;Charles&quot;</span><span class=p>,</span>
    <span class=nx>lastName</span><span class=o>:</span> <span class=s2>&quot;David&quot;</span><span class=p>,</span>
    <span class=nx>showFullName</span><span class=o>:</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
        <span class=c1>// &quot;this&quot; trong hàm này tham chiếu đến đối tượng person, bởi</span>
        <span class=c1>// vì showFullName là hàm được gọi bởi đói tượng này</span>
        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>firstName</span> <span class=o>+</span> <span class=s2>&quot; &quot;</span> <span class=o>+</span> <span class=k>this</span><span class=p>.</span><span class=nx>lastName</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=nx>showFullName</span><span class=p>();</span> <span class=c1>// Alice Bob</span>

<span class=c1>// window là đối tượng mà mọi biến và hàm toàn cục được định nghĩa</span>
<span class=c1>// trên đó, vì thế:</span>
<span class=nb>window</span><span class=p>.</span><span class=nx>showFullName</span><span class=p>();</span> <span class=c1>// Alice Bob</span>

<span class=c1>// &quot;this&quot; bên trong phương thức showFullName định nghĩa bên trong đối</span>
<span class=c1>// tượng person sẽ tham chiếu đến đối tượng đó, vì vậy:</span>
<span class=nx>person</span><span class=p>.</span><span class=nx>showFullName</span><span class=p>();</span> <span class=c1>// Charles David</span>
</pre></div> <h1 id=mot-so-truong-hop-de-nham-lan-ve-this>Một số trường hợp dễ nhầm lẫn về <code>this</code><a class=headerlink href=#mot-so-truong-hop-de-nham-lan-ve-this title="Permanent link">&para;</a></h1> <p>Những điều về <code>this</code> rất cơ bản đã được trình bày ở trên. Tuy nhiên, khi làm việc thực tế, có những trường hợp <code>this</code> trở nên rất khó hiểu và khó nắm bắt. Trong phần này, chúng ta sẽ cùng tìm hiểu những tình huống như vậy, và cách xử lý tương ứng.</p> <h2 id=mot-vai-van-e-ve-ngu-canh>Một vài vấn đề về "ngữ cảnh"<a class=headerlink href=#mot-vai-van-e-ve-ngu-canh title="Permanent link">&para;</a></h2> <p>"Ngữ cảnh" trong Javascritp cũng tượng tự như chủ ngữ trong câu tiếng Anh. Chúng ta sẽ lấy ví dụ một câu tiếng Anh như sau:</p> <blockquote> <p>John is the winner who returned the money.</p> </blockquote> <p>Chủ ngữ trong câu này là John, và chúng ta có thể nói rằng "ngữ cảnh" của câu là John bởi vì mục tiêu chính của câu, mọi sự tập trung đều nhằm đến John. Ở đây, đại từ nhân xưng "who" cũng là chỉ John. Chúng ta có thể ngắt mệnh đề ở đây. Chúng ta có một đối tượng đang được nói đến là John (ngữ cảnh hiện tại), chúng ta có thể chuyển mệnh đề sang cho một đối tượng khác (ngữ cảnh mới).</p> <p>Tương tự, với JavaScript, chúng ta có:</p> <div class=codehilite><pre><span></span><span class=kd>var</span> <span class=nx>person</span> <span class=o>=</span> <span class=p>{</span>
    <span class=nx>firstName</span><span class=o>:</span> <span class=s2>&quot;Alice&quot;</span><span class=p>,</span>
    <span class=nx>lastName</span><span class=o>:</span> <span class=s2>&quot;Bob&quot;</span><span class=p>,</span>
    <span class=nx>showFullName</span><span class=o>:</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
        <span class=c1>// &quot;Ngữ cảnh&quot;</span>
        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>firstName</span> <span class=o>+</span> <span class=s2>&quot; &quot;</span> <span class=o>+</span> <span class=k>this</span><span class=p>.</span><span class=nx>lastName</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=c1>// &quot;Ngữ cảnh&quot;, khi chúng ta gọi showFullName là đối tượng person, khi</span>
<span class=c1>// chúng ta gọi showFullName cho đối tượng này.  Và &quot;this&quot; trong</span>
<span class=c1>// phương thức này sẽ có giá trị của đối tượng person.</span>
<span class=nx>person</span><span class=p>.</span><span class=nx>showFullName</span><span class=p>();</span> <span class=c1>// Alice Bob</span>

<span class=c1>//  Nếu chúng ta gọi showFullName với đối tượng khác:</span>
<span class=kd>var</span> <span class=nx>anotherPerson</span> <span class=o>=</span> <span class=p>{</span>
    <span class=nx>firstName</span><span class=o>:</span> <span class=s2>&quot;VietPhuong&quot;</span><span class=p>,</span>
    <span class=nx>lastName</span><span class=o>:</span> <span class=s2>&quot;Doan&quot;</span>
<span class=p>};</span>

<span class=c1>// Chúng ta có thể sử dụng phương thức apply để gán giá trị &quot;this&quot; một</span>
<span class=c1>// cách rõ ràng hơn trong phương thức apply.  &quot;this&quot; sẽ có giá trị của</span>
<span class=c1>// bất cứ thứ gì gọi hàm this.  Vì thế:</span>
<span class=nx>person</span><span class=p>.</span><span class=nx>showFullName</span><span class=p>.</span><span class=nx>apply</span><span class=p>(</span><span class=nx>anotherPerson</span><span class=p>);</span> <span class=c1>// VietPhuong Doan</span>

<span class=c1>// Ngữ cảnh ở đây đã thay đổi thành anotherPerson bởi vì đây là đối</span>
<span class=c1>// tượng gọi phương thức person.showFullName() thông qua phương thức</span>
<span class=c1>// apply()</span>
</pre></div> <p>Điểm cốt yếu ở đây là đối tượng gọi "hàm this" sẽ ở trong ngữ cảnh, và chúng ta có thể thay đổi ngữ cảnh bằng cách gọi hàm this bằng đối tượng khác. Đây sẽ là đối tượng trong ngữ cảnh mới.</p> <p>Dưới đây là một vài tình huống mà <code>this</code> sẽ trở nên rất khó nắm bắt, tất cả đều bắt nguồn từ việc ngữ cảnh đã thay đổi.</p> <h2 id=su-dung-this-trong-phuong-thuc-uoc-truyen-nhu-callback>Sử dụng <code>this</code> trong phương thức được truyền như callback<a class=headerlink href=#su-dung-this-trong-phuong-thuc-uoc-truyen-nhu-callback title="Permanent link">&para;</a></h2> <p>Mọi chuyện sẽ rối tung rối mù khi chúng ta truyền phương thức (có sử dụng <code>this</code>) như một tham số để sử dụng như callback. Ví dụ:</p> <div class=codehilite><pre><span></span><span class=c1>// Chúng ta có một đối tượng đơn giản với phương thức clickHandler.</span>
<span class=c1>// Đây là phương thức là chúng ta muốn gọi khi một button được click.</span>
<span class=kd>var</span> <span class=nx>user</span> <span class=o>=</span> <span class=p>{</span>
    <span class=nx>data</span><span class=o>:</span> <span class=p>[</span>
        <span class=p>{</span><span class=nx>name</span><span class=o>:</span> <span class=s2>&quot;T. Woods&quot;</span><span class=p>,</span> <span class=nx>age</span><span class=o>:</span> <span class=mi>37</span><span class=p>},</span>
        <span class=p>{</span><span class=nx>name</span><span class=o>:</span> <span class=s2>&quot;P. Mickelson&quot;</span><span class=p>,</span> <span class=nx>age</span><span class=o>:</span> <span class=mi>43</span><span class=p>}</span>
    <span class=p>],</span>
    <span class=nx>clickHandler</span><span class=o>:</span><span class=kd>function</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
        <span class=c1>// Chọn ngẫu nhiên 0 hoặc 1</span>
        <span class=kd>var</span> <span class=nx>randomNum</span> <span class=o>=</span> <span class=p>((</span><span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>|</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span>

        <span class=c1>// Dòng dưới đây sẽ in ra tên và tuối của một user ngẫu nhiên</span>
        <span class=c1>// lấy từ array</span>
        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>data</span><span class=p>[</span><span class=nx>randomNum</span><span class=p>].</span><span class=nx>name</span> <span class=o>+</span> <span class=s2>&quot; &quot;</span> <span class=o>+</span> <span class=k>this</span><span class=p>.</span><span class=nx>data</span><span class=p>[</span><span class=nx>randomNum</span><span class=p>].</span><span class=nx>age</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=c1>// button được bảo bởi hàm jQuery $, nên nó trở thành một đối tượng</span>
<span class=c1>// jQuery.  Và output sẽ la undefined bởi vì không có thuộc tính data</span>
<span class=c1>// cho đối tượng button</span>

<span class=nx>$</span><span class=p>(</span><span class=s2>&quot;button&quot;</span><span class=p>).</span><span class=nx>click</span><span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>clickHandler</span><span class=p>);</span> <span class=c1>// Cannot read property &#39;0&#39; of undefined</span>
</pre></div> <p>Với code trên, bởi vì button (<code>$("button")</code>) là một đối tượng, và chúng ta truyền phương thức <code>user.clickHandler</code> vào phương thức <code>click</code> của button như một callback. Và chúng ta đã biết rằng, <code>this</code> trong phương thức <code>user.clickHandler</code> sẽ không tham chiếu đến đối tượng <code>user</code> nữa mà bây giờ, nó sẽ tham chiếu đến đối tượng mà nó được gọi. Trong trường hợp này, nó sẽ tham chiếu đến đối tượng button, bởi vì phương thức <code>user.clickHandler</code> sẽ được thực thi trong phương thức <code>click</code> của đối tượng button.</p> <p>Lưu ý rằng, kể cả chúng ta đã gọi phương thức <code>clickHandler()</code> kèm với đối tượng <code>user</code> (điều này là bắt buộc bởi <code>clickHandler</code> là phương thức của <code>user</code>), bản thân phương thức <code>clickHandler</code> được thực thi với đối tượng là button, và đây là ngữ cảnh của nó. Vì vậy, <code>this</code> sẽ tham chiếu đến đối tượng này (<code>$("button")</code>).</p> <p><strong>Giải pháp</strong></p> <p>Bởi vì chúng ta cần <code>this.data</code> tham chiếu đến thuộc tính <code>data</code> của đối tượng <code>user</code>, chúng ta có thể sử dụng các phương thức <code>bind</code>, <code>apply</code>, <code>call</code> để chỉ định giá trị của <code>this</code>.</p> <p>Để giải quyết vấn đề trên, chúng ta có thể sử dụng <code>bind</code>. Thay vì:</p> <div class=codehilite><pre><span></span><span class=nx>$</span><span class=p>(</span><span class=s2>&quot;button&quot;</span><span class=p>).</span><span class=nx>click</span><span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>clickHandler</span><span class=p>);</span>
</pre></div> <p>Chúng ta cần <strong>bind</strong> phương thức <code>clickHandler</code> vào đối tượng <code>user</code> như sau:</p> <div class=codehilite><pre><span></span><span class=nx>$</span><span class=p>(</span><span class=s2>&quot;button&quot;</span><span class=p>).</span><span class=nx>click</span><span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>clickHandler</span><span class=p>.</span><span class=nx>bind</span><span class=p>(</span><span class=nx>user</span><span class=p>));</span> <span class=c1>// P. Mickelson 43</span>
</pre></div> <h2 id=su-dung-this-trong-closure>Sử dụng <code>this</code> trong closure<a class=headerlink href=#su-dung-this-trong-closure title="Permanent link">&para;</a></h2> <p>Một trường hợp khác cũng rất dễ nhầm lẫn <code>this</code>, đó là chúng ta sử dụng nó ở một hàm lồng trong hàm khác (một closure). Một điểm cần lưu ý là closure không thể truy cập biến <code>this</code> ở bên ngoài thông qua từ khóa <code>this</code>, bởi vì <code>this</code> chỉ có thể truy cập ở phạm vi chính hàm mà nó được sử dụng mà thôi. Ví dụ:</p> <div class=codehilite><pre><span></span><span class=kd>var</span> <span class=nx>user</span> <span class=o>=</span> <span class=p>{</span>
    <span class=nx>tournament</span><span class=o>:</span> <span class=s2>&quot;The Masters&quot;</span><span class=p>,</span>
    <span class=nx>data</span><span class=o>:</span> <span class=p>[</span>
        <span class=p>{</span><span class=nx>name</span><span class=o>:</span> <span class=s2>&quot;T. Woods&quot;</span><span class=p>,</span> <span class=nx>age</span><span class=o>:</span> <span class=mi>37</span><span class=p>},</span>
        <span class=p>{</span><span class=nx>name</span><span class=o>:</span> <span class=s2>&quot;P. Mickelson&quot;</span><span class=p>,</span> <span class=nx>age</span><span class=o>:</span> <span class=mi>43</span><span class=p>}</span>
    <span class=p>],</span>

    <span class=nx>clickHandler</span><span class=o>:</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
        <span class=c1>// Việc sử dụng this.data ở đây không vấn đề gì, bởi vì &quot;this&quot;</span>
        <span class=c1>// tham chiếu đến đối tượng user và data là một thuộc tính của</span>
        <span class=c1>// đối tượng.</span>
        <span class=k>this</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>forEach</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>person</span><span class=p>)</span> <span class=p>{</span>
            <span class=c1>// Nhưng ở trong hàm vô danh này (nó được truyền cho</span>
            <span class=c1>// phương thức forEach), &quot;this&quot; không tham chiếu đến đối</span>
            <span class=c1>// tượng user nữa.  Hàm này không thể truy cập &quot;this&quot; của</span>
            <span class=c1>// hàm bên ngoài.</span>
            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&quot;What is This referring to? &quot;</span> <span class=o>+</span> <span class=k>this</span><span class=p>);</span> <span class=c1>//[object Window]</span>
            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>person</span><span class=p>.</span><span class=nx>name</span> <span class=o>+</span> <span class=s2>&quot; is playing at &quot;</span> <span class=o>+</span> <span class=k>this</span><span class=p>.</span><span class=nx>tournament</span><span class=p>);</span>
            <span class=c1>// T. Woods is playing at undefined</span>
            <span class=c1>// P. Mickelson is playing at undefined</span>
        <span class=p>})</span>
    <span class=p>}</span>

<span class=p>}</span>

<span class=nx>user</span><span class=p>.</span><span class=nx>clickHandler</span><span class=p>();</span> <span class=c1>// What is &quot;this&quot; referring to? [object Window]</span>
</pre></div> <p><code>this</code> bên trong hàm vô danh không thể truy cập <code>this</code> của hàm bên ngoài, nên nó sẽ được gán cho đối tượng <code>window</code> (nếu không sử dụng strict mode).</p> <p><strong>Giải pháp</strong></p> <p>Để ứng phó với vấn đề sử dụng <code>this</code> bên trong hàm vô danh được truyền cho phương thức <code>forEach</code>, chúng ta sử dụng một kỹ thuật rất phổ biến trong JavaScript, đó là gán giá trị của <code>this</code> cho một biến khác trước khi chúng ta vào hàm <code>forEach</code>.</p> <div class=codehilite><pre><span></span><span class=kd>var</span> <span class=nx>user</span> <span class=o>=</span> <span class=p>{</span>
    <span class=nx>tournament</span><span class=o>:</span> <span class=s2>&quot;The Masters&quot;</span><span class=p>,</span>
    <span class=nx>data</span><span class=o>:</span> <span class=p>[</span>
        <span class=p>{</span><span class=nx>name</span><span class=o>:</span> <span class=s2>&quot;T. Woods&quot;</span><span class=p>,</span> <span class=nx>age</span><span class=o>:</span> <span class=mi>37</span><span class=p>},</span>
        <span class=p>{</span><span class=nx>name</span><span class=o>:</span> <span class=s2>&quot;P. Mickelson&quot;</span><span class=p>,</span> <span class=nx>age</span><span class=o>:</span> <span class=mi>43</span><span class=p>}</span>
    <span class=p>],</span>

    <span class=nx>clickHandler</span><span class=o>:</span><span class=kd>function</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
        <span class=c1>// Để lưu trữ giá trị của &quot;this&quot; (đang tham chiếu đối tương</span>
        <span class=c1>// user), chúng ta gán nó cho một biến khác để sử dụng về sau.</span>
        <span class=kd>var</span> <span class=nx>theUserObj</span> <span class=o>=</span> <span class=k>this</span><span class=p>;</span>
        <span class=k>this</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>forEach</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>person</span><span class=p>)</span> <span class=p>{</span>
            <span class=c1>// Bây giờ chúng ta có thể sử dụng theUserObj.tournament</span>
            <span class=c1>// thay vì this.tournament</span>
            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>person</span><span class=p>.</span><span class=nx>name</span> <span class=o>+</span> <span class=s2>&quot; is playing at &quot;</span> <span class=o>+</span> <span class=nx>theUserObj</span><span class=p>.</span><span class=nx>tournament</span><span class=p>);</span>
        <span class=p>})</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=nx>user</span><span class=p>.</span><span class=nx>clickHandler</span><span class=p>();</span>
<span class=c1>// T. Woods is playing at The Masters</span>
<span class=c1>// P. Mickelson is playing at The Masters</span>
</pre></div> <p>Rất nhiều người thường gán giá trị <code>this</code> cho biến khác có tên là <code>that</code>, có lẽ bởi vì ý nghĩa của chúng gần giống nhau, như ví dụ sau đây. Tuy nhiên, để code dễ đọc và dễ hiểu hơn, chúng ta nên gán <code>this</code> với một biến có tên dễ hiểu để chỉ đối tượng mà nó đang tham chiếu.</p> <div class=codehilite><pre><span></span><span class=kd>var</span> <span class=nx>that</span> <span class=o>=</span> <span class=k>this</span><span class=p>;</span>
</pre></div> <h2 id=su-dung-this-khi-phuong-thuc-uoc-gan-cho-bien>Sử dụng <code>this</code> khi phương thức được gán cho biến<a class=headerlink href=#su-dung-this-khi-phuong-thuc-uoc-gan-cho-bien title="Permanent link">&para;</a></h2> <p>Giá trị của <code>this</code> sẽ vượt xa sự tưởng tượng của chúng ta và được gán giá trị khác, nếu chúng ta gán phương thức sử dụng <code>this</code> cho một biến. Hãy xem ví dụ sau đây:</p> <div class=codehilite><pre><span></span><span class=c1>// Biến data là biến toàn cục</span>
<span class=kd>var</span> <span class=nx>data</span> <span class=o>=</span> <span class=p>[</span>
    <span class=p>{</span><span class=nx>name</span><span class=o>:</span> <span class=s2>&quot;Samantha&quot;</span><span class=p>,</span> <span class=nx>age</span><span class=o>:</span> <span class=mi>12</span><span class=p>},</span>
    <span class=p>{</span><span class=nx>name</span><span class=o>:</span> <span class=s2>&quot;Alexis&quot;</span><span class=p>,</span> <span class=nx>age</span><span class=o>:</span> <span class=mi>14</span><span class=p>}</span>
<span class=p>];</span>

<span class=kd>var</span> <span class=nx>user</span> <span class=o>=</span> <span class=p>{</span>
    <span class=c1>// data ở đây là một thuộc tính của đối tượng user</span>
    <span class=nx>data</span><span class=o>:</span> <span class=p>[</span>
        <span class=p>{</span><span class=nx>name</span><span class=o>:</span> <span class=s2>&quot;T. Woods&quot;</span><span class=p>,</span> <span class=nx>age</span><span class=o>:</span> <span class=mi>37</span><span class=p>},</span>
        <span class=p>{</span><span class=nx>name</span><span class=o>:</span> <span class=s2>&quot;P. Mickelson&quot;</span><span class=p>,</span> <span class=nx>age</span><span class=o>:</span> <span class=mi>43</span><span class=p>}</span>
    <span class=p>],</span>

    <span class=nx>showData</span><span class=o>:</span> <span class=kd>function</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
        <span class=c1>// chọn ngẫu nhiên 0 hoặc 1</span>
        <span class=kd>var</span> <span class=nx>randomNum</span> <span class=o>=</span> <span class=p>((</span><span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>|</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span>

        <span class=c1>// In ra một người chọn ngẫu nhiên từ user.data</span>
        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>data</span><span class=p>[</span><span class=nx>randomNum</span><span class=p>].</span><span class=nx>name</span> <span class=o>+</span> <span class=s2>&quot; &quot;</span> <span class=o>+</span> <span class=k>this</span><span class=p>.</span><span class=nx>data</span><span class=p>[</span><span class=nx>randomNum</span><span class=p>].</span><span class=nx>age</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=c1>// gán phương thức cho một biến</span>
<span class=kd>var</span> <span class=nx>showUserData</span> <span class=o>=</span> <span class=nx>user</span><span class=p>.</span><span class=nx>showData</span><span class=p>;</span>

<span class=c1>// Khi chúng ta thực thi hàm showUserData, giá trị được in ra lại được</span>
<span class=c1>// lấy ra từ biến data toàn cục, chứ không phải từ thuộc tính data của</span>
<span class=c1>// đối tượng user.</span>
<span class=nx>showUserData</span><span class=p>();</span> <span class=c1>// Samantha 12 (dữ liệu lấy từ biến data toàn cục)</span>
</pre></div> <p><strong>Giải pháp</strong></p> <p>Chúng ta có thể giải quyết vấn đề trên bằng cánh chỉ định giá trị của <code>this</code> bằng phương thức <code>bind</code>:</p> <div class=codehilite><pre><span></span><span class=c1>// Bind showData cho đối tượng user</span>
<span class=kd>var</span> <span class=nx>showUserData</span> <span class=o>=</span> <span class=nx>user</span><span class=p>.</span><span class=nx>showData</span><span class=p>.</span><span class=nx>bind</span><span class=p>(</span><span class=nx>user</span><span class=p>);</span>

<span class=c1>// Bây giờ chúng ta sẽ lấy giá trị từ đối tượng user, vì &quot;this&quot; đã</span>
<span class=c1>// được gán cho đối tượng này:</span>
<span class=nx>showUserData</span><span class=p>();</span> <span class=c1>// P. Mickelson 43</span>
</pre></div> <h2 id=dung-this-khi-muon-phuong-thuc>Dùng <code>this</code> khi mượn phương thức<a class=headerlink href=#dung-this-khi-muon-phuong-thuc title="Permanent link">&para;</a></h2> <p>Việc mượn các phương thức là việc rất phổ biến trong viết code JavaScript. Và nếu bạn làm việc với JavaScript, thì chắc chắn bạn đã mượn các phương thức rất nhiều lần. Việc mượn các phương thức sẽ giúp chúng ta tiết kiệm thời gian phát triển những tính năng đã có người làm giúp chúng ta rồi. Tuy nhiên, tự tiện lợi đó đi kèm với một số vấn đề khi sử dụng <code>this</code>.</p> <div class=codehilite><pre><span></span><span class=c1>// Chúng ta có 2 đối tượng.  Một đối tượng có phương thức avg() và đối</span>
<span class=c1>// tượng còn lại không có.  Vì thế chúng ta sẽ mượn phương thức avg().</span>
<span class=kd>var</span> <span class=nx>gameController</span> <span class=o>=</span> <span class=p>{</span>
    <span class=nx>scores</span><span class=o>:</span> <span class=p>[</span><span class=mi>20</span><span class=p>,</span> <span class=mi>34</span><span class=p>,</span> <span class=mi>55</span><span class=p>,</span> <span class=mi>46</span><span class=p>,</span> <span class=mi>77</span><span class=p>],</span>
    <span class=nx>avgScore</span><span class=o>:</span> <span class=kc>null</span><span class=p>,</span>
    <span class=nx>players</span><span class=o>:</span> <span class=p>[</span>
        <span class=p>{</span><span class=nx>name</span><span class=o>:</span> <span class=s2>&quot;Tommy&quot;</span><span class=p>,</span> <span class=nx>playerID</span><span class=o>:</span> <span class=mi>987</span><span class=p>,</span> <span class=nx>age</span><span class=o>:</span> <span class=mi>23</span><span class=p>},</span>
        <span class=p>{</span><span class=nx>name</span><span class=o>:</span> <span class=s2>&quot;Pau&quot;</span><span class=p>,</span> <span class=nx>playerID</span><span class=o>:</span> <span class=mi>87</span><span class=p>,</span> <span class=nx>age</span><span class=o>:</span> <span class=mi>33</span><span class=p>}</span>
    <span class=p>]</span>
<span class=p>}</span>

<span class=kd>var</span> <span class=nx>appController</span> <span class=o>=</span> <span class=p>{</span>
    <span class=nx>scores</span><span class=o>:</span> <span class=p>[</span><span class=mi>900</span><span class=p>,</span> <span class=mi>845</span><span class=p>,</span> <span class=mi>809</span><span class=p>,</span> <span class=mi>950</span><span class=p>],</span>
    <span class=nx>avgScore</span><span class=o>:</span> <span class=kc>null</span><span class=p>,</span>
    <span class=nx>avg</span><span class=o>:</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
        <span class=kd>var</span> <span class=nx>sumOfScores</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>scores</span><span class=p>.</span><span class=nx>reduce</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>prev</span><span class=p>,</span> <span class=nx>cur</span><span class=p>,</span> <span class=nx>index</span><span class=p>,</span> <span class=nx>array</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>return</span> <span class=nx>prev</span> <span class=o>+</span> <span class=nx>cur</span><span class=p>;</span>
        <span class=p>});</span>

        <span class=k>this</span><span class=p>.</span><span class=nx>avgScore</span> <span class=o>=</span> <span class=nx>sumOfScores</span> <span class=o>/</span> <span class=k>this</span><span class=p>.</span><span class=nx>scores</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=c1>// Nếu chúng ta chạy code dưới đây, thuộc tính gameController.avgScore</span>
<span class=c1>// sẽ được gán giá trị trung bình của đối tượng appController</span>
<span class=nx>gameController</span><span class=p>.</span><span class=nx>avgScore</span> <span class=o>=</span> <span class=nx>appController</span><span class=p>.</span><span class=nx>avg</span><span class=p>();</span>
</pre></div> <p><code>this</code> trong phương thức <code>avg</code> không tham chiếu đến đối tượng <code>gameController</code> mà nó tham chiếu đến đối tượng <code>appController</code> bởi vì nó được gọi bởi <code>appController</code>.</p> <p><strong>Giải pháp</strong></p> <p>Để giải quyết vấn đề trên, và biến giá trị <code>this</code> trong <code>appController.avg()</code> tham chiếu đến <code>gameController</code>, chúng ta có thể sử dụng phương thức <code>apply</code>:</p> <div class=codehilite><pre><span></span><span class=c1>// Lưu ý, chúng ta sử dụng phương thức apply(), nên tham số thứ 2 phải</span>
<span class=c1>// là một array - tham số sẽ được truyền cho phương thức</span>
<span class=c1>// appController.avg().</span>
<span class=nx>appController</span><span class=p>.</span><span class=nx>avg</span><span class=p>.</span><span class=nx>apply</span><span class=p>(</span><span class=nx>gameController</span><span class=p>,</span> <span class=nx>gameController</span><span class=p>.</span><span class=nx>scores</span><span class=p>);</span>

<span class=c1>// avgScore được tính cho đối tượng gameController, ngay cả khi chúng</span>
<span class=c1>// ta mượn phương thức avg() từ đối tượng appController.</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>gameController</span><span class=p>.</span><span class=nx>avgScore</span><span class=p>);</span> <span class=c1>// 46.4</span>

<span class=c1>// appController.avgScore vẫn null, chỉ có gameController.avgScore</span>
<span class=c1>// được tính toàn mà thôi.</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>appController</span><span class=p>.</span><span class=nx>avgScore</span><span class=p>);</span> <span class=c1>// null</span>
</pre></div> <p>Đối tượng <code>gameController</code> mượn phương thức <code>avg()</code> từ đối tượng <code>appController</code>. Giá trị của <code>this</code> trong phương thức này sẽ được gán cho đối tượng <code>gameController</code> bởi vì chúng ta truyền đối tượng này là tham số đầu tiên của <code>apply</code>. Tham số đầu tiên của <code>apply</code> luôn được sử dụng là <code>this</code>.</p> <h1 id=ket-luan>Kết luận<a class=headerlink href=#ket-luan title="Permanent link">&para;</a></h1> <p>Bài viết trình bày những hiểu biết về từ khóa <code>this</code> của JavaScript. Và tôi cũng trình thêm một số công cụ (<code>bind</code>, <code>apply</code>, v.v...) để gán giá trị cho <code>this</code> trong những tình huống đặc biệt.</p> <p>Như các bạn đã thấy, <code>this</code> có thể trở nên phức tạp trong một số tình huống mà ngữ cảnh ban đầu bị thay đổi. Tuy nhiên, có một điều không bao giờ thay đổi, đó là <code>this</code> được gán giá trị của đối tượng gọi hàm this.</p> <p>Hy vọng bài viết giúp ích các bạn trong quá trình code JavaScript của mình.</p> </div> <div class=post-footer> <div class=tags> <i class="fa fa-tags"></i> <span>#JavaScript</span> <span>#fundamental</span> <span>#this</span> <span>#keyword</span> </div> </div> </div><div class=blog-pager> <span class=newer-link> <a href=/2016/Apr/10/using-docker-and-docker-compose-for-django-development.html> Newer Post </a> </span> <span class=older-link> <a href=/2016/Mar/18/something-about-coding-style.html> Older Post </a> </span> </div><div class=comments> <div class=finally> <p><em>I apologise for any typos. If you notice a problem, please let me know.</em> <p>Thank you all for your attention. </div> <div id=disqus_thread></div> <script src=/theme/js/disqus.min.js?81e8a5f5></script> <noscript> Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript> comments powered by Disqus. </a> </noscript> </div></div> </div> </div> <div class=sidebar-wrapper> <div class=widget> <h2>Welcome</h2> <div> <img src=/theme/images/banner.gif alt=Welcome> </div> </div><div class="widget recent-posts"> <h2>Recent Posts</h2> <ul> <li> <a href=/2019/May/20/elasticsearch-data-organization.html> <img alt="Elasticsearch: Data organization" src=https://i.imgur.com/JT4y7Qf.jpg> </a> <a href=/2019/May/20/elasticsearch-data-organization.html>Elasticsearch: Data organization</a> <li> <a href=/2019/May/20/elasticsearch-intro.html> <img alt="Elasticsearch: Intro" src=https://i.imgur.com/JT4y7Qf.jpg> </a> <a href=/2019/May/20/elasticsearch-intro.html>Elasticsearch: Intro</a> <li> <a href=/2019/Apr/20/javascript-popups.html> <img alt="JavaScript: Popups" src=https://i.imgur.com/FxmcwPy.png> </a> <a href=/2019/Apr/20/javascript-popups.html>JavaScript: Popups</a> <li> <a href=/2019/Mar/20/javascript-iterator-and-generator.html> <img alt="JavaScript: Iterator and generator" src=https://i.imgur.com/lev8iT9.jpg> </a> <a href=/2019/Mar/20/javascript-iterator-and-generator.html>JavaScript: Iterator and generator</a> <li> <a href=/2019/Feb/20/javascript-decorator.html> <img alt="JavaScript decorator" src=https://i.imgur.com/Sh3yLI0.png> </a> <a href=/2019/Feb/20/javascript-decorator.html>JavaScript decorator</a> </ul> </div><div class="widget labels"> <h2>Blog Archive</h2> <ul> <li> <a href=/2019/ > 2019 </a> <li> <a href=/2018/ > 2018 </a> <li> <a href=/2017/ > 2017 </a> <li> <a href=/2016/ > 2016 </a> <li> <a href=/2015/ > 2015 </a> <li> <a href=/2014/ > 2014 </a> <li> <a href=/2013/ > 2013 </a> <li> <a href=/2012/ > 2012 </a> <li> <a href=/2011/ > 2011 </a> <li> <a href=/2010/ > 2010 </a> </ul> </div><div class=widget> <h2>Twitter timeline</h2> <a class=twitter-timeline data-height=500 data-dnt=true data-theme=light href=https://twitter.com/_naa_4f data-chrome="noheader nofooter transparent noborders"> Tweets by manhhomienbienthuy </a> </div> </div> </div> <a href=# class="smooth-scroll back-to-top"> <i class="fa fa-arrow-circle-up fa-3x"></i> </a> </main> <footer> <div class=infos> <div class=wrapper> <div class=widget> <a href=/ title="manhhomienbienthuy's space" class=logo> <img alt="manhhomienbienthuy's space" src=/theme/images/logo_white.png> </a> <span class=right>I'm a hacker, enter my world...</span> </div><div class=widget> <p> Created with all my ♥ and soul, dedicated to my love, yunachan <p> Powered by <a href=http://blog.getpelican.com/ target=_blank>Pelican</a>, which takes great advantage of <a href=https://www.python.org/ target=_blank>Python</a> <p> This site content is licensed under a <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank> CC BY-NC-ND 4.0 </a> License. <p> Updated at <a target=_blank href="http://www.timeanddate.com/worldclock/fixedtime.html?iso=2019-06-20T02:42:55"> 2019-06-20 02:42:55 </a> </div><div class=widget> <p> Hosting by <a href=https://manhhomienbienthuy.bitbucket.io/ >Bitbucket</a> and <a href=https://manhhomienbienthuy.github.io/ >Github</a>, image hosting by <a href=https://manhhomienbienthuy.imgur.com/ target=_blank>imgur</a>, <a href=https://instagram.com/manhhomienbienthuy/ target=_blank>Instagram</a> and <a href=https://photos.google.com/ target=_blank>Google Photo</a> <p> Theme based on <a href=https://vanice-veethemes.blogspot.com/ target=_blank>Vanice theme</a>, icons from <a href=https://fontawesome.com/ target=_blank>Font Awesome</a>, comments powered by <a href=https://disqus.com/home/forums/manhhomienbienthuy/ target=_blank>Disqus</a> </div> </div> </div> <div class=credits> <div class=wrapper> <div class=left> <!--
          Regarding copyright, in general, standalone pages (as
          opposed to files generated as part of manuals) on the GNU
          web server should be under CC BY-ND 4.0.  Please do NOT
          change or remove this without talking with the webmasters or
          licensing team first.  Please make sure the copyright date
          is consistent with the document.  For web pages, it is ok to
          list just the latest year the document was modified, or
          published.

          If you wish to list earlier years, that is ok too.  Either
          "2001, 2002, 2003" or "2001-2003" are ok for specifying
          years, as long as each year in the range is in fact a
          copyrightable year, i.e., a year in which the document was
          published (including being publicly visible on the web or in
          a revision control system).
        --> Copyright © 2010-2019 <a href=/pages/about-me.html><strong>manhhomienbienthuy</strong></a>. All rights reserved. </div> <div class=right> <ul> <li><a href=/ >Home</a> <li><a href=/pages/about-me.html>About</a> <li><a href=# class=smooth-scroll>Top ↑</a> </ul> </div> </div> </div></footer> <script src=https://code.jquery.com/jquery-3.2.1.js></script> <script src=//cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js></script> <script src=//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.2/imagesloaded.pkgd.min.js></script> <script src=/theme/js/vpyeu.min.js?d72c87bd></script> <script id=dsq-count-scr src=https://manhhomienbienthuy.disqus.com/count.js async></script>