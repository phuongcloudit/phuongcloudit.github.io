<!DOCTYPE html><title>Python class decorator - manhhomienbienthuy's space</title> <meta charset=utf-8> <meta name=viewport content="width=device-width, initial-scale=1"> <link rel=apple-touch-icon href=/theme/images/icon-touch.png> <link rel=icon sizes=192x192 href=/theme/images/icon-touch.png> <link rel="shortcut icon" href=/theme/images/favicon.ico> <link rel=author href=/humans.txt> <meta name=msapplication-TileImage content=/theme/images/icon-tile.png> <meta name=twitter:dnt content=on> <meta name=Author content=manhhomienbienthuy> <meta name=rating content=general> <meta name=twitter:card content=product> <meta name=twitter:site content=@_naa_4f> <meta name=twitter:creator content=@_naa_4f> <link href=/feeds/all.atom.xml type=application/atom+xml rel=alternate title="manhhomienbienthuy's space Full Atom Feed"> <meta name=description content="Trong bài viết trước, chúng ta đã tìm hiểu về metaclass trong Python. Và đi đến kết luận rằng, metaclass là một khái niệm rất phức tạp của Python và chúng ta không nên lạm dụng nó. Nếu muốn thay đổi hoạt động của một class, chúng ta có thể …"> <meta name=keywords content="Python, class, decorator, fundamental, programming, blog, naa, manhhomienbienthuy, pelican, static site generator"> <meta name=twitter:title content="Python class decorator - manhhomienbienthuy's space"> <meta name=twitter:description content="Trong bài viết trước, chúng ta đã tìm hiểu về metaclass trong Python. Và đi đến kết luận rằng, metaclass là một khái niệm rất phức tạp của Python và chúng ta không nên lạm dụng nó. Nếu muốn thay đổi hoạt động của một class, chúng ta có thể …"> <meta name=twitter:image content=/https://i.imgur.com/TMu6Ygl.png> <link rel=stylesheet href=//cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css> <link rel=stylesheet href=//maxcdn.bootstrapcdn.com/font-awesome/4.0.0/css/font-awesome.min.css> <link rel=stylesheet href=/theme/css/vpyeu.min.css?5d2c7d5e> <header> <div class=navbar> <div class=wrapper> <div class=nav-menu> <div class=menu-toggle> <i class="fa fa-reorder"></i> </div> <ul class=menus> <li><a href=/ >Home</a> <li><a href=/category/general.html> General <li><a href=/category/life.html> Life <li><a href=/category/programming.html class=current> Programming <li><a href=/category/travel.html> Travel </ul> </div><div class="right links"> <ul> <li> <a href=https://twitter.com/_naa_4f target=_blank> <i class="fa fa-twitter"></i> </a> <li> <a href=https://instagram.com/manhhomienbienthuy/ target=_blank> <i class="fa fa-instagram"></i> </a> <li> <a href=https://www.facebook.com/manhhomienbienthuy target=_blank> <i class="fa fa-facebook"></i> </a> <li> <a href=https://github.com/manhhomienbienthuy target=_blank> <i class="fa fa-github"></i> </a> <li> <a href=/feeds/all.atom.xml target=_blank> <i class="fa fa-rss"></i> </a> </ul> </div> </div> </div><noscript> <div class="warning head-warn"> <div class=wrapper> <p><strong>Notice:</strong> While JavaScript is not essential for this website, your interaction with the content will be limited. Please turn JavaScript on for the full experience. </div> </div> </noscript><div class=banner> <div class=wrapper> <a href=/ > <img alt="manhhomienbienthuy's space" src=/theme/images/logo.png> </a> </div> </div></header> <main> <div class=wrapper> <div class=main-wrapper> <div class=entry> <div class=entry-detail> <div class=post> <h1 class=title> Python class decorator </h1> <div class=meta> Posted in <a href=/category/programming.html>Programming</a> on March 08, 2016 by <a href=/pages/about-me.html>manhhomienbienthuy</a> <span class=right> <i class="fa fa-comments"></i> <a href=#disqus_thread data-disqus-identifier=/2016/Mar/08/python-class-decorator.html> Comments </a> </span> </div> <div class=post-body> <img src=https://i.imgur.com/TMu6Ygl.png alt="Python class decorator"> <p>Trong <a href=../../../2016/Feb/23/python-metaclass.html>bài viết trước</a>, chúng ta đã tìm hiểu về metaclass trong Python. Và đi đến kết luận rằng, metaclass là một khái niệm rất phức tạp của Python và chúng ta không nên lạm dụng nó. Nếu muốn thay đổi hoạt động của một class, chúng ta có thể sử dụng class decorator. Bài viết này sẽ giới thiệu cách viết và sử dụng class decorator trong Python.</p> <h1 id=nhac-lai-kien-thuc>Nhắc lại kiến thức<a class=headerlink href=#nhac-lai-kien-thuc title="Permanent link">&para;</a></h1> <p>Cơ sở lý thuyết của class decorator cũng tương tự như function decorator, chúng đã được trình bày rất đầy đủ ở <a href=../../../2015/Dec/22/exploring-python-decorators.html>bài viết về function decorator</a>. Trong bài viết này, chúng ta chỉ điểm qua một vài ý cơ bản.</p> <h2 id=decorator-cho-ham>Decorator cho hàm<a class=headerlink href=#decorator-cho-ham title="Permanent link">&para;</a></h2> <p>Chúng biết được rằng, hàm của Python cũng là đối tượng, nên chúng ta có thể viết một hàm, nhận đầu vào là một hàm khác, thay đổi hoạt động của hàm đó, và sau đó lại trả về (<code>return</code>) một hàm. Đó chính là cơ sở lý thuyết để chúng ta xây dựng decorator cho các hàm.</p> <div class=codehilite><pre><span></span><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span> <span class=nf>decorator_function</span><span class=p>(</span><span class=n>function_to_decorate</span><span class=p>):</span>
<span class=gp>... </span>    <span class=k>def</span> <span class=nf>wrapper</span><span class=p>():</span>
<span class=gp>... </span>        <span class=k>print</span><span class=p>(</span><span class=s2>&quot;Before calling function&quot;</span><span class=p>)</span>
<span class=gp>... </span>        <span class=n>function_to_decorate</span><span class=p>()</span>
<span class=gp>... </span>        <span class=k>print</span><span class=p>(</span><span class=s2>&quot;After calling function&quot;</span><span class=p>)</span>
<span class=gp>... </span>    <span class=k>return</span> <span class=n>wrapper</span>
<span class=gp>...</span>
<span class=gp>&gt;&gt;&gt; </span><span class=nd>@decorator_function</span>
<span class=gp>... </span> <span class=k>def</span> <span class=nf>a_function</span><span class=p>():</span>
<span class=gp>... </span>    <span class=k>print</span><span class=p>(</span><span class=s2>&quot;Do not modify it&quot;</span><span class=p>)</span>
<span class=gp>...</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>a_function</span><span class=p>()</span>
<span class=go>Before calling function</span>
<span class=go>Do not modify it</span>
<span class=go>After calling function</span>
</pre></div> <h2 id=class-cung-la-oi-tuong>Class cũng là đối tượng<a class=headerlink href=#class-cung-la-oi-tuong title="Permanent link">&para;</a></h2> <p>Trong <a href=../../../2016/Feb/23/python-metaclass.html>bài viết về metaclass</a>, chúng ta đã biết rằng, class trong Python cũng là đối tượng. Vì cũng là đối tượng nên chúng ta có thể thao tác với chúng như những đối tượng thông thường khác: gán biến, thêm thuộc tính và truyền vào các hàm làm tham số.</p> <div class=codehilite><pre><span></span><span class=gp>&gt;&gt;&gt; </span><span class=k>class</span> <span class=nc>Foo</span><span class=p>:</span>
<span class=gp>... </span>    <span class=k>pass</span>
<span class=gp>...</span>
<span class=gp>&gt;&gt;&gt; </span><span class=k>print</span><span class=p>(</span><span class=n>Foo</span><span class=p>)</span>
<span class=go>&lt;class &#39;__main__.Foo&#39;&gt;</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>Bar</span> <span class=o>=</span> <span class=n>Foo</span>
<span class=gp>&gt;&gt;&gt; </span><span class=k>print</span><span class=p>(</span><span class=n>Bar</span><span class=p>)</span>
<span class=go>&lt;class &#39;__main__.Foo&#39;&gt;</span>
<span class=gp>&gt;&gt;&gt; </span><span class=k>print</span><span class=p>(</span><span class=n>Foo</span><span class=p>())</span>
<span class=go>&lt;__main__.Foo object at 0x7f85d0aa6b00&gt;</span>
<span class=gp>&gt;&gt;&gt; </span><span class=k>print</span><span class=p>(</span><span class=n>Bar</span><span class=p>())</span>
<span class=go>&lt;__main__.Foo object at 0x7f85d0aa6b38&gt;</span>
</pre></div> <h1 id=decorator-cho-class>Decorator cho class<a class=headerlink href=#decorator-cho-class title="Permanent link">&para;</a></h1> <p>Với cơ sở lý thuyết như trên, chúng ta cũng có thể xây dựng các hàm, nhận đầu vào là một class, và thay đổi hành vi của class đó. Tuy nhiên, một class với các thuộc tính phức tạp hơn nên hàm này có thể trả về một class mới, hoặc một hàm mới, hoặc có thể trả về ngay class cũ.</p> <p>Ví dụ, chúng ta muốn thêm một thuộc tính cho class, mà không muốn thay đổi code của class đó. Chúng ta có thể dùng một hàm như sau:</p> <div class=codehilite><pre><span></span><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span> <span class=nf>decorator_class</span><span class=p>(</span><span class=n>class_to_decorate</span><span class=p>):</span>
<span class=gp>... </span>    <span class=n>class_to_decorate</span><span class=o>.</span><span class=n>decorator_attribute</span> <span class=o>=</span> <span class=s2>&quot;Decorator attribute&quot;</span>
<span class=gp>... </span>    <span class=k>return</span> <span class=n>class_to_decorate</span>
<span class=gp>...</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>Foo</span><span class=o>.</span><span class=n>decorator_attribute</span> <span class=c1># Lúc này thuộc tính này chưa tồn tại</span>
<span class=gt>Traceback (most recent call last):</span>
  File <span class=nb>&quot;&lt;stdin&gt;&quot;</span>, line <span class=m>1</span>, in <span class=n>&lt;module&gt;</span>
<span class=gr>AttributeError</span>: <span class=n>type object &#39;Foo&#39; has no attribute &#39;decorator_attribute&#39;</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>Foo</span> <span class=o>=</span> <span class=n>decorator_class</span><span class=p>(</span><span class=n>Foo</span><span class=p>)</span> <span class=c1># Sau khi chạy hàm này, thuộc tính đã được thêm vào</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>Foo</span><span class=o>.</span><span class=n>decorator_attribute</span>
<span class=go>&#39;Decorator attribute&#39;</span>
</pre></div> <h2 id=cu-phap-class-decorator>Cú pháp class decorator<a class=headerlink href=#cu-phap-class-decorator title="Permanent link">&para;</a></h2> <p>Từ phiên bản Python 2.6, Python cho phép chúng ta sử dụng pie syntax (<code>@</code>) với <a href=https://www.python.org/dev/peps/pep-3129/ >class decorator</a>, tương tự như decorator cho hàm.</p> <p>Ví dụ ở trên có thể viết ngắn gọn lại như sau:</p> <div class=codehilite><pre><span></span><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span> <span class=nf>decorator_class</span><span class=p>(</span><span class=n>class_to_decorate</span><span class=p>):</span>
<span class=gp>... </span>    <span class=n>class_to_decorate</span><span class=o>.</span><span class=n>decorator_attribute</span> <span class=o>=</span> <span class=s2>&quot;Decorator attribute&quot;</span>
<span class=gp>... </span>    <span class=k>return</span> <span class=n>class_to_decorate</span>
<span class=gp>...</span>
<span class=gp>&gt;&gt;&gt; </span><span class=nd>@decorator_class</span>
<span class=gp>... </span> <span class=k>class</span> <span class=nc>Foo</span><span class=p>:</span>
<span class=gp>... </span>    <span class=k>pass</span>
<span class=gp>...</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>Foo</span>
<span class=go>&lt;class &#39;__main__.Foo&#39;&gt;</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>Foo</span><span class=o>.</span><span class=n>decorator_attribute</span>
<span class=go>&#39;Decorator attribute&#39;</span>
</pre></div> <p>Một ví dụ khác, có thể chúng ta sẽ cần sử dụng nhiều, đó là cài đặt <a href=https://en.wikipedia.org/wiki/Singleton_pattern>singleton pattern</a>.</p> <div class=codehilite><pre><span></span><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span> <span class=nf>singleton</span><span class=p>(</span><span class=bp>cls</span><span class=p>):</span>
<span class=gp>... </span>    <span class=n>instance</span> <span class=o>=</span> <span class=bp>None</span>
<span class=gp>... </span>    <span class=k>def</span> <span class=nf>get_instance</span><span class=p>():</span>
<span class=gp>... </span>        <span class=n>nonlocal</span> <span class=n>instance</span>
<span class=gp>... </span>        <span class=k>if</span> <span class=ow>not</span> <span class=n>instance</span><span class=p>:</span>
<span class=gp>... </span>            <span class=n>instance</span> <span class=o>=</span> <span class=bp>cls</span><span class=p>()</span>
<span class=gp>... </span>        <span class=k>return</span> <span class=n>instance</span>
<span class=gp>... </span>    <span class=k>return</span> <span class=n>get_instance</span>
<span class=gp>...</span>
<span class=gp>&gt;&gt;&gt; </span><span class=nd>@singleton</span>
<span class=gp>... </span> <span class=k>class</span> <span class=nc>Foo</span><span class=p>:</span>
<span class=gp>... </span>    <span class=k>pass</span>
<span class=gp>...</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>Foo</span><span class=p>()</span>
<span class=gp>&gt;&gt;&gt; </span><span class=nb>id</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
<span class=go>140212673042024</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>y</span> <span class=o>=</span> <span class=n>Foo</span><span class=p>()</span>
<span class=gp>&gt;&gt;&gt; </span><span class=nb>id</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
<span class=go>140212673042024</span>
<span class=gp>&gt;&gt;&gt; </span><span class=nb>id</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>==</span> <span class=nb>id</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
<span class=go>True</span>
<span class=gp>&gt;&gt;&gt; </span><span class=nd>@singleton</span>
<span class=gp>... </span> <span class=k>class</span> <span class=nc>Bar</span><span class=p>:</span>
<span class=gp>... </span>    <span class=k>pass</span>
<span class=gp>...</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>a</span> <span class=o>=</span> <span class=n>Bar</span><span class=p>()</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>b</span> <span class=o>=</span> <span class=n>Bar</span><span class=p>()</span>
<span class=gp>&gt;&gt;&gt; </span><span class=nb>id</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
<span class=go>140212708208144</span>
<span class=gp>&gt;&gt;&gt; </span><span class=nb>id</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
<span class=go>140212708208144</span>
<span class=gp>&gt;&gt;&gt; </span><span class=nb>id</span><span class=p>(</span><span class=n>a</span><span class=p>)</span> <span class=o>==</span> <span class=nb>id</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
<span class=go>True</span>
<span class=gp>&gt;&gt;&gt; </span><span class=nb>id</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>==</span> <span class=nb>id</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
<span class=go>False</span>
</pre></div> <p>Trong ví dụ trên, chúng ta đã khởi tạo các giá trị của class <code>Foo</code> và <code>Bar</code> hai lần, nhưng chúng chỉ tạo ra một instance cho mỗi class mà thôi.</p> <p>Tính năng tương tự cũng có thể thực hiện được với metaclass, bằng cách override phương thức <code>__call__</code> của metaclass, chúng ta có thể thay đổi quá trình tạo ra các instance.</p> <div class=codehilite><pre><span></span><span class=gp>&gt;&gt;&gt; </span><span class=k>class</span> <span class=nc>Singleton</span><span class=p>(</span><span class=nb>type</span><span class=p>):</span>
<span class=gp>... </span>    <span class=n>_instances</span> <span class=o>=</span> <span class=p>{}</span>
<span class=gp>... </span>    <span class=k>def</span> <span class=fm>__call__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
<span class=gp>... </span>        <span class=k>if</span> <span class=bp>cls</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_instances</span><span class=p>:</span>
<span class=gp>... </span>            <span class=bp>cls</span><span class=o>.</span><span class=n>_instances</span><span class=p>[</span><span class=bp>cls</span><span class=p>]</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__call__</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
<span class=gp>... </span>        <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_instances</span><span class=p>[</span><span class=bp>cls</span><span class=p>]</span>
<span class=gp>...</span>
<span class=gp>&gt;&gt;&gt; </span><span class=k>class</span> <span class=nc>Foo</span><span class=p>(</span><span class=n>metaclass</span><span class=o>=</span><span class=n>Singleton</span><span class=p>):</span>
<span class=gp>... </span>    <span class=k>pass</span>
<span class=gp>...</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>x</span> <span class=o>=</span> <span class=n>Foo</span><span class=p>()</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>y</span> <span class=o>=</span> <span class=n>Foo</span><span class=p>()</span>
<span class=gp>&gt;&gt;&gt; </span><span class=nb>id</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
<span class=go>140173760907024</span>
<span class=gp>&gt;&gt;&gt; </span><span class=nb>id</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
<span class=go>140173760907024</span>
<span class=gp>&gt;&gt;&gt; </span><span class=nb>id</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>==</span> <span class=nb>id</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
<span class=go>True</span>
</pre></div> <p>Thêm một ví dụ nữa về class decorator có phần khó hơn. Đó là chúng ta sẽ thay đổi một số phương thức của class. Thay vì decorator cho từng class một, chúng ta có thể decorate cả class.</p> <div class=codehilite><pre><span></span><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span> <span class=nf>method_decorator</span><span class=p>(</span><span class=n>method</span><span class=p>):</span>
<span class=gp>... </span>    <span class=k>def</span> <span class=nf>wrapper</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
<span class=gp>... </span>        <span class=k>print</span><span class=p>(</span><span class=s2>&quot;Inside the decorator&quot;</span><span class=p>)</span>
<span class=gp>... </span>        <span class=k>return</span> <span class=n>method</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
<span class=gp>... </span>    <span class=k>return</span> <span class=n>wrapper</span>
<span class=gp>...</span>
<span class=gp>&gt;&gt;&gt; </span><span class=k>def</span> <span class=nf>class_decorator</span><span class=p>(</span><span class=o>*</span><span class=n>method_names</span><span class=p>):</span>
<span class=gp>... </span>    <span class=k>def</span> <span class=nf>class_rebuilder</span><span class=p>(</span><span class=bp>cls</span><span class=p>):</span>
<span class=gp>... </span>        <span class=k>class</span> <span class=nc>NewClass</span><span class=p>(</span><span class=bp>cls</span><span class=p>):</span>
<span class=gp>... </span>            <span class=k>def</span> <span class=fm>__getattribute__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>attr_name</span><span class=p>):</span>
<span class=gp>... </span>                <span class=n>obj</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__getattribute__</span><span class=p>(</span><span class=n>attr_name</span><span class=p>)</span>
<span class=gp>... </span>                <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>obj</span><span class=p>,</span> <span class=s1>&#39;__call__&#39;</span><span class=p>)</span> <span class=ow>and</span> <span class=n>attr_name</span> <span class=ow>in</span> <span class=n>method_names</span><span class=p>:</span>
<span class=gp>... </span>                    <span class=k>return</span> <span class=n>method_decorator</span><span class=p>(</span><span class=n>obj</span><span class=p>)</span>
<span class=gp>... </span>                <span class=k>return</span> <span class=n>obj</span>
<span class=gp>... </span>        <span class=k>return</span> <span class=n>NewClass</span>
<span class=gp>... </span>    <span class=k>return</span> <span class=n>class_rebuilder</span>
<span class=gp>...</span>
<span class=gp>&gt;&gt;&gt; </span><span class=nd>@class_decorator</span><span class=p>(</span><span class=s1>&#39;first_method&#39;</span><span class=p>,</span> <span class=s1>&#39;second_method&#39;</span><span class=p>)</span>
<span class=gp>... </span> <span class=k>class</span> <span class=nc>Foo</span><span class=p>:</span>
<span class=gp>... </span>    <span class=k>def</span> <span class=nf>first_method</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=gp>... </span>        <span class=k>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\t</span><span class=s2>This is the first_method of Foo class&quot;</span><span class=p>)</span>
<span class=gp>... </span>    <span class=k>def</span> <span class=nf>second_method</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=gp>... </span>        <span class=k>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\t</span><span class=s2>This is the second_method of Foo class&quot;</span><span class=p>)</span>
<span class=gp>...</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>bar</span> <span class=o>=</span> <span class=n>Foo</span><span class=p>()</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>bar</span><span class=o>.</span><span class=n>first_method</span><span class=p>()</span>
<span class=go>Inside the decorator</span>
<span class=go>    This is the first_method of Foo class</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>bar</span><span class=o>.</span><span class=n>second_method</span><span class=p>()</span>
<span class=go>Inside the decorator</span>
<span class=go>    This is the second_method of Foo class</span>
</pre></div> <p>Trong trường hợp này, việc sử dụng metaclass để thay đổi các phương thức của class có vẻ không phải là một phương án dễ dàng. Việc sử dụng class decorator đã khiến một công việc khó khăn trở nên đơn giản hơn rất nhiều.</p> <h2 id=mot-so-han-che-cua-class-decorator>Một số hạn chế của class decorator<a class=headerlink href=#mot-so-han-che-cua-class-decorator title="Permanent link">&para;</a></h2> <p>Class decorator tuy rằng cho phép chúng ta thay đổi hành vi của các class, nhưng nó cũng có những hạn chế nhất định:</p> <ul> <li>Class decorator chỉ xuất hiện từ phiên bản 2.6. Nên những phiên bản cũ hơn chưa thể dùng được cú pháp pie syntax (<code>@</code>). Tất nhiên, bạn vẫn có thể làm bằng tay bằng cách gọi hàm.</li> <li>Decorator không giúp cải thiện performance của các class. Thậm chí, nó còn làm class chậm hơn.</li> <li>Cũng giống như một hàm đã được decorate, class được decorate cũng không thể bỏ decorate đi được.</li> <li>Vì decorator bao bọc các class và kết quả trả về nhiều khi không còn là class, việc debug sẽ trở nên khó khăn hơn. Và class decorator không có công cụ nào có sẵn để giúp chúng ta việc này. (Không như <code>functools</code> giúp chúng ta debug các hàm.)</li> </ul> <h1 id=ket-luan>Kết luận<a class=headerlink href=#ket-luan title="Permanent link">&para;</a></h1> <p>Trên đây là những hiểu biết của tôi về class decorator trong Python. Class decorator là một công cụ rất hữu ích và dễ hiểu hơn rất nhiều so với metaclass. Hy vọng bài viết giúp ích phần nào trong quá trình phát triển Python của các bạn.</p> </div> <div class=post-footer> <div class=tags> <i class="fa fa-tags"></i> <span>#Python</span> <span>#class</span> <span>#decorator</span> <span>#fundamental</span> <span>#programming</span> </div> </div> </div><div class=blog-pager> <span class=newer-link> <a href=/2016/Mar/18/something-about-coding-style.html> Newer Post </a> </span> <span class=older-link> <a href=/2016/Feb/23/python-metaclass.html> Older Post </a> </span> </div><div class=comments> <div class=finally> <p><em>I apologise for any typos. If you notice a problem, please let me know.</em> <p>Thank you all for your attention. </div> <div id=disqus_thread></div> <script src=/theme/js/disqus.min.js?81e8a5f5></script> <noscript> Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript> comments powered by Disqus. </a> </noscript> </div></div> </div> </div> <div class=sidebar-wrapper> <div class=widget> <h2>Welcome</h2> <div> <img src=/theme/images/banner.gif alt=Welcome> </div> </div><div class="widget recent-posts"> <h2>Recent Posts</h2> <ul> <li> <a href=/2019/May/20/elasticsearch-data-organization.html> <img alt="Elasticsearch: Data organization" src=https://i.imgur.com/JT4y7Qf.jpg> </a> <a href=/2019/May/20/elasticsearch-data-organization.html>Elasticsearch: Data organization</a> <li> <a href=/2019/May/20/elasticsearch-intro.html> <img alt="Elasticsearch: Intro" src=https://i.imgur.com/JT4y7Qf.jpg> </a> <a href=/2019/May/20/elasticsearch-intro.html>Elasticsearch: Intro</a> <li> <a href=/2019/Apr/20/javascript-popups.html> <img alt="JavaScript: Popups" src=https://i.imgur.com/FxmcwPy.png> </a> <a href=/2019/Apr/20/javascript-popups.html>JavaScript: Popups</a> <li> <a href=/2019/Mar/20/javascript-iterator-and-generator.html> <img alt="JavaScript: Iterator and generator" src=https://i.imgur.com/lev8iT9.jpg> </a> <a href=/2019/Mar/20/javascript-iterator-and-generator.html>JavaScript: Iterator and generator</a> <li> <a href=/2019/Feb/20/javascript-decorator.html> <img alt="JavaScript decorator" src=https://i.imgur.com/Sh3yLI0.png> </a> <a href=/2019/Feb/20/javascript-decorator.html>JavaScript decorator</a> </ul> </div><div class="widget labels"> <h2>Blog Archive</h2> <ul> <li> <a href=/2019/ > 2019 </a> <li> <a href=/2018/ > 2018 </a> <li> <a href=/2017/ > 2017 </a> <li> <a href=/2016/ > 2016 </a> <li> <a href=/2015/ > 2015 </a> <li> <a href=/2014/ > 2014 </a> <li> <a href=/2013/ > 2013 </a> <li> <a href=/2012/ > 2012 </a> <li> <a href=/2011/ > 2011 </a> <li> <a href=/2010/ > 2010 </a> </ul> </div><div class=widget> <h2>Twitter timeline</h2> <a class=twitter-timeline data-height=500 data-dnt=true data-theme=light href=https://twitter.com/_naa_4f data-chrome="noheader nofooter transparent noborders"> Tweets by manhhomienbienthuy </a> </div> </div> </div> <a href=# class="smooth-scroll back-to-top"> <i class="fa fa-arrow-circle-up fa-3x"></i> </a> </main> <footer> <div class=infos> <div class=wrapper> <div class=widget> <a href=/ title="manhhomienbienthuy's space" class=logo> <img alt="manhhomienbienthuy's space" src=/theme/images/logo_white.png> </a> <span class=right>I'm a hacker, enter my world...</span> </div><div class=widget> <p> Created with all my ♥ and soul, dedicated to my love, yunachan <p> Powered by <a href=http://blog.getpelican.com/ target=_blank>Pelican</a>, which takes great advantage of <a href=https://www.python.org/ target=_blank>Python</a> <p> This site content is licensed under a <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank> CC BY-NC-ND 4.0 </a> License. <p> Updated at <a target=_blank href="http://www.timeanddate.com/worldclock/fixedtime.html?iso=2019-06-20T02:42:55"> 2019-06-20 02:42:55 </a> </div><div class=widget> <p> Hosting by <a href=https://manhhomienbienthuy.bitbucket.io/ >Bitbucket</a> and <a href=https://manhhomienbienthuy.github.io/ >Github</a>, image hosting by <a href=https://manhhomienbienthuy.imgur.com/ target=_blank>imgur</a>, <a href=https://instagram.com/manhhomienbienthuy/ target=_blank>Instagram</a> and <a href=https://photos.google.com/ target=_blank>Google Photo</a> <p> Theme based on <a href=https://vanice-veethemes.blogspot.com/ target=_blank>Vanice theme</a>, icons from <a href=https://fontawesome.com/ target=_blank>Font Awesome</a>, comments powered by <a href=https://disqus.com/home/forums/manhhomienbienthuy/ target=_blank>Disqus</a> </div> </div> </div> <div class=credits> <div class=wrapper> <div class=left> <!--
          Regarding copyright, in general, standalone pages (as
          opposed to files generated as part of manuals) on the GNU
          web server should be under CC BY-ND 4.0.  Please do NOT
          change or remove this without talking with the webmasters or
          licensing team first.  Please make sure the copyright date
          is consistent with the document.  For web pages, it is ok to
          list just the latest year the document was modified, or
          published.

          If you wish to list earlier years, that is ok too.  Either
          "2001, 2002, 2003" or "2001-2003" are ok for specifying
          years, as long as each year in the range is in fact a
          copyrightable year, i.e., a year in which the document was
          published (including being publicly visible on the web or in
          a revision control system).
        --> Copyright © 2010-2019 <a href=/pages/about-me.html><strong>manhhomienbienthuy</strong></a>. All rights reserved. </div> <div class=right> <ul> <li><a href=/ >Home</a> <li><a href=/pages/about-me.html>About</a> <li><a href=# class=smooth-scroll>Top ↑</a> </ul> </div> </div> </div></footer> <script src=https://code.jquery.com/jquery-3.2.1.js></script> <script src=//cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js></script> <script src=//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.2/imagesloaded.pkgd.min.js></script> <script src=/theme/js/vpyeu.min.js?d72c87bd></script> <script id=dsq-count-scr src=https://manhhomienbienthuy.disqus.com/count.js async></script>