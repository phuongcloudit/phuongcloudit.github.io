<!DOCTYPE html><title>Tips for improving Web application - manhhomienbienthuy's space</title> <meta charset=utf-8> <meta name=viewport content="width=device-width, initial-scale=1"> <link rel=apple-touch-icon href=/theme/images/icon-touch.png> <link rel=icon sizes=192x192 href=/theme/images/icon-touch.png> <link rel="shortcut icon" href=/theme/images/favicon.ico> <link rel=author href=/humans.txt> <meta name=msapplication-TileImage content=/theme/images/icon-tile.png> <meta name=twitter:dnt content=on> <meta name=Author content=manhhomienbienthuy> <meta name=rating content=general> <meta name=twitter:card content=product> <meta name=twitter:site content=@_naa_4f> <meta name=twitter:creator content=@_naa_4f> <link href=/feeds/all.atom.xml type=application/atom+xml rel=alternate title="manhhomienbienthuy's space Full Atom Feed"> <meta name=description content="Trong bài viết này, tôi sẽ trình bày một số kỹ thuật, rất cơ bản, có thể áp dụng với mọi dự án Web, để có thể nâng cao hiệu suất, mở rộng ứng dụng và giảm chi phí. Vào thời điểm này, một server Web cỡ trung bình (8 …"> <meta name=keywords content="Web, application, improve, performance, blog, naa, manhhomienbienthuy, pelican, static site generator"> <meta name=twitter:title content="Tips for improving Web application - manhhomienbienthuy's space"> <meta name=twitter:description content="Trong bài viết này, tôi sẽ trình bày một số kỹ thuật, rất cơ bản, có thể áp dụng với mọi dự án Web, để có thể nâng cao hiệu suất, mở rộng ứng dụng và giảm chi phí. Vào thời điểm này, một server Web cỡ trung bình (8 …"> <meta name=twitter:image content=/https://i.imgur.com/2C8uKH1.jpg> <link rel=stylesheet href=//cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css> <link rel=stylesheet href=//maxcdn.bootstrapcdn.com/font-awesome/4.0.0/css/font-awesome.min.css> <link rel=stylesheet href=/theme/css/vpyeu.min.css?5d2c7d5e> <header> <div class=navbar> <div class=wrapper> <div class=nav-menu> <div class=menu-toggle> <i class="fa fa-reorder"></i> </div> <ul class=menus> <li><a href=/ >Home</a> <li><a href=/category/general.html class=current> General <li><a href=/category/life.html> Life <li><a href=/category/programming.html> Programming <li><a href=/category/travel.html> Travel </ul> </div><div class="right links"> <ul> <li> <a href=https://twitter.com/_naa_4f target=_blank> <i class="fa fa-twitter"></i> </a> <li> <a href=https://instagram.com/manhhomienbienthuy/ target=_blank> <i class="fa fa-instagram"></i> </a> <li> <a href=https://www.facebook.com/manhhomienbienthuy target=_blank> <i class="fa fa-facebook"></i> </a> <li> <a href=https://github.com/manhhomienbienthuy target=_blank> <i class="fa fa-github"></i> </a> <li> <a href=/feeds/all.atom.xml target=_blank> <i class="fa fa-rss"></i> </a> </ul> </div> </div> </div><noscript> <div class="warning head-warn"> <div class=wrapper> <p><strong>Notice:</strong> While JavaScript is not essential for this website, your interaction with the content will be limited. Please turn JavaScript on for the full experience. </div> </div> </noscript><div class=banner> <div class=wrapper> <a href=/ > <img alt="manhhomienbienthuy's space" src=/theme/images/logo.png> </a> </div> </div></header> <main> <div class=wrapper> <div class=main-wrapper> <div class=entry> <div class=entry-detail> <div class=post> <h1 class=title> Tips for improving Web application </h1> <div class=meta> Posted in <a href=/category/general.html>General</a> on February 18, 2016 by <a href=/pages/about-me.html>manhhomienbienthuy</a> <span class=right> <i class="fa fa-comments"></i> <a href=#disqus_thread data-disqus-identifier=/2016/Feb/18/tips-for-improving-web-application.html> Comments </a> </span> </div> <div class=post-body> <img src=https://i.imgur.com/2C8uKH1.jpg alt="Tips for improving Web application"> <p>Trong bài viết này, tôi sẽ trình bày một số kỹ thuật, rất cơ bản, có thể áp dụng với mọi dự án Web, để có thể nâng cao hiệu suất, mở rộng ứng dụng và giảm chi phí.</p> <p>Vào thời điểm này, một server Web cỡ trung bình (8 cores, 24GB RAM) cũng có thể xử lý hàng trăm, thậm chí hàng nghìn truy vấn mỗi giây. Tất nhiên, nếu đủ kinh phí, bạn còn có thể thuê server khủng hơn nữa. Tuy nhiên, bạn vẫn cần những kỹ thuật nâng cao hiệu suất, đảm bảo rằng bạn không lãng phí tài nguyên và tiền bạc.</p> <p>Rất nhiều thủ thuật ở đây, bạn có thể áp dụng ngay với ứng dụng Web của mình mà không cần phải nghiên cứu bất cứ công nghệ nào.</p> <h1 id=tai-nguyen-tinh>Tài nguyên tĩnh<a class=headerlink href=#tai-nguyen-tinh title="Permanent link">&para;</a></h1> <p>Hãy đặt các tài nguyên tĩnh (CSS, JavaScript, ảnh, v.v...) lên CDN (Content Delivery Network). Nó sẽ giúp bạn phân phối những tài nguyên này một cách hiệu quả thông qua mạng lưới PoP (Point of Presence). Việc sử dụng CDN sẽ giúp giảm áp lực cho server Web, nâng cao hiệu suất của ứng dụng Web của bạn và cho phép bạn có thể mở rộng vô hạn (tài nguyên tĩnh) ứng dụng của mình.</p> <p>Các tài nguyên này nên có tên duy nhất cho nội dung của nó, phân biệt nó với các tài nguyên khác và phân biệt các phiên bản khác nhau của chính nó. Ví dụ, khi bạn thay đổi nội dung JavaScript của ứng dụng, asset pipeline của bạn nên compile và đặt lại tên mới cho file này. Tên này nên khác với tên của phiên bản cũ.</p> <p>Việc này sẽ giúp việc lưu cache trên trình duyệt hiệu quả hơn. Mỗi khi truy cập trang Web, trình duyệt sẽ cache lại nội dung của những tài nguyên tĩnh này và lần sau truy cập, nó sẽ không cần file load lại file nữa. Nếu mỗi phiên bản của file lại có một tên khác nhau, thì khi người dùng vào trang Web đã cập nhật, họ sẽ không bị lỗi layout hay bất cứ lỗi gì khác liên quan đến CSS, JavaScript do tên file đã thay đổi nên cache cũ không còn được dùng nữa.</p> <p>Có một cách đơn giản về đặt tên đó là sử dụng SHA-256 của nội dung chính file đó làm tên file. Cách này khá hay, khi bạn thay đổi nội dung bên trong, SHA-256 cũng sẽ thay đổi và bạn sẽ có file mới với tên mới.</p> <h1 id=session>Session<a class=headerlink href=#session title="Permanent link">&para;</a></h1> <p>Nếu có thể, bạn nên lưu session bằng cookie kèm chữ ký (mã hóa nữa thì càng tốt). Việc này sẽ giúp bạn giảm bớt xử lý trên server do không cần phải truy vấn đến cơ sở dữ liệu trong trường hợp này. Bạn nên sử dụng TLS cho mọi kết nối, và đặt các thuộc tính bảo mật cho cookie. Và với các thao tác đính kèm chữ ký, mã hóa, xác thực, giải mã, v.v tốt nhất bạn không nên tự cài đặt bằng tay mà nên sử dụng các thư viện có sẵn, ví dụ <a href=https://pypi.python.org/pypi/itsdangerous>itsdangerous</a>.</p> <p>Nếu cookie kèm chữ ký không phù hợp với ứng dụng của bạn vì một lý do nào đó (ví dụ kích thước payload quá lớn), thì bạn có thể chuyển sang sử dụng cách lưu trữ key-value đơn giản hơn. Với hầu hết các ứng dụng, bạn có thể sử dụng một số hệ thống hỗ trợ lưu trữ dạng này như memcached chẳng hạn.</p> <h1 id=load-balance>Load balance<a class=headerlink href=#load-balance title="Permanent link">&para;</a></h1> <p>Web server của bạn không thể đảm bảo là luôn chạy ổn định. Vì vậy hãy đặt chúng sau một load balancer ngay từ khi thiết kế. Việc này rất quan trọng, load balancer sẽ phân phối kết nối đến các Web server của bạn giúp chúng hoạt động trơn tru, hiệu quả và tránh bị quá tải.</p> <p>Hãy thử thêm vào bớt các server sau load balancer. Mọi thao tác rất đơn giản và an toàn khi thêm vào những server mới và loại bỏ server cũ khi nó không phù hợp nữa.</p> <p>Nếu load balancer khiến bạn phải sử dụng cách giải pháp phân tán, bạn nên hạn chế số lượng kết nối bên trong hệ thống.</p> <p>Và một điều quan trọng nữa là, hãy thiết lập load balancer thực hiện health check với các server định kỳ.</p> <h1 id=luu-tru-du-lieu>Lưu trữ dữ liệu<a class=headerlink href=#luu-tru-du-lieu title="Permanent link">&para;</a></h1> <p>Với những dữ liệu do người dùng upload lên, và những lưu trữ tương tự (các tài nguyên tĩnh nhưng không phải là một phần của trang), hãy sử dụng dịch vụ của bên thứ ba. Rất nhiều người sử dụng dịch vụ S3 của Amazon. Đây là một giải pháp tốt, dễ dùng, ổn định mà không đắt.</p> <p>Hãy tránh việc lưu trữ trên chính Web server của mình. Nó có thể gặp một số vấn đề khi bạn có nhiều instance Web mà người dùng chỉ upload lên một trong số chúng. Việc lưu trữ trên chính server Web cũng khiến chúng ta khó mở rộng ứng dụng. Hãy sử dụng các dịch vụ lưu trữ bên ngoài.</p> <h1 id=co-so-du-lieu>Cơ sở dữ liệu<a class=headerlink href=#co-so-du-lieu title="Permanent link">&para;</a></h1> <p>Với phần lớn các ứng dụng, hệ cơ sở dữ liệu quan hệ là đủ để ứng dụng hoạt động tốt. Tuy nhiên, bạn cần cẩn thận tắc cổ chai. Các ứng dụng thường bị tắc cổ chai khi đọc dữ liệu từ database hơn là ghi dữ liệu.</p> <p>Nếu cần, bạn có thể thiết lập replica cho cơ sở dữ liệu. Việc này hoàn toàn không khó. Hãy theo dõi thời gian phản hồi của toàn hệ thống cơ sở dữ liệu.</p> <p>Với những công tụ quản trị trang Web (báo cáo trạng thái, dashboard hay các trang admin khác) có thể có những truy vấn riêng đến replica được chỉ định. Việc này có thể khiến dữ liệu thống kê khác nhau giữa các truy vấn. Và việc kết hợp chúng trên cùng một server có thể làm giảm hiệu suất do phải cache quá nhiều.</p> <p>Nếu bạn cần thay đổi cấu trúc cơ sở dữ liệu, đừng bao giờ giả định rằng quá trình này sẽ diễn ra rất nhanh. Code ứng dụng của bạn nên chuẩn bị sẵn sàng ứng phó với 3 trạng thái: trước khi migrate, trong khi migrate và đã migrate xong. Ví dụ, nếu bạn cần thêm một cột vào bảng đang có, quá trình thực hiện có thể như sau:</p> <ol> <li>Thêm một cột mới và cơ sở dữ liệu (cột này nên để nullable)</li> <li>Deploy code mới để ghi dữ liệu vào cột này.</li> <li>Chạy một script khác để điền những dữ liệu vào các bản ghi đang có.</li> <li>Kiểm tra thông tin được ghi đầy đủ và chính xác.</li> <li>Cuối cùng, deploy code mới để đọc dữ liệu từ cột này.</li> </ol> <h1 id=deploy-va-tu-ong-hoa>Deploy và tự động hóa<a class=headerlink href=#deploy-va-tu-ong-hoa title="Permanent link">&para;</a></h1> <p>Mọi thao tác với server nên được code vào trong ứng dụng. Hãy thử tự động hóa các thao tác. Thêm và bớt các server bất cứ khi nào bạn muốn.</p> <p>Kỹ thuật "dark read" là một kỹ thuật rất thích hợp để test và kiểm tra khả năng đáp ứng yêu cầu của tính năng mới. Dark read nghĩa là những người truy cập trang sẽ truy vấp đến tính năng đó một cách "âm thầm" (ví dụ bằng AJAX), nhưng không xử lý bất cứ điều gì khi có kết quả trả về. Nó sẽ giúp bạn ước lượng hiệu năng của tính năng mới thông qua việc kiểm tra lượng truy vấn tương đối giống thực tế.</p> <p>Một kỹ thuật khác cũng rất thích hợp để kiểm tra tính năng mới đó mà "feature flag". Thay vì bạn phải tạo các nhánh test và xây dựng môi trường test riêng biệt, bạn có thể dùng "feature flag" để deploy tính năng mới nhưng chỉ áp dụng với nhóm nhỏ người dùng. Đây là kỹ thuật mà Facebook vẫn thường áp dụng với những tính năng mới của họ.</p> <p>Dark read và feature flag có thể kết hợp với nhau rất tốt. Bạn có thể deploy dark read cho một tính năng mới, sử dụng feature flag, chỉ áp dụng với một nhóm nhỏ người dùng. Sau đó từ từ tăng số lượng người được áp dụng lên, bạn có thể tính toán và ước lượng số lượng truy vấn cần xử lý, thực hiện tối ưu hóa nếu cần. Cuối cùng, khi đã tự tin về tính năng này, bạn có thể công bố nó rộng rãi tới người dùng.</p> </div> <div class=post-footer> <div class=tags> <i class="fa fa-tags"></i> <span>#Web</span> <span>#application</span> <span>#improve</span> <span>#performance</span> </div> </div> </div><div class=blog-pager> <span class=newer-link> <a href=/2016/Feb/23/python-metaclass.html> Newer Post </a> </span> <span class=older-link> <a href=/2016/Feb/05/system-programming-references.html> Older Post </a> </span> </div><div class=comments> <div class=finally> <p><em>I apologise for any typos. If you notice a problem, please let me know.</em> <p>Thank you all for your attention. </div> <div id=disqus_thread></div> <script src=/theme/js/disqus.min.js?81e8a5f5></script> <noscript> Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript> comments powered by Disqus. </a> </noscript> </div></div> </div> </div> <div class=sidebar-wrapper> <div class=widget> <h2>Welcome</h2> <div> <img src=/theme/images/banner.gif alt=Welcome> </div> </div><div class="widget recent-posts"> <h2>Recent Posts</h2> <ul> <li> <a href=/2019/May/20/elasticsearch-data-organization.html> <img alt="Elasticsearch: Data organization" src=https://i.imgur.com/JT4y7Qf.jpg> </a> <a href=/2019/May/20/elasticsearch-data-organization.html>Elasticsearch: Data organization</a> <li> <a href=/2019/May/20/elasticsearch-intro.html> <img alt="Elasticsearch: Intro" src=https://i.imgur.com/JT4y7Qf.jpg> </a> <a href=/2019/May/20/elasticsearch-intro.html>Elasticsearch: Intro</a> <li> <a href=/2019/Apr/20/javascript-popups.html> <img alt="JavaScript: Popups" src=https://i.imgur.com/FxmcwPy.png> </a> <a href=/2019/Apr/20/javascript-popups.html>JavaScript: Popups</a> <li> <a href=/2019/Mar/20/javascript-iterator-and-generator.html> <img alt="JavaScript: Iterator and generator" src=https://i.imgur.com/lev8iT9.jpg> </a> <a href=/2019/Mar/20/javascript-iterator-and-generator.html>JavaScript: Iterator and generator</a> <li> <a href=/2019/Feb/20/javascript-decorator.html> <img alt="JavaScript decorator" src=https://i.imgur.com/Sh3yLI0.png> </a> <a href=/2019/Feb/20/javascript-decorator.html>JavaScript decorator</a> </ul> </div><div class="widget labels"> <h2>Blog Archive</h2> <ul> <li> <a href=/2019/ > 2019 </a> <li> <a href=/2018/ > 2018 </a> <li> <a href=/2017/ > 2017 </a> <li> <a href=/2016/ > 2016 </a> <li> <a href=/2015/ > 2015 </a> <li> <a href=/2014/ > 2014 </a> <li> <a href=/2013/ > 2013 </a> <li> <a href=/2012/ > 2012 </a> <li> <a href=/2011/ > 2011 </a> <li> <a href=/2010/ > 2010 </a> </ul> </div><div class=widget> <h2>Twitter timeline</h2> <a class=twitter-timeline data-height=500 data-dnt=true data-theme=light href=https://twitter.com/_naa_4f data-chrome="noheader nofooter transparent noborders"> Tweets by manhhomienbienthuy </a> </div> </div> </div> <a href=# class="smooth-scroll back-to-top"> <i class="fa fa-arrow-circle-up fa-3x"></i> </a> </main> <footer> <div class=infos> <div class=wrapper> <div class=widget> <a href=/ title="manhhomienbienthuy's space" class=logo> <img alt="manhhomienbienthuy's space" src=/theme/images/logo_white.png> </a> <span class=right>I'm a hacker, enter my world...</span> </div><div class=widget> <p> Created with all my ♥ and soul, dedicated to my love, yunachan <p> Powered by <a href=http://blog.getpelican.com/ target=_blank>Pelican</a>, which takes great advantage of <a href=https://www.python.org/ target=_blank>Python</a> <p> This site content is licensed under a <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank> CC BY-NC-ND 4.0 </a> License. <p> Updated at <a target=_blank href="http://www.timeanddate.com/worldclock/fixedtime.html?iso=2019-06-20T02:42:55"> 2019-06-20 02:42:55 </a> </div><div class=widget> <p> Hosting by <a href=https://manhhomienbienthuy.bitbucket.io/ >Bitbucket</a> and <a href=https://manhhomienbienthuy.github.io/ >Github</a>, image hosting by <a href=https://manhhomienbienthuy.imgur.com/ target=_blank>imgur</a>, <a href=https://instagram.com/manhhomienbienthuy/ target=_blank>Instagram</a> and <a href=https://photos.google.com/ target=_blank>Google Photo</a> <p> Theme based on <a href=https://vanice-veethemes.blogspot.com/ target=_blank>Vanice theme</a>, icons from <a href=https://fontawesome.com/ target=_blank>Font Awesome</a>, comments powered by <a href=https://disqus.com/home/forums/manhhomienbienthuy/ target=_blank>Disqus</a> </div> </div> </div> <div class=credits> <div class=wrapper> <div class=left> <!--
          Regarding copyright, in general, standalone pages (as
          opposed to files generated as part of manuals) on the GNU
          web server should be under CC BY-ND 4.0.  Please do NOT
          change or remove this without talking with the webmasters or
          licensing team first.  Please make sure the copyright date
          is consistent with the document.  For web pages, it is ok to
          list just the latest year the document was modified, or
          published.

          If you wish to list earlier years, that is ok too.  Either
          "2001, 2002, 2003" or "2001-2003" are ok for specifying
          years, as long as each year in the range is in fact a
          copyrightable year, i.e., a year in which the document was
          published (including being publicly visible on the web or in
          a revision control system).
        --> Copyright © 2010-2019 <a href=/pages/about-me.html><strong>manhhomienbienthuy</strong></a>. All rights reserved. </div> <div class=right> <ul> <li><a href=/ >Home</a> <li><a href=/pages/about-me.html>About</a> <li><a href=# class=smooth-scroll>Top ↑</a> </ul> </div> </div> </div></footer> <script src=https://code.jquery.com/jquery-3.2.1.js></script> <script src=//cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js></script> <script src=//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.2/imagesloaded.pkgd.min.js></script> <script src=/theme/js/vpyeu.min.js?d72c87bd></script> <script id=dsq-count-scr src=https://manhhomienbienthuy.disqus.com/count.js async></script>